module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=19)}([function(e,t){e.exports=require("crypto-js")},function(e,t){e.exports=require("axios")},function(e,t){e.exports=require("bignumber.js")},function(e,t){e.exports=require("bip39")},function(e,t){e.exports=require("base64-url")},function(e,t){e.exports=require("sm.js")},function(e,t){e.exports=require("elliptic")},function(e,t){e.exports=require("bs58")},function(e,t){e.exports=require("js-sha3")},function(e,t){e.exports=require("long")},function(e,t){e.exports=require("secure-random")},function(e,t){e.exports=require("@ont-community/hdkey-secp256r1")},function(e,t){e.exports=require("wif")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("scrypt-async")},function(e,t){e.exports=require("milagro-crypto-js")},function(e,t){e.exports=require("@ont-community/html5-websocket")},function(e,t){e.exports=require("websocket-as-promised")},function(e,t){e.exports=require("uuid")},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"ADDR_VERSION",function(){return S}),r.d(n,"DEFAULT_SCRYPT",function(){return b}),r.d(n,"OEP_HEADER",function(){return A}),r.d(n,"OEP_FLAG",function(){return k}),r.d(n,"WEBVIEW_SCHEME",function(){return R}),r.d(n,"DEFAULT_ALGORITHM",function(){return x}),r.d(n,"DEFAULT_SM2_ID",function(){return P}),r.d(n,"TEST_NODE",function(){return E}),r.d(n,"MAIN_NODE",function(){return T}),r.d(n,"HTTP_REST_PORT",function(){return O}),r.d(n,"HTTP_WS_PORT",function(){return N}),r.d(n,"HTTP_JSON_PORT",function(){return I}),r.d(n,"REST_API",function(){return C}),r.d(n,"ONT_NETWORK",function(){return B}),r.d(n,"TEST_ONT_URL",function(){return D}),r.d(n,"MAIN_ONT_URL",function(){return _}),r.d(n,"TOKEN_TYPE",function(){return H}),r.d(n,"DEFAULT_GAS_LIMIT",function(){return z}),r.d(n,"NATIVE_INVOKE_NAME",function(){return U}),r.d(n,"TX_MAX_SIG_SIZE",function(){return L}),r.d(n,"ONT_BIP44_PATH",function(){return M}),r.d(n,"UNBOUND_GENERATION_AMOUNT",function(){return K}),r.d(n,"UNBOUND_TIME_INTERVAL",function(){return V}),r.d(n,"ONT_TOTAL_SUPPLY",function(){return J}),r.d(n,"GENESIS_BLOCK_TIMESTAMP",function(){return G});var a={};r.r(a),r.d(a,"hexstring2ab",function(){return ne}),r.d(a,"ab2hexstring",function(){return ae}),r.d(a,"ab2str",function(){return ie}),r.d(a,"str2ab",function(){return oe}),r.d(a,"str2hexstr",function(){return ue}),r.d(a,"hexstr2str",function(){return se}),r.d(a,"hex2VarBytes",function(){return ce}),r.d(a,"str2VarBytes",function(){return le}),r.d(a,"bool2VarByte",function(){return fe}),r.d(a,"hexXor",function(){return he}),r.d(a,"num2hexstring",function(){return ve}),r.d(a,"num2VarInt",function(){return de}),r.d(a,"reverseHex",function(){return ye}),r.d(a,"bigIntFromBytes",function(){return pe}),r.d(a,"bigIntToBytes",function(){return ge}),r.d(a,"StringReader",function(){return me}),r.d(a,"EventEmitter",function(){return we}),r.d(a,"sendBackResult2Native",function(){return Se}),r.d(a,"axiosPost",function(){return be}),r.d(a,"now",function(){return Ae}),r.d(a,"sha256",function(){return ke}),r.d(a,"ripemd160",function(){return Re}),r.d(a,"hash160",function(){return xe}),r.d(a,"generateRandomArray",function(){return Pe}),r.d(a,"randomBytes",function(){return Ee}),r.d(a,"generateMnemonic",function(){return Te}),r.d(a,"parseMnemonic",function(){return Oe}),r.d(a,"varifyPositiveInt",function(){return Ne}),r.d(a,"isBase64",function(){return Ie}),r.d(a,"isHexString",function(){return Ce}),r.d(a,"unboundDeadline",function(){return Be}),r.d(a,"calcUnboundOng",function(){return De});var i={};r.r(i),r.d(i,"pushBool",function(){return pt}),r.d(i,"pushInt",function(){return gt}),r.d(i,"pushBigNum",function(){return mt}),r.d(i,"pushHexString",function(){return wt}),r.d(i,"getStructBytes",function(){return St}),r.d(i,"getMapBytes",function(){return bt}),r.d(i,"pushMap",function(){return At}),r.d(i,"pushParam",function(){return kt}),r.d(i,"serializeAbiFunction",function(){return Rt}),r.d(i,"convertArray",function(){return xt}),r.d(i,"convertMap",function(){return Pt}),r.d(i,"deserializeItem",function(){return Et}),r.d(i,"createCodeParamsScript",function(){return Tt}),r.d(i,"buildSmartContractParam",function(){return Ot}),r.d(i,"buildWasmContractParam",function(){return Nt});var o={};r.r(o),r.d(o,"encryptWithCtr",function(){return Lt}),r.d(o,"decryptWithCtr",function(){return Mt}),r.d(o,"checkCtrDecrypted",function(){return Kt}),r.d(o,"encryptWithEcb",function(){return Vt}),r.d(o,"decryptWithEcb",function(){return Jt}),r.d(o,"checkEcbDecrypted",function(){return Gt}),r.d(o,"encryptWithGcm",function(){return jt}),r.d(o,"decryptWithGcm",function(){return Wt});var u={};r.r(u),r.d(u,"Address",function(){return Ct}),r.d(u,"KeyType",function(){return Me}),r.d(u,"CurveLabel",function(){return Ve}),r.d(u,"SignatureScheme",function(){return Ue}),r.d(u,"KeyParameters",function(){return We}),r.d(u,"PrivateKey",function(){return Zt}),r.d(u,"registerKeyDeserializer",function(){return rr}),r.d(u,"PublicKey",function(){return Qe}),r.d(u,"PublicKeyStatus",function(){return Xe}),r.d(u,"Signature",function(){return Yt}),r.d(u,"Issuer",function(){return cr}),r.d(u,"User",function(){return lr});var s={};r.r(s),r.d(s,"Default_params",function(){return _r}),r.d(s,"signTransaction",function(){return Hr}),r.d(s,"signTransactionAsync",function(){return zr}),r.d(s,"addSign",function(){return Ur}),r.d(s,"signTx",function(){return Mr}),r.d(s,"makeNativeContractTx",function(){return Kr}),r.d(s,"makeInvokeTransaction",function(){return Vr}),r.d(s,"makeDeployCodeTransaction",function(){return Jr}),r.d(s,"buildTxParam",function(){return Gr}),r.d(s,"buildRpcParam",function(){return jr}),r.d(s,"buildRestfulParam",function(){return Wr}),r.d(s,"sendRawTxRestfulUrl",function(){return Fr});var c={};r.r(c),r.d(c,"ONTID_CONTRACT",function(){return oa}),r.d(c,"buildRegisterOntidTx",function(){return sa}),r.d(c,"buildRegIdWithAttributes",function(){return ca}),r.d(c,"buildAddAttributeTx",function(){return la}),r.d(c,"buildRemoveAttributeTx",function(){return fa}),r.d(c,"buildGetAttributesTx",function(){return ha}),r.d(c,"buildGetDDOTx",function(){return va}),r.d(c,"buildAddControlKeyTx",function(){return da}),r.d(c,"buildRemoveControlKeyTx",function(){return ya}),r.d(c,"buildGetPublicKeysTx",function(){return pa}),r.d(c,"buildAddRecoveryTx",function(){return ga}),r.d(c,"buildChangeRecoveryTx",function(){return ma}),r.d(c,"buildGetPublicKeyStateTx",function(){return wa});var l={};r.r(l),r.d(l,"InvocationTransaction",function(){return Qa}),r.d(l,"NeoRpc",function(){return Za}),r.d(l,"Program",function(){return ei}),r.d(l,"SmartContract",function(){return ri}),r.d(l,"TransactionInput",function(){return ai}),r.d(l,"TransactionOutput",function(){return oi}),r.d(l,"TransactionNeo",function(){return qa});var f={};r.r(f),r.d(f,"ONT_CONTRACT",function(){return ci}),r.d(f,"ONG_CONTRACT",function(){return li}),r.d(f,"getTokenContract",function(){return fi}),r.d(f,"verifyAmount",function(){return hi}),r.d(f,"makeTransferTx",function(){return vi}),r.d(f,"makeWithdrawOngTx",function(){return di}),r.d(f,"makeQueryAllowanceTx",function(){return yi}),r.d(f,"makeQueryBalanceTx",function(){return pi}),r.d(f,"deserializeTransferTx",function(){return gi});var h={};r.r(h),r.d(h,"Oep8State",function(){return Si}),r.d(h,"TransferFrom",function(){return bi}),r.d(h,"Oep8TxBuilder",function(){return zi});var v={};r.r(v),r.d(v,"makeRegisterCandidateTx",function(){return Yi}),r.d(v,"makeUnregisterCandidateTx",function(){return Qi}),r.d(v,"makeApproveCandidateTx",function(){return Xi}),r.d(v,"makeRejectCandidateTx",function(){return Zi}),r.d(v,"makeVoteForPeerTx",function(){return $i}),r.d(v,"makeUnvoteForPeerTx",function(){return eo}),r.d(v,"makeWithdrawTx",function(){return to}),r.d(v,"makeQuitNodeTx",function(){return ro}),r.d(v,"makeChangeAuthorizationTx",function(){return no}),r.d(v,"makeSetPeerCostTx",function(){return ao}),r.d(v,"makeWithdrawFeeTx",function(){return io}),r.d(v,"makeAuthorizeForPeerTx",function(){return oo}),r.d(v,"makeUnauthorizeForPeerTx",function(){return uo}),r.d(v,"makeAddInitPosTx",function(){return so}),r.d(v,"makeReduceInitPosTx",function(){return co}),r.d(v,"makeWithdrawPeerUnboundOngTx",function(){return lo}),r.d(v,"getAttributes",function(){return fo}),r.d(v,"getSplitFeeAddress",function(){return ho}),r.d(v,"getAuthorizeInfo",function(){return vo}),r.d(v,"getGovernanceView",function(){return yo}),r.d(v,"getPeerPoolMap",function(){return po}),r.d(v,"getGlobalParam",function(){return go}),r.d(v,"getTotalStake",function(){return mo}),r.d(v,"getPeerUnboundOng",function(){return wo}),r.d(v,"GovernanceView",function(){return So}),r.d(v,"PeerPoolItem",function(){return bo}),r.d(v,"PeerAttributes",function(){return Ao}),r.d(v,"SplitFeeAddress",function(){return ko}),r.d(v,"AuthorizeInfo",function(){return Ro}),r.d(v,"GlobalParam",function(){return xo}),r.d(v,"TotalStake",function(){return Po});var d={};r.r(d),r.d(d,"Transfers",function(){return Oo}),r.d(d,"TokenTransfer",function(){return No}),r.d(d,"State",function(){return Io}),r.d(d,"Contract",function(){return Co}),r.d(d,"TransferFrom",function(){return Bo});var y={};r.r(y),r.d(y,"Oep4State",function(){return Fo}),r.d(y,"Oep4TxBuilder",function(){return qo});var p={};r.r(p),r.d(p,"Oep5Param",function(){return Xo}),r.d(p,"Oep5TxBuilder",function(){return fu});var g,m,w=r(3),S="17",b={cost:4096,blockSize:8,parallel:8,size:64},A="0142",k="e0",R="Ont",x={algorithm:"ECDSA",parameters:{curve:"P-256"}},P="1234567812345678",E="polaris1.ont.io",T="dappnode1.ont.io",O="20334",N="20335",I="20336",C={getBalance:"/api/v1/balance",sendRawTx:"/api/v1/transaction",getMerkleProof:"/api/v1/merkleproof"},B={MAIN:"MainNet",TEST:"TestNet"},D={SOCKET_URL:"ws://"+E+":"+N,RPC_URL:"http://"+E+":"+I,REST_URL:"http://"+E+":"+O,sendRawTxByRestful:"http://"+E+":"+O+C.sendRawTx},_={SOCKET_URL:"ws://"+T+":"+N,RPC_URL:"http://"+T+":"+I+"/",REST_URL:"http://"+T+":"+O+"/",sendRawTxByRestful:"http://"+E+":"+O+C.sendRawTx},H={ONT:"ONT",ONG:"ONG"},z=3e4,U="Ontology.Native.Invoke",L=16,M="m/44'/1024'/0'/0/0",K=[5,4,3,3,2,2,2,1,1,1,1,1,1,1,1,1,1,1],V=31536e3,J=1e9,G=1530316800,j=r(7),W=r(0);!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.SESSION_EXPIRED=41001]="SESSION_EXPIRED",e[e.SERVICE_CEILING=41002]="SERVICE_CEILING",e[e.ILLEGAL_DATAFORMAT=41003]="ILLEGAL_DATAFORMAT",e[e.INVALID_VERSION=41004]="INVALID_VERSION",e[e.INVALID_METHOD=42001]="INVALID_METHOD",e[e.INVALID_PARAMS=42002]="INVALID_PARAMS",e[e.INVALID_TRANSACTION=43001]="INVALID_TRANSACTION",e[e.INVALID_ASSET=43002]="INVALID_ASSET",e[e.INVALID_BLOCK=43003]="INVALID_BLOCK",e[e.UNKNOWN_TRANSACTION=44001]="UNKNOWN_TRANSACTION",e[e.UNKNOWN_ASSET=44002]="UNKNOWN_ASSET",e[e.UNKNOWN_BLOCK=44003]="UNKNOWN_BLOCK",e[e.UNKNWN_CONTRACT=44004]="UNKNWN_CONTRACT",e[e.INTERNAL_ERROR=45001]="INTERNAL_ERROR",e[e.SMARTCODE_ERROR=47001]="SMARTCODE_ERROR",e[e.UNKNOWN_ONTID=51e3]="UNKNOWN_ONTID",e[e.NETWORK_ERROR=52e3]="NETWORK_ERROR",e[e.Decrypto_ERROR=53e3]="Decrypto_ERROR",e[e.INVALID_ADDR=53001]="INVALID_ADDR",e[e.PreExec_ERROR=54e3]="PreExec_ERROR"}(g||(g={})),function(e){e[e.PUSH0=0]="PUSH0",e[e.PUSHF=0]="PUSHF",e[e.PUSHBYTES1=1]="PUSHBYTES1",e[e.PUSHBYTES75=75]="PUSHBYTES75",e[e.PUSHDATA1=76]="PUSHDATA1",e[e.PUSHDATA2=77]="PUSHDATA2",e[e.PUSHDATA4=78]="PUSHDATA4",e[e.PUSHM1=79]="PUSHM1",e[e.PUSH1=81]="PUSH1",e[e.PUSHT=81]="PUSHT",e[e.PUSH2=82]="PUSH2",e[e.PUSH3=83]="PUSH3",e[e.PUSH4=84]="PUSH4",e[e.PUSH5=85]="PUSH5",e[e.PUSH6=86]="PUSH6",e[e.PUSH7=87]="PUSH7",e[e.PUSH8=88]="PUSH8",e[e.PUSH9=89]="PUSH9",e[e.PUSH10=90]="PUSH10",e[e.PUSH11=91]="PUSH11",e[e.PUSH12=92]="PUSH12",e[e.PUSH13=93]="PUSH13",e[e.PUSH14=94]="PUSH14",e[e.PUSH15=95]="PUSH15",e[e.PUSH16=96]="PUSH16",e[e.NOP=97]="NOP",e[e.JMP=98]="JMP",e[e.JMPIF=99]="JMPIF",e[e.JMPIFNOT=100]="JMPIFNOT",e[e.CALL=101]="CALL",e[e.RET=102]="RET",e[e.APPCALL=103]="APPCALL",e[e.SYSCALL=104]="SYSCALL",e[e.TAILCALL=105]="TAILCALL",e[e.DUPFROMALTSTACK=106]="DUPFROMALTSTACK",e[e.TOALTSTACK=107]="TOALTSTACK",e[e.FROMALTSTACK=108]="FROMALTSTACK",e[e.XDROP=109]="XDROP",e[e.XSWAP=114]="XSWAP",e[e.XTUCK=115]="XTUCK",e[e.DEPTH=116]="DEPTH",e[e.DROP=117]="DROP",e[e.DUP=118]="DUP",e[e.NIP=119]="NIP",e[e.OVER=120]="OVER",e[e.PICK=121]="PICK",e[e.ROLL=122]="ROLL",e[e.ROT=123]="ROT",e[e.SWAP=124]="SWAP",e[e.TUCK=125]="TUCK",e[e.CAT=126]="CAT",e[e.SUBSTR=127]="SUBSTR",e[e.LEFT=128]="LEFT",e[e.RIGHT=129]="RIGHT",e[e.SIZE=130]="SIZE",e[e.INVERT=131]="INVERT",e[e.AND=132]="AND",e[e.OR=133]="OR",e[e.XOR=134]="XOR",e[e.EQUAL=135]="EQUAL",e[e.INC=139]="INC",e[e.DEC=140]="DEC",e[e.NEGATE=143]="NEGATE",e[e.ABS=144]="ABS",e[e.NOT=145]="NOT",e[e.NZ=146]="NZ",e[e.ADD=147]="ADD",e[e.SUB=148]="SUB",e[e.MUL=149]="MUL",e[e.DIV=150]="DIV",e[e.MOD=151]="MOD",e[e.SHL=152]="SHL",e[e.SHR=153]="SHR",e[e.BOOLAND=154]="BOOLAND",e[e.BOOLOR=155]="BOOLOR",e[e.NUMEQUAL=156]="NUMEQUAL",e[e.NUMNOTEQUAL=158]="NUMNOTEQUAL",e[e.LT=159]="LT",e[e.GT=160]="GT",e[e.LTE=161]="LTE",e[e.GTE=162]="GTE",e[e.MIN=163]="MIN",e[e.MAX=164]="MAX",e[e.WITHIN=165]="WITHIN",e[e.SHA1=167]="SHA1",e[e.SHA256=168]="SHA256",e[e.HASH160=169]="HASH160",e[e.HASH256=170]="HASH256",e[e.CHECKSIG=172]="CHECKSIG",e[e.CHECKMULTISIG=174]="CHECKMULTISIG",e[e.ARRAYSIZE=192]="ARRAYSIZE",e[e.PACK=193]="PACK",e[e.UNPACK=194]="UNPACK",e[e.PICKITEM=195]="PICKITEM",e[e.SETITEM=196]="SETITEM",e[e.NEWARRAY=197]="NEWARRAY",e[e.NEWSTRUCT=198]="NEWSTRUCT",e[e.NEWMAP=199]="NEWMAP",e[e.APPEND=200]="APPEND",e[e.REVERSE=201]="REVERSE",e[e.REMOVE=202]="REMOVE",e[e.HASKEY=203]="HASKEY",e[e.KEYS=204]="KEYS",e[e.VALUES=205]="VALUES",e[e.THROW=240]="THROW",e[e.THROWIFNOT=241]="THROWIFNOT"}(m||(m={}));var F=m,q=r(6),Y=r(5),Q=r(2),X=r(9),Z=r(1),$=r.n(Z),ee=r(10),te=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e){for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t}function ae(e){for(var t="",r=new Uint8Array(e),n=0;n<r.byteLength;n++){var a=r[n].toString(16);t+=a=0===a.length?"00":1===a.length?"0"+a:a}return t}function ie(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function oe(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0,a=e.length;n<a;n++)r[n]=e.charCodeAt(n);return t}function ue(e){return ae(oe(e))}function se(e){return ie(ne(e))}function ce(e){var t="";return t+=de(e.length/2),t+=e}function le(e){var t="",r=ue(e);return t+=de(r.length/2),t+=r}function fe(e){return e?"01":"00"}function he(e,t){if(e.length!==t.length)throw new Error("strings are disparate lengths");if(e.length%2!=0)throw new Error("strings must be hex");for(var r=new ArrayBuffer(e.length/2),n=new Uint8Array(r),a=0;a<e.length;a+=2)n[a/2]=parseInt(e.substr(a,2),16)^parseInt(t.substr(a,2),16);return ae(r)}var ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<0)throw new RangeError("num must be >=0");if(t%1!=0)throw new Error("size must be a whole integer");if(!Number.isSafeInteger(e))throw new RangeError("num ("+e+") must be a safe integer");t*=2;var n=e.toString(16);return n=n.length%t==0?n:("0".repeat(t)+n).substring(n.length),r&&(n=ye(n)),n},de=function(e){return e<253?ve(e):e<=65535?"fd"+ve(e,2,!0):e<=4294967295?"fe"+ve(e,4,!0):"ff"+ve(e,8,!0)},ye=function(e){if(e.length%2!=0)throw new Error("Incorrect Length: "+e);for(var t="",r=e.length-2;r>=0;r-=2)t+=e.substr(r,2);return t};function pe(e){var t=Buffer.from(e,"hex"),r=Array.from(t.subarray(0));return r[r.length-1]>>7==1&&(r=r.concat(Array(8-r.length).fill(255))),X.fromBytesLE(r)}function ge(e){for(var t=e.toBytesLE(),r=e.neg().toBytesLE(),n=void 0,a=n=e.isNegative()?255:0,i=0,o=t.length-1;o>=0;o--)if(t[o]!==n){a=e.isNegative()?r[o]:t[o],i=o+1;break}return t=t.slice(0,i),a>>7==1&&t.push(e.isNegative()?255:0),new Buffer(t).toString("hex")}var me=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(re(this,e),t.length%2!=0)throw new Error("Param's length is not even.");this.str=t,this.pos=0,this.size=this.str.length/2}return te(e,[{key:"isEmpty",value:function(){return this.pos>=this.str.length}},{key:"read",value:function(e){if(this.isEmpty())throw new Error("StringReader reached the end.");var t=this.str.substr(this.pos,2*e);return this.pos+=2*e,t}},{key:"unreadBytes",value:function(e){if(this.pos-2*e<0)throw new Error("Can not unread too many bytes.");this.pos-=2*e}},{key:"readNullTerminated",value:function(){var e=this.str.indexOf("00",this.pos);if(-1===e)throw new Error("No ending NULL found");var t=this.str.substring(this.pos,e);return this.pos=e+2,t}},{key:"readNextBytes",value:function(){var e=this.readNextLen();return 0===e?"":this.read(e)}},{key:"readNextLen",value:function(){var e=parseInt(this.read(1),16);return 253===e?e=parseInt(ye(this.read(2)),16):254===e?e=parseInt(ye(this.read(4)),16):255===e&&(e=parseInt(ye(this.read(8)),16)),e}},{key:"readUint8",value:function(){return parseInt(ye(this.read(1)),16)}},{key:"readUint16",value:function(){return parseInt(ye(this.read(2)),16)}},{key:"readUint32",value:function(){return parseInt(ye(this.read(4)),16)}},{key:"readInt",value:function(){return parseInt(ye(this.read(4)),16)}},{key:"readLong",value:function(){return parseInt(ye(this.read(8)),16)}},{key:"readBoolean",value:function(){return 0!==parseInt(this.read(1),16)}}]),e}(),we=function(){function e(){re(this,e),this.handlers={}}return te(e,[{key:"on",value:function(e,t){void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t)}},{key:"trigger",value:function(e,t){if(this.handlers[e]instanceof Array)for(var r=this.handlers[e],n=0,a=r.length;n<a;n++)r[n](t)}},{key:"off",value:function(e){delete this.handlers[e]}}]),e}(),Se=function(e,t){window&&window.prompt&&window.prompt(R+"://"+t+"?params="+e)},be=function(e,t){return $.a.post(e,t).then(function(e){return console.log("axios res:"+e),e}).catch(function(e){return console.log("axios res:"+JSON.stringify(e)),e})};function Ae(){return Math.floor(Date.now()/1e3)}function ke(e){var t=W.enc.Hex.parse(e);return W.SHA256(t).toString()}function Re(e){var t=W.enc.Hex.parse(e);return W.RIPEMD160(t).toString()}function xe(e){return Re(ke(e))}function Pe(e){return ee(e)}function Ee(e){return ae(Pe(e))}function Te(){var e=ae(Pe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:16));return w.entropyToMnemonic(e)}function Oe(e){return w.mnemonicToEntropy(e)}function Ne(e){if(!/^[1-9]\d*$/.test(e.toString()))throw g.INVALID_PARAMS}function Ie(e){return Buffer.from(e,"base64").toString("base64")===e}function Ce(e){return/^[0-9a-fA-F]+$/.test(e)&&e.length%2==0}function Be(){var e=0,t=!0,r=!1,n=void 0;try{for(var a,i=K[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){e+=a.value}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}e*=V;var o=K.length;if(1!==K[o-1]||!(e-V<J&&J<=e))throw new Error("incompatible constants setting");return V*o-(e-J)}function De(e,t,r){var n=0;if(t>=r)return 0;var a=Be();if(t<a){var i=Math.floor(t/V),o=t%V;r>=a&&(r=a);for(var u=Math.floor(r/V),s=r%V;i<u;)n+=(V-o)*K[i],i++,o=0;n+=(s-o)*K[i]}return n*e}var _e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var He=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new Q.BigNumber(t);if(!r.isInteger()||r.isNegative())throw g.INVALID_PARAMS;this.value=t}return _e(e,null,[{key:"fromHexstr",value:function(t){return t=ye(t),new e(new Q.BigNumber(t,16).toString())}}]),_e(e,[{key:"toHexstr",value:function(){return ge(X.fromValue(this.value))}}]),e}(),ze=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Ue=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label=t,this.hex=r,this.labelJWS=n,e.values.push(this)}return ze(e,null,[{key:"fromHex",value:function(t){var r=e.values.find(function(e){return e.hex===t});if(void 0===r)throw new Error("Enum value not found");return r}},{key:"fromLabel",value:function(t){var r=e.values.find(function(e){return e.label===t});if(void 0===r)throw new Error("Enum value not found");return r}},{key:"fromLabelJWS",value:function(t){var r=e.values.find(function(e){return e.labelJWS===t});if(void 0===r)throw new Error("Enum value not found");return r}}]),e}();Ue.values=[],Ue.ECDSAwithSHA224=new Ue("SHA224withECDSA",0,"ES224"),Ue.ECDSAwithSHA256=new Ue("SHA256withECDSA",1,"ES256"),Ue.ECDSAwithSHA384=new Ue("SHA384withECDSA",2,"ES384"),Ue.ECDSAwithSHA512=new Ue("SHA512withECDSA",3,"ES512"),Ue.ECDSAwithSHA3_224=new Ue("SHA3-224withECDSA",4,"ES3-224"),Ue.ECDSAwithSHA3_256=new Ue("SHA3-256withECDSA",5,"ES3-256"),Ue.ECDSAwithSHA3_384=new Ue("SHA3-384withECDSA",6,"ES3-384"),Ue.ECDSAwithSHA3_512=new Ue("SHA3-512withECDSA",7,"ES3-512"),Ue.ECDSAwithRIPEMD160=new Ue("RIPEMD160withECDSA",8,"ER160"),Ue.SM2withSM3=new Ue("SM3withSM2",9,"SM"),Ue.EDDSAwithSHA512=new Ue("SHA512withEdDSA",10,"EDS512");var Le=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Me=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label=t,this.hex=r,this.defaultSchema=n,e.values.push(this)}return Le(e,null,[{key:"fromHex",value:function(t){var r=e.values.find(function(e){return e.hex===t});if(void 0===r)throw new Error("Enum value not found");return r}},{key:"fromLabel",value:function(t){var r=e.values.find(function(e){return e.label===t});if(void 0===r)throw new Error("Enum value not found");return r}}]),e}();Me.values=[],Me.ECDSA=new Me("ECDSA",18,Ue.ECDSAwithSHA256),Me.SM2=new Me("SM2",19,Ue.SM2withSM3),Me.EDDSA=new Me("EDDSA",20,Ue.EDDSAwithSHA512);var Ke=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Ve=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label=t,this.hex=r,this.preset=n,e.values.push(this)}return Ke(e,null,[{key:"fromHex",value:function(t){var r=e.values.find(function(e){return e.hex===t});if(void 0===r)throw new Error("Enum value not found");return r}},{key:"fromLabel",value:function(t){var r=e.values.find(function(e){return e.label===t});if(void 0===r)throw new Error("Enum value not found");return r}}]),e}();Ve.values=[],Ve.SECP224R1=new Ve("P-224",1,"p224"),Ve.SECP256R1=new Ve("P-256",2,"p256"),Ve.SECP384R1=new Ve("P-384",3,"p384"),Ve.SECP521R1=new Ve("P-521",4,"p521"),Ve.SM2P256V1=new Ve("sm2p256v1",20,"sm2p256v1"),Ve.ED25519=new Ve("ed25519",25,"ed25519");var Je=r(8),Ge=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var We=function(){function e(t){je(this,e),this.curve=t}return Ge(e,null,[{key:"deserializeJson",value:function(t){return new e(Ve.fromLabel(t.curve))}}]),Ge(e,[{key:"serializeJson",value:function(){return{curve:this.curve.label}}}]),e}(),Fe=function(){function e(t,r,n){je(this,e),this.key=t,void 0===r&&(r=Me.fromLabel(x.algorithm)),void 0===n&&(n=We.deserializeJson(x.parameters)),this.algorithm=r,this.parameters=n}return Ge(e,[{key:"computeHash",value:function(e,t){switch(t){case Ue.ECDSAwithSHA224:return W.SHA224(W.enc.Hex.parse(e)).toString();case Ue.ECDSAwithSHA256:return W.SHA256(W.enc.Hex.parse(e)).toString();case Ue.ECDSAwithSHA384:return W.SHA384(W.enc.Hex.parse(e)).toString();case Ue.ECDSAwithSHA512:case Ue.EDDSAwithSHA512:return W.SHA512(W.enc.Hex.parse(e)).toString();case Ue.ECDSAwithSHA3_224:return Object(Je.sha3_224)(ne(e));case Ue.ECDSAwithSHA3_256:return Object(Je.sha3_256)(ne(e));case Ue.ECDSAwithSHA3_384:return Object(Je.sha3_384)(ne(e));case Ue.ECDSAwithSHA3_512:return Object(Je.sha3_512)(ne(e));case Ue.ECDSAwithRIPEMD160:return W.RIPEMD160(W.enc.Hex.parse(e)).toString();case Ue.SM2withSM3:return(new Y.sm3).sum(ne(e),"hex");default:throw new Error("Unsupported hash algorithm.")}}},{key:"isSchemaSupported",value:function(e){switch(e){case Ue.ECDSAwithSHA224:case Ue.ECDSAwithSHA256:case Ue.ECDSAwithSHA384:case Ue.ECDSAwithSHA512:case Ue.ECDSAwithSHA3_224:case Ue.ECDSAwithSHA3_256:case Ue.ECDSAwithSHA3_384:case Ue.ECDSAwithSHA3_512:case Ue.ECDSAwithRIPEMD160:return this.algorithm===Me.ECDSA;case Ue.EDDSAwithSHA512:return this.algorithm===Me.EDDSA;case Ue.SM2withSM3:return this.algorithm===Me.SM2;default:throw new Error("Unsupported signature schema.")}}},{key:"serializeJson",value:function(){return{algorithm:this.algorithm.label,parameters:this.parameters.serializeJson(),key:this.key}}}]),e}(),qe=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Qe=function(e){function t(){return Ye(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Fe),qe(t,[{key:"verify",value:function(e,t){if(!this.isSchemaSupported(t.algorithm))throw new Error("Signature schema does not match key type.");"string"!=typeof e&&(e=e.getSignContent());var r=void 0;return r=t.algorithm===Ue.SM2withSM3?e:this.computeHash(e,t.algorithm),this.verifySignature(r,t.value,t.algorithm)}},{key:"serializeHex",value:function(){var e="";switch(this.algorithm){case Me.ECDSA:e+=this.key;break;case Me.EDDSA:case Me.SM2:e+=ve(this.algorithm.hex),e+=ve(this.parameters.curve.hex),e+=this.key}return e}},{key:"verifySignature",value:function(e,t,r){switch(r){case Ue.ECDSAwithSHA224:case Ue.ECDSAwithSHA256:case Ue.ECDSAwithSHA384:case Ue.ECDSAwithSHA512:case Ue.ECDSAwithSHA3_224:case Ue.ECDSAwithSHA3_256:case Ue.ECDSAwithSHA3_384:case Ue.ECDSAwithSHA3_512:case Ue.ECDSAwithRIPEMD160:return this.verifyEcDSASignature(e,t);case Ue.EDDSAwithSHA512:return this.verifyEdDSASignature(e,t);case Ue.SM2withSM3:return this.verifySM2Signature(e,t);default:throw new Error("Unsupported signature schema.")}}},{key:"verifyEcDSASignature",value:function(e,t){var r=t.substr(0,64),n=t.substr(64,64);return new q.ec(this.parameters.curve.preset).verify(e,{r:r,s:n},this.key,"hex")}},{key:"verifyEdDSASignature",value:function(e,t){var r=t.substr(0,64),n=t.substr(64,64);return new q.eddsa(this.parameters.curve.preset).verify(e,{r:r,s:n},this.key,"hex")}},{key:"verifySM2Signature",value:function(e,t){var r=new me(t),n=se(r.readNullTerminated());if(n!==P&&""!==n)throw new Error("Unsupported SM2 id used.");var a=r.read(32),i=r.read(32);return Y.sm2.SM2KeyPair(this.key).verify(ne(e),a,i)}}],[{key:"deserializeHex",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:33;if(33===r){var n=Me.ECDSA,a=Ve.SECP256R1;return new t(e.read(33),n,new We(a))}var i=parseInt(e.read(1),16),o=parseInt(e.read(1),16);return new t(e.read(r-2),Me.fromHex(i),new We(Ve.fromHex(o)))}}]),t}(),Xe=function(){function e(t){Ye(this,e),this.label=t,e.values.push(this)}return qe(e,null,[{key:"fromHexLabel",value:function(t){var r=se(t),n=e.values.find(function(e){return e.label===r});if(void 0===n)throw new Error("Enum value not found");return n}}]),e}();function Ze(e,t){if(e.algorithm!==t.algorithm)return e.algorithm.hex-t.algorithm.hex;switch(e.algorithm){case Me.ECDSA:var r=new q.ec(e.parameters.curve.preset),n=r.keyFromPublic(e.key,"hex",!0),a=r.keyFromPublic(t.key,"hex",!0),i=n.getPublic(),o=a.getPublic();return i.getX()!==o.getX()?i.getX()-o.getX():i.getY()-o.getY();case Me.SM2:var u=new Y.sm2.SM2KeyPair,s=new Y.sm2.SM2KeyPair;return u._pubFromString(e.key),s._pubFromString(t.key),u.getX().toString()!==s.getX().toString()?Number(u.getX().toString())-Number(s.getX().toString()):Number(u.getY().toString())-Number(s.getY().toString());case Me.EDDSA:return Number(e.key)-Number(t.key);default:return 0}}function $e(e){return ve(e)}function et(e){return-1===e?ve(F.PUSHM1):0===e?ve(F.PUSH0):e>0&&e<=16?ve(F.PUSH1-1+e):ve(e,8,!0)}function tt(e){return 0===e?$e(F.PUSH0):e<=16?ve(e-1+F.PUSH1):rt(new He(e.toString()).toHexstr())}function rt(e){var t="";if(0===e.length)throw new Error("pushBytes error, hexstr is empty.");var r=e.length/2;if(r<=F.PUSHBYTES75+1-F.PUSHBYTES1)t+=ve(r+F.PUSHBYTES1-1);else if(r<256)t+=ve(F.PUSHDATA1),t+=ve(r);else if(r<65536)t+=ve(F.PUSHDATA2),t+=ve(r,2,!0);else{if(!(r<4294967296))throw g.INVALID_PARAMS;t+=ve(F.PUSHDATA4),t+=ve(r,4,!0)}return t+=e}function nt(e){var t="";return t+=function(e){return rt(e.serializeHex())}(e),t+=$e(F.CHECKSIG)}function at(e,t){var r=e.length;if(!(1<=t&&t<=r&&r<=1024))throw new Error("Wrong multi-sig param");e.sort(Ze);var n="";n+=tt(t);var a=!0,i=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){n+=rt(u.value.serializeHex())}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}return n+=tt(r),n+=$e(F.CHECKMULTISIG)}function it(e){var t="";e.sort();var r=!0,n=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){t+=rt(i.value)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t}function ot(e){return parseInt(e.read(1),16)}function ut(e){var t=ot(e),r=void 0;if(t===F.PUSHDATA4)r=e.readUint32();else if(t===F.PUSHDATA2)r=e.readUint16();else if(t===F.PUSHDATA1)r=e.readUint8();else{if(!(t<=F.PUSHBYTES75&&t>=F.PUSHBYTES1))throw new Error("unexpected opcode: "+t);r=t-F.PUSHBYTES1+1}return e.read(r)}function st(e){var t=e.readNextBytes();return Qe.deserializeHex(new me(t))}Xe.values=[],Xe.IN_USE=new Xe("in use"),Xe.REVOKED=new Xe("revoked");var ct=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};var lt,ft,ht=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e){e.Boolean="Boolean",e.Integer="Integer",e.ByteArray="ByteArray",e.Interface="Interface",e.Array="Array",e.Struct="Struct",e.Map="Map",e.String="String",e.Int="Int",e.Long="Long",e.IntArray="IntArray",e.LongArray="LongArray",e.Address="Address"}(lt||(lt={})),function(e){e[e.ByteArray=0]="ByteArray",e[e.Boolean=1]="Boolean",e[e.Integer=2]="Integer",e[e.Interface=64]="Interface",e[e.Array=128]="Array",e[e.Struct=129]="Struct",e[e.Map=130]="Map"}(ft||(ft={}));var vt=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.type=r,this.value=n}return ht(e,[{key:"getName",value:function(){return this.name}},{key:"getType",value:function(){return this.type}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){return e.type===this.type&&e.name===this.name&&null!=e.value&&(this.value=e.value,!0)}}]),e}(),dt=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var yt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.list=[]}return dt(e,[{key:"add",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;this.list.push(s)}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}}}]),e}(),pt=function(e){var t="";return t+=ve(e?F.PUSHT:F.PUSHF)},gt=function(e){var t="";if(-1===e)t=ve(F.PUSHM1);else if(0===e)t=ve(F.PUSH0);else if(e>0&&e<16){var r=F.PUSH1-1+e;t=ve(r)}else{var n=new He(e.toString()).toHexstr();t=wt(n)}return t},mt=function(e){var t="";if(e.isEqualTo(-1))t=ve(F.PUSHM1);else if(e.isEqualTo(0))t=ve(F.PUSH0);else if(e.isGreaterThan(0)&&e.isLessThan(16)){var r=F.PUSH1-1+e.toNumber();t=ve(r)}else{var n=new He(e.toString()).toHexstr();t=wt(n)}return t},wt=function(e){var t="",r=e.length/2;return r<=F.PUSHBYTES75?t+=ve(r):r<256?(t+=ve(F.PUSHDATA1),t+=ve(r)):r<65536?(t+=ve(F.PUSHDATA2),t+=ve(r,2,!0)):(t+=ve(F.PUSHDATA4),t+=ve(r,4,!0)),t+=e},St=function(e){var t="";t+=ve(ft.Struct),t+=ve(e.list.length);var r=!0,n=!1,a=void 0;try{for(var i,o=e.list[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;if("string"==typeof u)t+=ve(ft.ByteArray),t+=wt(u);else{if("number"!=typeof u)throw g.INVALID_PARAMS;t+=ve(ft.ByteArray),t+=wt(de(u))}}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t},bt=function(e){var t="";t+=ve(ft.Map),t+=ve(e.size);var r=!0,n=!1,a=void 0;try{for(var i,o=e.keys()[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;t+=ve(ft.ByteArray),t+=wt(ue(u));var s=e.get(u);if(s&&s.getType()===lt.ByteArray)t+=ve(ft.ByteArray),t+=wt(s.getValue());else if(s&&s.getType()===lt.String)t+=ve(ft.ByteArray),t+=wt(ue(s.getValue()));else if(s&&s.getType()===lt.Integer)t+=ve(ft.Integer),t+=wt(de(s.getValue()));else{if(!s||s.getType()!==lt.Long)throw g.INVALID_PARAMS;t+=ve(ft.Integer),t+=wt(de(s.getValue()))}}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t},At=function(e){var t="";t+=ve(F.NEWMAP),t+=ve(F.TOALTSTACK);var r=!0,n=!1,a=void 0;try{for(var i,o=e.keys()[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;t+=ve(F.DUPFROMALTSTACK),t+=wt(ue(u)),t+=kt(e.get(u)),t+=ve(F.SETITEM)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t+=ve(F.FROMALTSTACK)},kt=function e(t){if(!t)throw Error("Parameter can not be undefined");var r="";if(t.type===lt.ByteArray)r+=wt(t.value);else if(t.type===lt.String)r+=wt(ue(t.value));else if(t.type===lt.Boolean)r+=pt(Boolean(t.value)),r+=ve(F.PUSH0),r+=ve(F.BOOLOR);else if(t instanceof Map)r+=At(t);else if(t.type===lt.Array){for(var n=t.value.length-1;n>-1;n--)r+=e(t.value[n]);r+=gt(t.value.length),r+=ve(F.PACK)}else if(t.type===lt.Integer)r+=gt(t.value),r+=ve(F.PUSH0),r+=ve(F.ADD);else{if(t.type!==lt.Long)throw Error("Invalid parameter type: "+t.type);r+=mt(new Q.BigNumber(t.value)),r+=ve(F.PUSH0),r+=ve(F.ADD)}return r},Rt=function(e){var t=[];t.push(ue(e.name));var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=e.parameters[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;s.getType()===lt.String?r.push(ue(s.getValue())):s.getType()===lt.Long?r.push(new Q.BigNumber(s.getValue())):s.getType()===lt.Map?r.push(Pt(s)):r.push(s.getValue())}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return t.length>0&&t.push(r),Tt(t)};function xt(e){var t=[],r=!0,n=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;u.getType&&u.getType()===lt.String?t.push(ue(u.getValue())):u.getType&&u.getType()===lt.Long?t.push(new Q.BigNumber(u.getValue())):u.getType&&u.getType()===lt.Array?t.push(xt(u.value)):u.getType&&u.getType()===lt.Map?t.push(Pt(u)):t.push(u.getValue?u.getValue():u)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t}function Pt(e){var t=new Map,r=!0,n=!1,a=void 0;try{for(var i,o=Object.keys(e.value)[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value,s=e.value[u];s.type&&s.type===lt.Map?t.set(u,Pt(s)):t.set(u,s)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t}function Et(e){var t=parseInt(e.read(1),16);if(t===ft.ByteArray)return e.readNextBytes();if(t===ft.Boolean)return e.readBoolean();if(t===ft.Integer)return pe(e.readNextBytes()).toNumber();if(t===ft.Array||t===ft.Struct){for(var r=[],n=e.readNextLen();n>0;n--){var a=Et(e);r.push(a)}return r}if(t===ft.Map){for(var i=e.readNextLen(),o=new Map,u=i;u>0;u--){var s=se(Et(e)),c=Et(e);o.set(s,c)}return o}throw Error("Invalid parameter type: "+t)}var Tt=function e(t){for(var r="",n=t.length-1;n>=0;n--){var a=t[n];if("string"==typeof a)r+=wt(a);else if("number"==typeof a)r+=gt(a);else if("boolean"==typeof a)r+=pt(a);else if(a instanceof Q.BigNumber)r+=mt(a);else if(a instanceof Map)r+=At(a);else if(a instanceof yt){var i=St(a);r+=wt(i)}else a instanceof Array&&(r+=e(xt(a)),r+=gt(a.length),r+=ve(F.PACK))}return r},Ot=function(e,t){for(var r="",n=t.length-1;n>-1;n--){switch(t[n].getType()){case lt.Boolean:r+=pt(t[n].getValue());break;case lt.Integer:r+=gt(t[n].getValue());break;case lt.String:var a=ue(t[n].getValue());r+=wt(a);break;case lt.ByteArray:r+=wt(t[n].getValue());break;case lt.Map:var i=bt(t[n].getValue());r+=wt(i);break;case lt.Struct:var o=St(t[n].getValue());r+=wt(o);break;default:throw new Error("Unsupported param type: "+JSON.stringify(t[n]))}}return r+=gt(t.length),r+=ve(F.PACK),r+=wt(ue(e))},Nt=function(e){var t=[],r=!0,n=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value,s=void 0;switch(u.getType()){case lt.String:s={type:"string",value:u.getValue()};break;case lt.Int:s={type:"int",value:u.getValue().toString()};break;case lt.Long:s={type:"int64",value:u.getValue()};break;case lt.IntArray:case lt.LongArray:s={type:"int_array",value:u.getValue()}}t.push(s)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}var c={Params:t};return ue(JSON.stringify(c))},It=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Ct=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),40!==t.length&&34!==t.length)throw g.INVALID_PARAMS;this.value=t}return It(e,null,[{key:"deserialize",value:function(t){return new e(t.read(20))}},{key:"fromPubKey",value:function(t){return new e(xe(nt(t)))}},{key:"fromOntid",value:function(t){return new e(t.substr(8))}},{key:"fromVmCode",value:function(t){return new e(xe(t))}},{key:"fromMultiPubKeys",value:function(t,r){var n=r.length;if(t<=0||t>n||n>24)throw g.INVALID_PARAMS;r.sort(Ze);var a="";a+=et(t);var i=!0,o=!1,u=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;a+=wt(l.serializeHex())}}catch(e){o=!0,u=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw u}}return a+=et(n),new e(xe(a+=ve(F.CHECKMULTISIG)))}},{key:"generateOntid",value:function(t){return"did:ont:"+e.fromPubKey(t).toBase58()}}]),It(e,[{key:"toBase58",value:function(){return 34===this.value.length?this.value:Bt(this.value)}},{key:"toHexString",value:function(){var e=void 0;return e=40===this.value.length?this.value:Dt(this.value),ye(e)}},{key:"serialize",value:function(){return 40===this.value.length?this.value:Dt(this.value)}},{key:"getB58Checksum",value:function(){var e=this.toBase58();return ke(W.SHA256(e).toString()).slice(0,8)}}]),e}();function Bt(e){var t=S+e,r=t+ke(ke(t)).slice(0,8);return j.encode(new Buffer(r,"hex"))}function Dt(e){var t=ae(j.decode(e)).substr(2,40);if(e!==Bt(t))throw new Error("[addressToU160] decode encoded verify failed");return t}var _t=r(12),Ht=r(13),zt=r(14);function Ut(e,t,r){var n=[];return zt(e.normalize("NFC"),ne(t),{N:r.cost,r:r.blockSize,p:r.parallel,dkLen:r.size},function(e){n=e}),new Buffer(n)}function Lt(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b,a=Qe.deserializeHex(new me(t)),i=Ut(r,Ct.fromPubKey(a).getB58Checksum(),n).toString("hex"),o=i.slice(0,32),u=i.slice(64),s=W.enc.Hex.parse(o),c=W.AES.encrypt(W.enc.Hex.parse(e),W.enc.Hex.parse(u),{mode:W.mode.CTR,padding:W.pad.NoPadding,iv:s}).ciphertext.toString();return new Buffer(c,"hex").toString("base64")}function Mt(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b,a=Buffer.from(e,"base64").toString("hex"),i="";if("string"==typeof r&&8===r.length)i=r;else{if(!(r instanceof Ct))throw g.INVALID_PARAMS;i=r.getB58Checksum()}var o=Ut(t,i,n).toString("hex"),u=o.slice(0,32),s=o.slice(64),c=W.enc.Hex.parse(u),l={ciphertext:W.enc.Hex.parse(a),salt:"",iv:""};return W.AES.decrypt(l,W.enc.Hex.parse(s),{mode:W.mode.CTR,padding:W.pad.NoPadding,iv:c}).toString()}function Kt(e,t){var r="";if("string"==typeof e&&8===e.length)r=e;else{if(!(e instanceof Ct))throw g.INVALID_PARAMS;r=e.getB58Checksum()}var n=Qe.deserializeHex(new me(t));if(Ct.fromPubKey(n).getB58Checksum()!==r)throw console.log("keyphrase error."),g.Decrypto_ERROR}function Vt(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b,a=Qe.deserializeHex(new me(t)),i=Ct.fromPubKey(a).getB58Checksum(),o=Ut(r,i,n).toString("hex"),u=o.slice(0,64),s=o.slice(64),c=he(e,u),l=W.AES.encrypt(W.enc.Hex.parse(c),W.enc.Hex.parse(s),{mode:W.mode.ECB,padding:W.pad.NoPadding}),f=A+k+i+l.ciphertext.toString();return j.encode(Buffer.from(f,"hex"))}function Jt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,n=ae(j.decode(e)),a=n.substr(6,8),i=n.substr(-64),o=Ut(t,a,r).toString("hex"),u=o.slice(0,64),s=o.slice(64),c={ciphertext:W.enc.Hex.parse(i),salt:"",iv:""};return he(W.AES.decrypt(c,W.enc.Hex.parse(s),{mode:W.mode.ECB,padding:W.pad.NoPadding}).toString(),u)}function Gt(e,t,r){var n=ae(j.decode(e)).substr(6,8),a=Qe.deserializeHex(new me(r));if(Ct.fromPubKey(a).getB58Checksum()!==n)throw console.log("keyphrase error."),g.Decrypto_ERROR}function jt(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:b;if(!Ce(e))throw new Error(g.INVALID_PARAMS+", Invalid private key");var i=Ut(n,r,a),o=i.slice(0,12),u=i.slice(32),s=o,c=new Buffer(t.toBase58()),l=Object(Ht.createCipheriv)("aes-256-gcm",u,s);l.setAAD(c);var f=Buffer.from(e,"hex"),h=l.update(f),v=l.final(),d=l.getAuthTag();return h=Buffer.concat([h,v]),Buffer.concat([h,d]).toString("base64")}function Wt(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:b;if(32!==r.length)throw g.INVALID_PARAMS;var i=Buffer.from(e,"base64"),o=i.slice(0,i.length-16),u=i.slice(i.length-16),s=Ut(n,r,a),c=s.slice(0,12),l=s.slice(32),f=c,h=new Buffer(t.toBase58()),v=Object(Ht.createDecipheriv)("aes-256-gcm",l,f);v.setAAD(h),v.setAuthTag(u);var d=v.update(o).toString("hex");try{d+=v.final().toString("hex")}catch(e){throw g.Decrypto_ERROR}return d}var Ft=r(4),qt=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Yt=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.algorithm=t,this.value=r,this.publicKeyId=n}return qt(e,null,[{key:"deserializeJWT",value:function(t,r,n){return new e(r,Ft.decode(t,"hex"),n)}},{key:"deserializePgp",value:function(t){var r=new Buffer(t.Value,"base64").toString("hex"),n=e.deserializeHex(r).value;return new e(Ue.fromLabel(t.Algorithm),n)}},{key:"deserializeHex",value:function(t){if(t.length<4)throw new Error("Invalid params.");var r=new me(t),n=parseInt(r.read(1),16);return new e(Ue.fromHex(n),t.substr(2))}}]),qt(e,[{key:"serializeHex",value:function(){var e="";return e+=ve(this.algorithm.hex),e+=this.value}},{key:"serializePgp",value:function(e){return{PublicKeyId:e,Format:"pgp",Value:new Buffer(this.serializeHex(),"hex").toString("base64"),Algorithm:this.algorithm.label}}},{key:"serializeJWT",value:function(){return Ft.encode(this.value,"hex")}}]),e}(),Qt=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Xt=r(11),Zt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Fe),Qt(t,[{key:"sign",value:function(e,t,r){if(void 0===t&&(t=this.algorithm.defaultSchema),!this.isSchemaSupported(t))throw new Error("Signature schema does not match key type.");"string"!=typeof e&&(e=e.getSignContent());var n=void 0;n=t===Ue.SM2withSM3?e:this.computeHash(e,t);var a=this.computeSignature(n,t);return new Yt(t,a,r)}},{key:"signAsync",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sign(t,r,n));case 1:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getPublicKey",value:function(){switch(this.algorithm){case Me.ECDSA:return this.getEcDSAPublicKey();case Me.EDDSA:return this.getEdDSAPublicKey();case Me.SM2:return this.getSM2PublicKey();default:throw new Error("Unsupported signature schema.")}}},{key:"decrypt",value:function(e,r,n,a){24===n.length&&Ie(n)&&(n=Buffer.from(n,"base64").toString("hex"));var i=new t(Wt(this.key,r,n,e,a),this.algorithm,this.parameters),o=i.getPublicKey();if(Ct.fromPubKey(o).toBase58()!==r.toBase58())throw g.Decrypto_ERROR;return i}},{key:"encrypt",value:function(e,r,n,a){var i=this.getPublicKey();if(Ct.fromPubKey(i).toBase58()!==r.toBase58())throw g.INVALID_ADDR;return new t(jt(this.key,r,n,e,a),this.algorithm,this.parameters)}},{key:"getEcDSAPublicKey",value:function(){var e=new q.ec(this.parameters.curve.preset).keyFromPrivate(this.key,"hex").getPublic(!0,"hex");return new Qe(e,this.algorithm,this.parameters)}},{key:"getEdDSAPublicKey",value:function(){var e=new q.eddsa(this.parameters.curve.preset).keyFromSecret(this.key,"hex").getPublic(!0,"hex");return new Qe(e,this.algorithm,this.parameters)}},{key:"getSM2PublicKey",value:function(){var e=Y.sm2.SM2KeyPair(null,this.key).pubToString("compress");return new Qe(e,this.algorithm,this.parameters)}},{key:"computeSignature",value:function(e,t){switch(t){case Ue.ECDSAwithSHA224:case Ue.ECDSAwithSHA256:case Ue.ECDSAwithSHA384:case Ue.ECDSAwithSHA512:case Ue.ECDSAwithSHA3_224:case Ue.ECDSAwithSHA3_256:case Ue.ECDSAwithSHA3_384:case Ue.ECDSAwithSHA3_512:case Ue.ECDSAwithRIPEMD160:return this.computeEcDSASignature(e);case Ue.EDDSAwithSHA512:return this.computeEdDSASignature(e);case Ue.SM2withSM3:return this.computeSM2Signature(e);default:throw new Error("Unsupported signature schema.")}}},{key:"computeEcDSASignature",value:function(e){var t=new q.ec(this.parameters.curve.preset).sign(e,this.key,{canonical:!0});return Buffer.concat([t.r.toArrayLike(Buffer,"be",32),t.s.toArrayLike(Buffer,"be",32)]).toString("hex")}},{key:"computeEdDSASignature",value:function(e){var t=new q.eddsa(this.parameters.curve.preset).sign(e,this.key,null);return Buffer.concat([t.R.toArrayLike(Buffer,"be",32),t.S.toArrayLike(Buffer,"be",32)]).toString("hex")}},{key:"computeSM2Signature",value:function(e){var t=Y.sm2.SM2KeyPair(null,this.key).sign(ne(e));return ue(P+"\0")+t.r+t.s}},{key:"serializeWIF",value:function(){return _t.encode(128,Buffer.from(this.key,"hex"),!0)}}],[{key:"random",value:function(e,r){return void 0===e&&(e=Me.fromLabel(x.algorithm)),void 0===r&&(r=We.deserializeJson(x.parameters)),new t(ae(ee(32)),e,r)}},{key:"deserializeWIF",value:function(e){return new t(ae(_t.decode(e,128).privateKey))}},{key:"generateFromMnemonic",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;if(e.split(" ").length<12)throw g.INVALID_PARAMS;var n=w.mnemonicToSeedHex(e),a=Xt.fromMasterSeed(Buffer.from(n,"hex")).derive(r);return new t(Buffer.from(a.privateKey).toString("hex"))}}]),t}(),$t=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var er=[],tr=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return $t(e,[{key:"getType",value:function(){return""}},{key:"deserialize",value:function(e){if(null!=e.key)return new Zt(e.key,Me.fromLabel(e.algorithm),We.deserializeJson(e.parameters));throw new Error("Unsupported Key type.")}}]),e}());function rr(e){er.push(e)}function nr(e){if(null==e.external)return tr.deserialize(e);var t=!0,r=!1,n=void 0;try{for(var a,i=er[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;if(o.getType()===e.external.type)return o.deserialize(e)}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}throw new Error("Unsupported Key type.")}var ar=r(15),ir=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function or(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ur(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var cr=function(){function e(t){sr(this,e),this.param=new fr(t),this.sk=new vr(this.param)}return ir(e,[{key:"GenerateSk",value:function(){return this.sk.Rand(),this.sk}},{key:"GenerateKeyPair",value:function(){this.sk=vr.GenerateSk(this.param),this.pk=this.sk.GenerateIssuerPublicKey()}},{key:"SetAttributeSet",value:function(e){this.AttributeName=e,this.pk.GenerateAttr(e)}},{key:"Sign",value:function(e,t){var r=this.param.getRandBN(),n=this.param.getRandBN(),a=new this.param.ECP;a.copy(this.param.g1),a.add(this.param.PAIR.G1mul(this.pk.h0,n)),a.add(e);for(var i=0;i<this.pk.attr.length;i++)a.add(this.param.PAIR.G1mul(this.pk.h[i],t[i]));var o=new this.param.ECP,u=new this.param.BIG;u.copy(r),u.add(this.sk.value),u.invmodp(this.param.order),o=this.param.PAIR.G1mul(a,u);var s=new yr(this.param);return s.Set(o,a,r,n,t),s}},{key:"GetPk",value:function(){return dr.COPY(this.pk)}},{key:"GenerateNonce",value:function(){return this.param.getRandBN()}},{key:"VerifyCredentialRequest",value:function(e){return this.pk.VerifyCredentialRequest(e)}}]),e}(),lr=function(){function e(t){sr(this,e),this.param=new fr(t)}return ir(e,[{key:"GenerateSk",value:function(){return this.sk=vr.GenerateSk(this.param),this.sk}},{key:"SetIpk",value:function(e){this.ipk=dr.COPY(e)}},{key:"GenerateCrendentialRequest",value:function(e){if(void 0!==this.ipk){var t=this.ipk,r=this.param.PAIR.G1mul(t.h_sk,this.sk.value),n=this.param.getRandBN(),a=this.param.PAIR.G1mul(t.h_sk,n),i=this.param.hashToBN(a,t.h_sk,r,e),o=this.param.BIG.modmul(i,this.sk.value,this.param.order);o.add(n),o.mod(this.param.order);var u={C:i,S:o},s=this.param.genAttrBN(t.attr);return this.Nym=r,this.attrs=s,{Nym:r,pi:u,nonce:e,attrs:s}}console.log("Please set ipk first.")}},{key:"VerifyBBSplus",value:function(e){var t=new this.param.ECP2;t.copy(this.ipk.w),t.add(this.param.PAIR.G2mul(this.param.g2,e.sig.e)),t.affine();var r=new this.param.ECP;r.copy(e.sig.A),r.affine();var n=this.param.PAIR.ate(t,r);n=this.param.PAIR.fexp(n);var a=new this.param.ECP;a.copy(this.param.g1),a.add(this.param.PAIR.G1mul(this.ipk.h0,e.sig.s)),a.add(this.Nym);for(var i=0;i<e.attrs.length;i++)a.add(this.param.PAIR.G1mul(this.ipk.h[i],e.attrs[i]));a.affine();var o=this.param.PAIR.ate(this.param.g2,a);return o=this.param.PAIR.fexp(o),n.equals(o)}},{key:"SetCredential",value:function(e){return this.Cred=new yr(this.param),this.Cred.Copy(e),!0}},{key:"Prove",value:function(e){var t=this.ipk,r=this.Cred,n=this.param.getRandBN(),a=this.param.PAIR.G1mul(r.sig.A,n),i=new this.param.BIG(0);i.copy(n),i.invmodp(this.param.order);var o=new this.param.BIG(0);o.copy(r.sig.e),o=this.param.BIG.modneg(o,this.param.order);var u=this.param.PAIR.G1mul(a,o);u.add(this.param.PAIR.G1mul(r.sig.B,n));var s=this.param.getRandBN(),c=new this.param.BIG(0);c.copy(s),c=this.param.BIG.modneg(c,this.param.order);var l=this.param.PAIR.G1mul(r.sig.B,n);l.add(this.param.PAIR.G1mul(t.h0,c));var f=this.param.BIG.modmul(s,i,this.param.order);(f=this.param.BIG.modneg(f,this.param.order)).add(r.sig.s),f.mod(this.param.order);for(var h=[],v=0;v<e.length;v++)0===e[v]?h[v]=this.param.getRandBN():h[v]=!1;var d=this.param.getRandBN(),y=this.param.getRandBN(),p=this.param.getRandBN(),g=this.param.getRandBN(),m=this.param.getRandBN(),w=this.param.PAIR.G1mul(t.h_sk,m),S=this.param.PAIR.G1mul(a,d);S.add(this.param.PAIR.G1mul(t.h0,y));var b=this.param.PAIR.G1mul(l,p);b.add(this.param.PAIR.G1mul(t.h0,g)),b.add(this.param.PAIR.G1mul(w,new this.param.BIG(-1)));for(var A=0;A<h.length;A++)!1!==h[A]&&b.add(this.param.PAIR.G1mul(t.h[A],h[A]));var k=this.param.hashToBN(a,u,l,this.Nym,S,b,this.param.g1,t.h0,t.h,t.w),R=this.param.getRandBN(),x=this.param.hashToBN(R,k,e,this.attrs),P=new this.param.BIG(0);P.copy(m),P.add(this.param.BIG.modmul(x,this.sk.value,this.param.order)),P.mod(this.param.order);for(var E=[],T=0;T<e.length;T++)0===e[T]?(E[T]=new this.param.BIG(0),E[T].copy(h[T]),E[T].sub(this.param.BIG.modmul(x,this.attrs[T],this.param.order)),E[T].mod(this.param.order)):E[T]=!1;var O=new this.param.BIG(0);O.copy(d),O.sub(this.param.BIG.modmul(x,r.sig.e,this.param.order)),O.mod(this.param.order);var N=new this.param.BIG(0);N.copy(y),N.add(this.param.BIG.modmul(x,s,this.param.order)),N.mod(this.param.order);var I=new this.param.BIG(0);I.copy(p),I.add(this.param.BIG.modmul(x,i,this.param.order)),I.mod(this.param.order);var C=new this.param.BIG(0);C.copy(g),C.sub(this.param.BIG.modmul(x,f,this.param.order)),C.mod(this.param.order);var B={c:x,s_sk:P,s_a:E,s_e:O,s_r2:N,s_r3:I,s_s_:C,nonce:R};return{A_:a,_A:u,B_:l,Nym:this.Nym,pi:B}}},{key:"Verify",value:function(e,t,r){var n=this.ipk,a=new this.param.ECP(0);if(e.A_.equals(a))return console.log("A' == O return true, verify failed."),!1;var i=new this.param.ECP;i.copy(e.A_);var o=new this.param.ECP2;o.copy(n.w);var u=new this.param.ECP;u.copy(e._A);var s=new this.param.ECP2;s.copy(this.param.g2),i.affine(),o.affine(),u.affine(),s.affine();var c=this.param.PAIR.ate(o,i),l=this.param.PAIR.ate(s,u);if(c=this.param.PAIR.fexp(c),l=this.param.PAIR.fexp(l),!c.equals(l))return console.log("e(A', w) == e(_A, g2) return false, verify failed."),!1;u.copy(e._A);var f=this.param.PAIR.G1mul(i,e.pi.s_e);f.add(this.param.PAIR.G1mul(n.h0,e.pi.s_r2)),u.sub(e.B_),f.add(this.param.PAIR.G1mul(u,this.param.BIG.modneg(e.pi.c,this.param.order)));var h=this.param.PAIR.G1mul(e.B_,e.pi.s_r3);h.add(this.param.PAIR.G1mul(n.h0,e.pi.s_s_)),h.add(this.param.PAIR.G1mul(n.h_sk,this.param.BIG.modneg(e.pi.s_sk,this.param.order)));var v=new this.param.ECP;v.copy(this.param.g1);for(var d=0;d<t.length;d++)0===t[d]?h.add(this.param.PAIR.G1mul(n.h[d],e.pi.s_a[d])):v.add(this.param.PAIR.G1mul(n.h[d],r[d]));h.add(this.param.PAIR.G1mul(v,this.param.BIG.modneg(e.pi.c,this.param.order)));var y=this.param.hashToBN(e.A_,e._A,e.B_,e.Nym,f,h,this.param.g1,n.h0,n.h,n.w),p=this.param.hashToBN(e.pi.nonce,y,t,r);return 0===this.param.BIG.comp(p,e.pi.c)||(console.log("c == H(nonce, H(A', _A, B', Nym, ~t1, ~t2, g1, HRand, h1, ... , hL, w), (D, I)) return false, verify failed."),!1)}}]),e}(),fr=function(){function e(t){sr(this,e),this.curve=t,this.ctx=new ar(t),this.PAIR=this.ctx.PAIR,this.ECP=this.ctx.ECP,this.ECP2=this.ctx.ECP2,this.BIG=this.ctx.BIG,this.rng=new this.ctx.RAND,this.g1=this.getG1Generator(),this.g2=this.getG2Generator(),this.order=this.getOrder()}return ir(e,[{key:"getG1Generator",value:function(){var e=new this.ctx.ECP(0),t=new this.ctx.BIG(0),r=new this.ctx.BIG(0);return t.rcopy(this.ctx.ROM_CURVE.CURVE_Gx),r.rcopy(this.ctx.ROM_CURVE.CURVE_Gy),e.setxy(t,r),e}},{key:"getG2Generator",value:function(){var e=new this.ctx.ECP2(0),t=new this.ctx.BIG(0),r=new this.ctx.BIG(0),n=new this.ctx.FP2(0),a=new this.ctx.FP2(0);return t.rcopy(this.ctx.ROM_CURVE.CURVE_Pxa),r.rcopy(this.ctx.ROM_CURVE.CURVE_Pxb),n.bset(t,r),t.rcopy(this.ctx.ROM_CURVE.CURVE_Pya),r.rcopy(this.ctx.ROM_CURVE.CURVE_Pyb),a.bset(t,r),e.setxy(n,a),e}},{key:"getOrder",value:function(){var e=new this.ctx.BIG(0);return e.rcopy(this.ctx.ROM_CURVE.CURVE_Order),e}},{key:"getRandBN",value:function(){var e=Pe(256);return this.rng.clean(),this.rng.seed(256,e),this.BIG.randomnum(this.order,this.rng)}},{key:"getRandG1",value:function(){var e=this.getRandBN();return this.PAIR.G1mul(this.g1,e)}},{key:"getRandG2",value:function(){var e=this.getRandBN();return this.PAIR.G2mul(this.g2,e)}},{key:"hashToBN",value:function(){for(var e=[],t=[],r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];n.forEach(function(r){Array.isArray(r)?"number"==typeof r[0]?(e=e.concat(r),t=[]):r.forEach(function(r){r.toBytes(t),e=e.concat(t),t=[]}):(r.toBytes(t),e=e.concat(t),t=[])});var i=new this.ctx.HASH256;i.process_array(e);var o=i.hash(),u=this.BIG.fromBytes(o);return u.mod(this.order),u}},{key:"genAttrBN",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=this.getRandBN();t[r]=n}return t}},{key:"genAttrElement",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=this.getRandG1();t[r]=n}return t}}]),e}(),hr=function e(t){sr(this,e),this.param=t},vr=function(e){function t(e){sr(this,t);var r=or(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.value=new r.param.BIG(0),r}return ur(t,hr),ir(t,null,[{key:"GenerateSk",value:function(e){var r=e.getRandBN(),n=new t(e);return n.setValue(r),n}}]),ir(t,[{key:"setValue",value:function(e){this.value.copy(e)}},{key:"GenerateIssuerPublicKey",value:function(){var e=this.value,t=this.param.PAIR.G2mul(this.param.g2,e),r=this.param.getRandBN(),n=this.param.PAIR.G1mul(this.param.g1,r),a=this.param.PAIR.G1mul(n,e);r=this.param.getRandBN();var i=this.param.PAIR.G2mul(this.param.g2,r),o=this.param.PAIR.G1mul(n,r),u=this.param.hashToBN(i,o,this.param.g2,n,t,a),s=this.param.BIG.modmul(u,e,this.param.order);s.add(r),s.mod(this.param.order);var c={C:u,S:s},l=new dr(this.param);return l.SetBasicValue(t,n,a,c),l}},{key:"ToBytes",value:function(){return void 0===this.value?"":this.value.toBytes()}},{key:"FromBytes",value:function(e){return this.value=this.param.BIG.fromBytes(e),this.value.toString()}},{key:"Rand",value:function(){var e=this.param.getRandBN();this.setValue(e)}}]),t}(),dr=function(e){function t(e){sr(this,t);var r=or(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.w=new r.param.ECP2,r._g1=new r.param.ECP,r._g2=new r.param.ECP;var n=new r.param.BIG,a=new r.param.BIG;return r.pi={C:n,S:a},r.h0=new r.param.ECP,r.h_sk=new r.param.ECP,r.attr=[],r}return ur(t,hr),ir(t,null,[{key:"COPY",value:function(e){var r=new t(e.param);return r.SetBasicValue(e.w,e._g1,e._g2,e.pi),r.SetAttrValue(e.h0,e.h_sk,e.h,e.attr),r}}]),ir(t,[{key:"SetBasicValue",value:function(e,t,r,n){this.w.copy(e),this._g1.copy(t),this._g2.copy(r),this.pi.C.copy(n.C),this.pi.S.copy(n.S)}},{key:"SetAttrValue",value:function(e,t,r,n){this.h0.copy(e),this.h_sk.copy(t),this.h=[],this.attr=[];for(var a=0;a<r.length;a++)this.h[a]=new this.param.ECP,this.h[a].copy(r[a]);for(var i=0;i<n.length;i++)this.attr[i]=n[i]}},{key:"GenerateAttr",value:function(e){var t=this.param.genAttrElement(e),r=this.param.getRandG1(),n=this.param.getRandG1(),a=[];t.forEach(function(e){a.push(e)}),this.h0=r,this.h_sk=n,this.h=a,this.attr=e}},{key:"VerifyCredentialRequest",value:function(e){var t=new this.param.BIG(0);t.copy(e.pi.C);var r=this.param.PAIR.G1mul(this.h_sk,e.pi.S);r.add(this.param.PAIR.G1mul(e.Nym,this.param.BIG.modneg(t,this.param.order)));var n=this.param.hashToBN(r,this.h_sk,e.Nym,e.nonce);return 0===this.param.BIG.comp(e.pi.C,n)}}]),t}(),yr=function(e){function t(e){sr(this,t);var r=or(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=new r.param.ECP,a=new r.param.ECP,i=new r.param.BIG,o=new r.param.BIG;return r.sig={A:n,B:a,e:i,s:o},r.attrs=[],r}return ur(t,hr),ir(t,[{key:"Set",value:function(e,t,r,n,a){this.sig.A.copy(e),this.sig.B.copy(t),this.sig.e.copy(r),this.sig.s.copy(n);for(var i=0;i<a.length;i++)this.attrs[i]=new this.param.BIG,this.attrs[i].copy(a[i])}},{key:"Copy",value:function(e){this.Set(e.sig.A,e.sig.B,e.sig.e,e.sig.s,e.attrs)}}]),t}(),pr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var gr=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.length>16||t&&!/^[0-9]\d*$/.test(t))throw new Error("Invalid value."+t);this.value=t||"0000000000000000"}return pr(e,null,[{key:"deserialize",value:function(t){var r=new e,n=t.read(8);for(n=ye(n);"00"===n.substr(0,2);)n=n.substring(2);return r.value=new Q.BigNumber(n,16).toString(),r}}]),pr(e,[{key:"serialize",value:function(){var e=new Q.BigNumber(this.value).toString(16);return e=e.length%16==0?e:("0".repeat(16)+e).substring(e.length),e=ye(e)}}]),e}(),mr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var wr=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.returntype=r,this.parameters=n}return mr(e,[{key:"getParameter",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,i=this.parameters[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;if(o.getName()===e)return o}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}return null}},{key:"setParamsValue",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,a=t.length;n<a;n++)for(var i=0;i<this.parameters.length;i++)t[n].name===this.parameters[i].getName()&&this.parameters[i].setValue(t[n])}},{key:"toString",value:function(){var e={name:this.name,returntype:this.returntype,parameters:this.parameters};return JSON.stringify(e)}}]),e}();var Sr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},br=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Ar=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sr),br(t,[{key:"serialize",value:function(){var e="";return e+=ce(this.code),e+=fe(this.needStorage),e+=le(this.name),e+=le(this.version),e+=le(this.author),e+=le(this.email),e+=le(this.description)}},{key:"deserialize",value:function(e){var t=e.readNextBytes();this.code=t;var r=e.read(1);this.needStorage="00"!==r;var n=e.readNextBytes();this.name=se(n);var a=e.readNextBytes();this.version=se(a);var i=e.readNextBytes();this.author=se(i);var o=e.readNextBytes();this.email=se(o);var u=e.readNextBytes();this.description=se(u)}}]),t}(),kr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Rr,xr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sr),kr(t,[{key:"serialize",value:function(){var e="";return e+=ce(this.code)}},{key:"deserialize",value:function(e){var t=e.readNextBytes();return this.code=t,this}}]),t}(),Pr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e){e[e.Nonce=0]="Nonce",e[e.Script=32]="Script",e[e.DescriptionUrl=129]="DescriptionUrl",e[e.Description=144]="Description"}(Rr||(Rr={}));var Er=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return Pr(e,[{key:"serialize",value:function(){var e="";if(e+=ve(this.usage),this.usage===Rr.Script)e+=this.data;else{if(this.usage!==Rr.DescriptionUrl&&this.usage!==Rr.Description&&this.usage!==Rr.Nonce)throw g.INVALID_PARAMS;e+=ce(this.data)}return e}},{key:"deserialize",value:function(e){var t=parseInt(e.read(1),16),r=e.readNextLen(),n=e.read(r);this.usage=t,this.data=n}}]),e}(),Tr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Or,Nr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return Tr(e,[{key:"serialize",value:function(){var e="",t=it(this.sigData),r="";if(0===this.pubKeys.length)throw new Error("No pubkeys in sig");return r=1===this.pubKeys.length?nt(this.pubKeys[0]):at(this.pubKeys,this.M),e+=ce(t),e+=ce(r)}}],[{key:"deserialize",value:function(t){var r=new e,n=t.readNextBytes(),a=t.readNextBytes(),i=function(e){for(var t=[],r=new me(e);!r.isEmpty();)t.push(ut(r));return t}(n),o=function(e){var t=new ct,r=parseInt(e.substr(-2,2),16);if(r===F.CHECKSIG){var n=st(new me(e));return t.M=1,t.pubKeys=[n],t}if(r===F.CHECKMULTISIG){var a=new me(e),i=parseInt(a.read(1),16)-F.PUSH1+1,o=parseInt(e.substr(-4,2),16)-F.PUSH1+1;t.M=i,t.pubKeys=[];for(var u=0;u<o;u++){var s=st(a);t.pubKeys.push(s)}return t}throw new Error("Unsupported program.")}(a);return r.M=o.M,r.pubKeys=o.pubKeys,r.sigData=i,r}},{key:"create",value:function(t,r,n){var a=new e;return a.M=1,a.pubKeys=[r.getPublicKey()],a.sigData=[r.sign(t,n).serializeHex()],a}},{key:"createAsync",value:function(){var t=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function t(r,n,a){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new e).M=1,i.pubKeys=[n.getPublicKey()],t.next=5,n.signAsync(r,a);case 5:return t.t0=t.sent.serializeHex(),i.sigData=[t.t0],t.abrupt("return",i);case 8:case"end":return t.stop()}},t,this)}));return function(e,r,n){return t.apply(this,arguments)}}()}]),e}(),Ir=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){e[e.BookKeeper=2]="BookKeeper",e[e.Claim=3]="Claim",e[e.Deploy=208]="Deploy",e[e.Invoke=209]="Invoke",e[e.Enrollment=4]="Enrollment",e[e.Vote=5]="Vote"}(Or||(Or={}));!function(){function e(){Cr(this,e)}Ir(e,[{key:"serialize",value:function(){var e="";return e+=this.amount.serialize(),e+=this.payer.serialize()}}],[{key:"deserialize",value:function(t){var r=new e,n=gr.deserialize(t),a=t.read(20);return r.amount=n,r.payer=new Ct(a),r}}])}();var Br=function(){function e(){Cr(this,e),this.type=209,this.version=0,this.txAttributes=[],this.sigs=[],this.nonce=ae(Pe(4)),this.gasPrice=new gr,this.gasLimit=new gr,this.payer=new Ct("0000000000000000000000000000000000000000")}return Ir(e,[{key:"serialize",value:function(){return this.serializeUnsignedData()+this.serializeSignedData()}},{key:"serializeUnsignedData",value:function(){var e="";e+=ve(this.version),e+=ve(this.type),e+=this.nonce,e+=this.gasPrice.serialize(),e+=this.gasLimit.serialize(),e+=this.payer.serialize(),e+=this.payload.serialize(),e+=ve(this.txAttributes.length);for(var t=0;t<this.txAttributes.length;t++)e+=this.txAttributes[t].serialize();return e}},{key:"serializeSignedData",value:function(){var e="";e+=ve(this.sigs.length);for(var t=0;t<this.sigs.length;t++)e+=this.sigs[t].serialize();return e}},{key:"getSignContent",value:function(){var e=this.serializeUnsignedData(),t=W.enc.Hex.parse(e),r=W.SHA256(t).toString();return W.SHA256(W.enc.Hex.parse(r)).toString()}},{key:"getHash",value:function(){return this.getSignContent()}}],[{key:"deserialize",value:function(t){var r=new e,n=new me(t);r.version=parseInt(n.read(1),16),r.type=parseInt(n.read(1),16),r.nonce=n.read(4),r.gasPrice=gr.deserialize(n),r.gasLimit=gr.deserialize(n),r.payer=new Ct(n.read(20));var a=void 0;switch(r.type){case Or.Invoke:a=new xr;break;case Or.Deploy:a=new Ar;break;default:a=new xr}a.deserialize(n),r.payload=a,r.txAttributes=[],r.sigs=[];for(var i=n.readNextLen(),o=0;o<i;o++){var u=new Er;u.deserialize(n),r.txAttributes.push(u)}for(var s=n.readNextLen(),c=0;c<s;c++)r.sigs.push(Nr.deserialize(n));return r}}]),e}();var Dr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Br),t}();var _r={Action:"sendrawtransaction",Version:"1.0.0",Type:"",Op:"test"},Hr=function(e,t,r){var n=Nr.create(e,t,r);e.sigs=[n]},zr=function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nr.createAsync(t,r,n);case 2:a=e.sent,t.sigs=[a];case 4:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),Ur=function(e,t,r){var n=Nr.create(e,t,r);e.sigs.push(n)},Lr=function(e,t){if(e===t)return!0;if(e.sort(Ze),t.sort(Ze),e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r].key!==t[r].key)return!1;return!0},Mr=function(e,t,r,n,a){if(0===e.sigs.length)e.sigs=[];else{if(e.sigs.length>L||t>r.length||t<=0||0===r.length)throw g.INVALID_PARAMS;for(var i=0;i<e.sigs.length;i++)if(Lr(e.sigs[i].pubKeys,r)){if(e.sigs[i].sigData.length+1>r.length)throw new Error("Too many sigData");var o=n.sign(e,a).serializeHex();return void e.sigs[i].sigData.push(o)}}var u=new Nr;u.M=t,u.pubKeys=r,u.sigData=[n.sign(e,a).serializeHex()],e.sigs.push(u)};function Kr(e,t,r,n,a,i){var o="";o+=t,o+=wt(ue(e)),o+=wt(r.serialize()),o+=gt(0),o+=ve(F.SYSCALL),o+=wt(ue(U));var u=new xr;u.code=o;var s=void 0;return(s="transfer"===e||"transferFrom"===e?new Dr:new Br).type=Or.Invoke,s.payload=u,a&&(s.gasLimit=new gr(a)),n&&(s.gasPrice=new gr(n)),i&&(s.payer=i),s}var Vr=function(e,t,r,n,a,i){var o=new Br;o.type=Or.Invoke;var u="";if("string"==typeof t)u=t;else{var s=new wr(e,"",t);u=Rt(s)}var c=u+ve(F.APPCALL);c+=r.serialize();var l=new xr;return l.code=c,o.payload=l,a&&(o.gasLimit=new gr(a)),n&&(o.gasPrice=new gr(n)),i&&(o.payer=i),o};function Jr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1.0",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments[7],s=arguments[8],c=arguments[9],l=new Ar;l.author=n,l.code=e,l.version=r,l.description=i,l.email=a,l.name=t,l.needStorage=o;var f=new Br;return f.version=0,f.payload=l,f.type=Or.Deploy,f.gasLimit=new gr(s),f.gasPrice=new gr(u),c&&(f.payer=c),f}function Gr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{PreExec:"1"}:{},r=e.serialize();return JSON.stringify(Object.assign({},_r,{Data:r},t))}function jr(e,t){var r=e.serialize();return{jsonrpc:"2.0",method:t||"sendrawtransaction",params:[r],id:10}}function Wr(e){return{Action:"sendrawtransaction",Version:"1.0.0",Data:e.serialize()}}function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1));var r=e+C.sendRawTx;return t&&(r+="?preExec=1"),r}var qr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Qr=r(11),Xr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this["enc-alg"]="aes-256-gcm",this.hash="sha256"}return Yr(e,[{key:"toJson",value:function(){return JSON.stringify(this.toJsonObj())}},{key:"toJsonObj",value:function(){return qr({address:this.address.toBase58(),label:this.label,lock:this.lock},this.encryptedKey.serializeJson(),{"enc-alg":this["enc-alg"],hash:this.hash,salt:this.salt,isDefault:this.isDefault,publicKey:this.publicKey,signatureScheme:this.encryptedKey.algorithm.defaultSchema.label})}},{key:"exportPrivateKey",value:function(e,t){return this.encryptedKey.decrypt(e,this.address,this.salt,t)}},{key:"signTransaction",value:function(e,t,r){var n=this.exportPrivateKey(e,r);return Hr(t,n,n.algorithm.defaultSchema),t}}],[{key:"importAccount",value:function(t,r,n,a,i,o){var u=new e,s=Buffer.from(i,"base64").toString("hex"),c=r.decrypt(n,a,s,o);t||(t=ae(Pe(4))),u.label=t,u.lock=!1,u.isDefault=!1,u.salt=i,u.encryptedKey=r;var l=c.getPublicKey();return u.publicKey=l.key,u.address=Ct.fromPubKey(l),u}},{key:"importWithMnemonic",value:function(t,r,n,a){if(r=r.trim(),!w.validateMnemonic(r))throw g.INVALID_PARAMS;var i=w.mnemonicToSeedHex(r),o=Qr.fromMasterSeed(Buffer.from(i,"hex")).derive(M),u=Buffer.from(o.privateKey).toString("hex"),s=new Zt(u);return e.create(s,n,t,a)}},{key:"create",value:function(t,r,n,a){var i=new e;n||(n=ae(Pe(4))),i.label=n,i.lock=!1,i.isDefault=!1;var o=Ee(16),u=t.getPublicKey(),s=Ct.fromPubKey(u);return i.publicKey=u.serializeHex(),i.address=s,i.encryptedKey=t.encrypt(r,s,o,a),i.salt=Buffer.from(o,"hex").toString("base64"),i}},{key:"parseJson",value:function(t){return e.parseJsonObj(JSON.parse(t))}},{key:"parseJsonObj",value:function(t){var r=new e;return r.address=new Ct(t.address),r.label=t.label,r.lock=t.lock,r.isDefault=t.isDefault,r.publicKey=t.publicKey,r.hash=t.hash,r.salt=t.salt,r.encryptedKey=nr({algorithm:t.algorithm,parameters:t.parameters,key:t.key,external:t.external}),r.extra=t.extra,r}}]),e}(),Zr="/api/v1/transaction",$r="/api/v1/transaction/",en="/api/v1/node/connectioncount",tn="/api/v1/block/height",rn="/api/v1/block/details/height/",nn="/api/v1/block/details/hash/",an="/api/v1/balance/",on="/api/v1/contract/",un="/api/v1/smartcode/event/transactions/",sn="/api/v1/smartcode/event/txhash/",cn="/api/v1/block/height/txhash/",ln="/api/v1/storage/",fn="/api/v1/merkleproof/",hn="/api/v1/allowance/",vn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var dn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.version="v1.0.0",this.action="sendrawtransaction",this.url=t||D.REST_URL,"/"===this.url[this.url.length-1]&&(this.url=this.url.substring(0,this.url.length-1))}return vn(e,[{key:"concatParams",value:function(e){var t="";if(0===e.size)return"";var r=!0,n=!1,a=void 0;try{for(var i,o=e.keys()[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value,s=e.get(u);s&&(s=encodeURIComponent(s)),t+="&"+u+"="+s}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return"?"+t.substr(1)}},{key:"getUrl",value:function(){return this.url}},{key:"sendRawTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2],n=new Map;r&&n.set("userid",r),t&&n.set("preExec","1");var a=this.url+Zr;a+=this.concatParams(n);var i={Action:this.action,Version:this.version,Data:e};return $.a.post(a,i).then(function(e){return e.data})}},{key:"getRawTransaction",value:function(e){var t=new Map;t.set("raw","1");var r=this.url+$r+e;return r+=this.concatParams(t),$.a.get(r).then(function(e){return e.data})}},{key:"getRawTransactionJson",value:function(e){var t=new Map;t.set("raw","0");var r=this.url+$r+e;return r+=this.concatParams(t),$.a.get(r).then(function(e){return e.data})}},{key:"getNodeCount",value:function(){var e=this.url+en;return $.a.get(e).then(function(e){return e.data})}},{key:"getBlockHeight",value:function(){var e=this.url+tn;return $.a.get(e).then(function(e){return e.data})}},{key:"getBlock",value:function(e){var t=new Map;t.set("raw","1");var r="";return"number"==typeof e?r=this.url+rn+e:"string"==typeof e&&(r=this.url+nn+e),r+=this.concatParams(t),$.a.get(r).then(function(e){return e.data})}},{key:"getContract",value:function(e){var t=new Map;t.set("raw","1");var r=this.url+on+e;return r+=this.concatParams(t),$.a.get(r).then(function(e){return e.data})}},{key:"getContractJson",value:function(e){var t=new Map;t.set("raw","0");var r=this.url+on+e;return r+=this.concatParams(t),$.a.get(r).then(function(e){return e.data})}},{key:"getSmartCodeEvent",value:function(e){var t="";return"string"==typeof e?t=this.url+sn+e:"number"==typeof e&&(t=this.url+un+e),$.a.get(t).then(function(e){return e.data})}},{key:"getBlockHeightByTxHash",value:function(e){var t=this.url+cn+e;return $.a.get(t).then(function(e){return e.data})}},{key:"getStorage",value:function(e,t){var r=this.url+ln+e+"/"+t;return $.a.get(r).then(function(e){return e.data})}},{key:"getMerkleProof",value:function(e){var t=this.url+fn+e;return console.log("url: "+t),$.a.get(t).then(function(e){return e.data})}},{key:"getBalance",value:function(e){var t=this.url+an+e.toBase58();return $.a.get(t).then(function(e){return e.data})}},{key:"getBlockJson",value:function(e){var t="";return"number"==typeof e?t=this.url+rn+e:"string"==typeof e&&(t=this.url+nn+e),$.a.get(t).then(function(e){return e.data})}},{key:"getAllowance",value:function(e,t,r){if("ont"!==(e=e.toLowerCase())&&"ong"!==e)throw g.INVALID_PARAMS;var n=this.url+hn+e.toLowerCase()+"/"+t.toBase58()+"/"+r.toBase58();return $.a.get(n).then(function(e){return e.data})}}]),e}(),yn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var pn=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolve=function(e){t._resolve(e)},this.reject=function(e){t._reject(e)},this._promise=new Promise(function(e,r){t._resolve=e,t._reject=r})}return yn(e,[{key:"promise",get:function(){return this._promise}}]),e}();function gn(){return{Action:"subscribe",Version:"1.0.0",SubscribeEvent:arguments.length>0&&void 0!==arguments[0]&&arguments[0],SubscribeJsonBlock:arguments.length>1&&void 0!==arguments[1]&&arguments[1],SubscribeRawBlock:arguments.length>2&&void 0!==arguments[2]&&arguments[2],SubscribeBlockTxHashs:arguments.length>3&&void 0!==arguments[3]&&arguments[3]}}function mn(e){var t={Action:"sendrawtransaction",Version:"1.0.0",Data:e};return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t=Object.assign(t,{PreExec:"1"})),t}function wn(e){return{Action:"gettransaction",Version:"1.0.0",Hash:e,Raw:"1"}}function Sn(e){return{Action:"gettransaction",Version:"1.0.0",Hash:e,Raw:"0"}}function bn(e){var t={};return"number"==typeof e?t={Action:"getblockbyheight",Version:"1.0.0",Height:e,Raw:"1"}:"string"==typeof e&&(t={Action:"getblockbyhash",Version:"1.0.0",Hash:e,Raw:"1"}),t}function An(e){var t={};return"number"==typeof e?t={Action:"getblockbyheight",Version:"1.0.0",Height:e}:"string"==typeof e&&(t={Action:"getblockbyhash",Version:"1.0.0",Hash:e}),t}function kn(e){return{Action:"getbalance",Version:"1.0.0",Addr:e.toBase58()}}function Rn(e){return{Action:"getunboundong",Version:"1.0.0",Addr:e.toBase58()}}function xn(e){return{Action:"getcontract",Version:"1.0.0",Hash:e,Raw:"1"}}function Pn(e){return{Action:"getcontract",Version:"1.0.0",Hash:e,Raw:"0"}}function En(e){var t={};return"number"==typeof e?t={Action:"getsmartcodeeventbyheight",Version:"1.0.0",Height:e}:"string"==typeof e&&(t={Action:"getsmartcodeeventbyhash",Version:"1.0.0",Hash:e}),t}function Tn(e){return{Action:"getblockheightbytxhash",Version:"1.0.0",Hash:e}}function On(e,t){return{Action:"getstorage",Version:"1.0.0",Hash:e,Key:t}}function Nn(e){return{Action:"getmerkleproof",Version:"1.0.0",Hash:e}}function In(e,t,r){return{Action:"getallowance",Version:"1.0.0",Asset:e,From:t.toBase58(),To:r.toBase58()}}function Cn(e){return{Action:"getblockhash",Version:"1.0.0",Height:e}}function Bn(e){return{Action:"getblocktxsbyheight",Version:"1.0.0",Height:e}}function Dn(e){return{Action:"getgrantong",Version:"1.0.0",Addr:e.toBase58()}}function _n(e){return{Action:"getmempooltxstate",Version:"1.0.0",Hash:e}}var Hn=r(16),zn=r(17),Un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ln=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Mn=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D.SOCKET_URL,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.debug=n,this.wsp=new zn(r,{createWebSocket:function(e){return new Hn(e)},attachRequestId:function(e,t){return Un({Id:t},e)},extractRequestId:function(e){return e&&e.Id},packMessage:function(e){return JSON.stringify(e)},unpackMessage:function(e){return JSON.parse(e)}}),this.wsp.onOpen.addListener(function(){t.debug&&console.log("connected")}),this.wsp.onClose.addListener(function(){t.debug&&console.log("disconnected")}),this.wsp.onSend.addListener(function(e){t.debug&&console.log("sent: ",e)}),this.wsp.onMessage.addListener(function(e){t.debug&&console.log("received: ",e)}),this.wsp.onError.addListener(function(e){t.debug&&console.log("error: ",e)})}return Ln(e,null,[{key:"generateReqId",value:function(){return Math.floor(1e9*Math.random())}}]),Ln(e,[{key:"send",value:function(){var t=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}(regeneratorRuntime.mark(function t(r){var n,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.wsp.open();case 5:return t.next=7,this.wsp.sendRequest(r,{requestId:e.generateReqId()});case 7:return n=t.sent,t.abrupt("return",n);case 9:if(t.prev=9,!a){t.next=13;break}return t.next=13,this.wsp.close();case 13:return t.finish(9);case 14:case"end":return t.stop()}},t,this,[[0,,9,14]])}));return function(e){return t.apply(this,arguments)}}()},{key:"addListener",value:function(e){this.wsp.onUnpackedMessage.addListener(e)}},{key:"close",value:function(){this.wsp.close()}}]),e}(),Kn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Vn(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var Jn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D.SOCKET_URL,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.autoClose=n,this.promises=new Map,this.sender=new Mn(t,r),this.sender.addListener(this.notifyListener.bind(this))}return Kn(e,[{key:"sendHeartBeat",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"heartbeat",Version:"V1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendSubscribe",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=gn(r,n,a,i),e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendRawTransaction",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r,n,a,i,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=mn(t,o),e.next=3,this.send(r,this.autoClose&&!u);case 3:if(0===(n=e.sent).Error){e.next=7;break}throw console.log(n),new Error(JSON.stringify(n));case 7:if(!u){e.next=14;break}return a=n.Result,i=new pn,this.promises.set(a,i),e.abrupt("return",i.promise);case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getRawTransaction",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=wn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getRawTransactionJson",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getNodeCount",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"getconnectioncount",Version:"1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBlockHeight",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"getblockheight",Version:"1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getBlock",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=bn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getBlockJson",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=An(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getBalance",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=kn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getUnboundong",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Rn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getContract",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=xn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getContractJson",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSmartCodeEvent",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=En(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getBlockHeightByTxHash",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getStorage",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=On(t,r),e.abrupt("return",this.send(n));case 2:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getMerkleProof",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Nn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAllowance",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=In(t,r,n),e.abrupt("return",this.send(a));case 2:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getBlockHash",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Cn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getBlockTxsByHeight",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGasPrice",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"getgasprice",Version:"1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getGrantOng",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Dn(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getMempoolTxCount",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"getmempooltxcount",Version:"1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getMempoolTxState",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_n(t),e.abrupt("return",this.send(r));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getVersion",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"getversion",Version:"1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNetworkId",value:function(){var e=Vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={Action:"getnetworkid",Version:"1.0.0"},e.abrupt("return",this.send(t));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addNotifyListener",value:function(e){this.sender.addListener(function(t){"Notify"===t.Action&&e(t)})}},{key:"close",value:function(){this.sender.close()}},{key:"send",value:function(){var e=Vn(regeneratorRuntime.mark(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.autoClose;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sender.send(t,r));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"notifyListener",value:function(e){if("Notify"===e.Action){var t=e.Result.TxHash;if(void 0!==t){var r=this.promises.get(t);void 0!==r?(this.promises.delete(t),r.resolve(e)):console.warn("Received Notify event for unknown transaction"),this.autoClose&&this.sender.close()}}}}]),e}(),Gn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var jn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions=[]}return Gn(e,[{key:"getHash",value:function(){return this.hash}},{key:"getEntryPoint",value:function(){return this.entrypoint}},{key:"getFunction",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,i=this.functions[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;if(o.name===e){var u=o.parameters.map(function(e){return new vt(e.name,e.type,"")});return new wr(o.name,o.returntype,u)}}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}throw Error("not found")}}],[{key:"parseJson",value:function(t){var r=new e,n=JSON.parse(t);return r.hash=n.hash,r.entrypoint=n.entrypoint,r.functions=n.functions,r}}]),e}(),Wn=jn.parseJson(JSON.stringify({hash:"36bb5c053b6b839c8f6b923fe852f91239b9fccc",entrypoint:"Main",functions:[{name:"Main",parameters:[{name:"operation",type:"String"},{name:"args",type:"Array"}],returntype:"Any"},{name:"Commit",parameters:[{name:"claimId",type:"ByteArray"},{name:"commiterId",type:"ByteArray"},{name:"ownerId",type:"ByteArray"}],returntype:"Boolean"},{name:"Revoke",parameters:[{name:"claimId",type:"ByteArray"},{name:"ontId",type:"ByteArray"}],returntype:"Boolean"},{name:"GetStatus",parameters:[{name:"claimId",type:"ByteArray"}],returntype:"ByteArray"}],events:[{name:"ErrorMsg",parameters:[{name:"arg1",type:"ByteArray"},{name:"arg2",type:"String"}],returntype:"Void"},{name:"Push",parameters:[{name:"arg1",type:"ByteArray"},{name:"arg2",type:"String"},{name:"arg3",type:"ByteArray"}],returntype:"Void"}]})),Fn=Wn.getHash().replace("0x",""),qn=new Ct(ye(Fn));function Yn(e,t,r,n,a,i){var o=Wn.getFunction("Commit");"did"===t.substr(0,3)&&(t=ue(t)),"did"===r.substr(0,3)&&(r=ue(t));var u=new vt(o.parameters[0].getName(),lt.ByteArray,ue(e)),s=new vt(o.parameters[1].getName(),lt.ByteArray,t),c=new vt(o.parameters[2].getName(),lt.ByteArray,r);new Br;return Vr(o.name,[u,s,c],qn,n,a,i)}function Qn(e,t,r,n,a){var i=Wn.getFunction("Revoke"),o=i.parameters[0].getName(),u=lt.ByteArray;"did"===t.substr(0,3)&&(t=ue(t));var s=new vt(o,u,ue(e)),c=new vt(i.parameters[1].getName(),lt.ByteArray,t);return Vr(i.name,[s,c],qn,r,n,a)}function Xn(e){var t=Wn.getFunction("GetStatus"),r=new vt(t.parameters[0].getName(),lt.ByteArray,ue(e));return Vr(t.name,[r],qn)}var Zn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function $n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ea=function(){function e(){$n(this,e),this.Action="Notify"}return Zn(e,null,[{key:"deserialize",value:function(t){var r=new e;return r.Action=t.Action,r.Error=t.Error,r.Desc=t.Desc,r.Result=ta.deserialize(t.Result),r}}]),e}(),ta=function(){function e(){$n(this,e)}return Zn(e,null,[{key:"deserialize",value:function(t){var r=new e;return r.TxHash=t.TxHash,r.State=t.State,r.GasConsumed=t.GasConsumed,r.Notify=t.Notify.map(function(e){return{ContractAddress:e.ContractAddress,States:e.States.map(function(e){return"string"==typeof e?se(e):e})}}),r.Version=t.Version,r}}]),e}(),ra=r(18);function na(e){var t="";if("string"==typeof e)t+=wt(e);else if("boolean"==typeof e)t+=pt(e);else if("number"==typeof e)t+=gt(e);else if(e instanceof Q.BigNumber)t+=mt(e);else if(e instanceof Ct)t+=wt(e.serialize());else if(e instanceof yt){var r=!0,n=!1,a=void 0;try{for(var i,o=e.list[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){t+=na(i.value),t+=ve(F.DUPFROMALTSTACK),t+=ve(F.SWAP),t+=ve(F.APPEND)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}return t}function aa(e){for(var t="",r=e.length-1;r>=0;r--){var n=e[r];if("string"==typeof n)t+=wt(n);else if("boolean"==typeof n)t+=pt(n);else if("number"==typeof n)t+=gt(n);else if(n instanceof Q.BigNumber)t+=mt(n);else if(n instanceof Ct)t+=wt(n.serialize());else if(n instanceof yt){t+=gt(0),t+=ve(F.NEWSTRUCT),t+=ve(F.TOALTSTACK);var a=!0,i=!1,o=void 0;try{for(var u,s=n.list[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){t+=na(u.value),t+=ve(F.DUPFROMALTSTACK),t+=ve(F.SWAP),t+=ve(F.APPEND)}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}t+=ve(F.FROMALTSTACK)}else if(Array.isArray(n)&&ia(n,yt)){t+=gt(0),t+=ve(F.NEWSTRUCT),t+=ve(F.TOALTSTACK);var c=!0,l=!1,f=void 0;try{for(var h,v=n[Symbol.iterator]();!(c=(h=v.next()).done);c=!0){t+=na(h.value)}}catch(e){l=!0,f=e}finally{try{!c&&v.return&&v.return()}finally{if(l)throw f}}t+=ve(F.FROMALTSTACK),t+=gt(n.length),t+=ve(F.PACK)}else Array.isArray(n)&&(t+=aa(n),t+=gt(n.length),t+=ve(F.PACK))}return t}function ia(e,t){var r=!0,n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){if(!(o.value instanceof t)){r=!1;break}}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}var oa="0000000000000000000000000000000000000003",ua={regIDWithPublicKey:"regIDWithPublicKey",regIDWithAttributes:"regIDWithAttributes",addAttributes:"addAttributes",removeAttribute:"removeAttribute",getAttributes:"getAttributes",getDDO:"getDDO",addKey:"addKey",removeKey:"removeKey",getPublicKeys:"getPublicKeys",addRecovery:"addRecovery",changeRecovery:"changeRecovery",getKeyState:"getKeyState"};function sa(e,t,r,n,a){var i=ua.regIDWithPublicKey;"did"===e.substr(0,3)&&(e=ue(e));var o=new yt;return o.add(e,t.serializeHex()),Kr(i,aa([o]),new Ct(oa),r,n,a)}function ca(e,t,r,n,a,i){var o=ua.regIDWithAttributes;"did"===e.substr(0,3)&&(e=ue(e));var u=t.length,s=new yt;s.add(e,r.serializeHex(),u);var c=!0,l=!1,f=void 0;try{for(var h,v=t[Symbol.iterator]();!(c=(h=v.next()).done);c=!0){var d=h.value,y=ue(d.key),p=ue(d.type),g=ue(d.value);s.add(y,p,g)}}catch(e){l=!0,f=e}finally{try{!c&&v.return&&v.return()}finally{if(l)throw f}}return Kr(o,aa([s]),new Ct(oa),n,a,i)}function la(e,t,r,n,a,i){var o=ua.addAttributes;"did"===e.substr(0,3)&&(e=ue(e));var u=new yt;u.add(e,t.length);var s=!0,c=!1,l=void 0;try{for(var f,h=t[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var v=f.value,d=ue(v.key),y=ue(v.type),p=ue(v.value);u.add(d,y,p)}}catch(e){c=!0,l=e}finally{try{!s&&h.return&&h.return()}finally{if(c)throw l}}return u.list.push(r.serializeHex()),Kr(o,aa([u]),new Ct(oa),n,a,i)}function fa(e,t,r,n,a,i){var o=ua.removeAttribute;"did"===e.substr(0,3)&&(e=ue(e));var u=new yt;return u.add(e,ue(t),r.serializeHex()),Kr(o,aa([u]),new Ct(oa),n,a,i)}function ha(e){var t=ua.getAttributes;"did"===e.substr(0,3)&&(e=ue(e));var r=new yt;return r.add(e),Kr(t,aa([r]),new Ct(oa))}function va(e){var t=ua.getDDO;"did"===e.substr(0,3)&&(e=ue(e));var r=new yt;return r.add(e),Kr(t,aa([r]),new Ct(oa))}function da(e,t,r,n,a,i){var o=ua.addKey;"did"===e.substr(0,3)&&(e=ue(e));var u=e,s=t.serializeHex(),c=void 0;r instanceof Qe?c=r.serializeHex():r instanceof Ct&&(c=r.serialize());var l=new yt;return l.add(u,s,c),Kr(o,aa([l]),new Ct(oa),n,a,i)}function ya(e,t,r,n,a,i){var o=ua.removeKey;"did"===e.substr(0,3)&&(e=ue(e));var u=e,s=t.serializeHex(),c=void 0;r instanceof Qe?c=r.serializeHex():r instanceof Ct&&(c=r.serialize());var l=new yt;return l.add(u,s,c),Kr(o,aa([l]),new Ct(oa),n,a,i)}function pa(e){var t=ua.getPublicKeys;"did"===e.substr(0,3)&&(e=ue(e));var r=new yt;return r.add(e),Kr(t,aa([r]),new Ct(oa))}function ga(e,t,r,n,a,i){var o=ua.addRecovery;"did"===e.substr(0,3)&&(e=ue(e));var u=e,s=t,c=r.serializeHex(),l=new yt;return l.add(u,s,c),Kr(o,aa([l]),new Ct(oa),n,a,i)}function ma(e,t,r,n,a,i){var o=ua.changeRecovery;"did"===e.substr(0,3)&&(e=ue(e));var u=e,s=t,c=r,l=new yt;l.add(u,s,c);var f=Kr(o,aa([l]),new Ct(oa),n,a);return f.payer=i||r,f}function wa(e,t){var r=ua.getKeyState;"did"===e.substr(0,3)&&(e=ue(e)),console.log("did: "+e);var n=ve(t,4,!0);console.log("index: "+n);var a=new yt;return a.add(e,t),Kr(r,aa([a]),new Ct(oa))}var Sa=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function ba(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Aa=function(){function e(){ba(this,e)}return Sa(e,null,[{key:"deserialize",value:function(t){for(var r=new me(t),n=[];!r.isEmpty();){var a=r.readUint32(),i=r.readNextBytes(),o=new e;o.id=a,o.pk=Qe.deserializeHex(new me(i)),n.push(o)}return n}}]),e}(),ka=function(){function e(){ba(this,e)}return Sa(e,[{key:"serialize",value:function(){var e="";return e+=le(this.key),e+=le(this.type),e+=le(this.value)}}],[{key:"deserialize",value:function(t){for(var r=new me(t),n=[];!r.isEmpty();){var a=se(r.readNextBytes()),i=se(r.readNextBytes()),o=se(r.readNextBytes()),u=new e;u.key=a,u.type=i,u.value=o,n.push(u)}return n}}]),e}(),Ra=function(){function e(){ba(this,e),this.publicKeys=[],this.attributes=[],this.recovery=""}return Sa(e,null,[{key:"deserialize",value:function(t){var r=new me(t),n=new e,a=r.readNextLen();a>0&&(n.publicKeys=Aa.deserialize(r.read(a)));var i=r.readNextLen();i>0&&(n.attributes=ka.deserialize(r.read(i)));var o=r.readNextLen();return o>0&&(n.recovery=r.read(o)),n}}]),e}(),xa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pa=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Ea(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var Ta=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata=t,this.signature=r,void 0===this.metadata.messageId&&(this.metadata.messageId=ra())}return Pa(e,null,[{key:"deserializeInternal",value:function(t,r){var n=t.split(".",3);if(n.length<2)throw new Error("Invalid message.");var a=e.deserializeHeader(n[0]),i=e.deserializePayload(n[1]),o=void 0;if(n.length>2){if(void 0===a.algorithm||void 0===a.publicKeyId)throw new Error("Signature scheme was not specified.");o=Yt.deserializeJWT(n[2],a.algorithm,a.publicKeyId)}var u=r(i.metadata,o);return u.payloadFromJSON(i.rest),u}},{key:"deserializePayload",value:function(e){var t=Ft.decode(e),r=JSON.parse(t);return{metadata:{messageId:r.jti,issuer:r.iss,subject:r.sub,issuedAt:r.iat,expireAt:r.exp},rest:function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(r,["jti","iss","sub","iat","exp"])}}},{key:"deserializeHeader",value:function(e){var t=Ft.decode(e),r=JSON.parse(t);return{algorithm:void 0!==r.alg?Ue.fromLabelJWS(r.alg):void 0,publicKeyId:r.kid}}}]),Pa(e,[{key:"sign",value:function(){var e=Ea(regeneratorRuntime.mark(function e(t,r,n,a){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oa(r,t);case 2:return void 0===a&&(a=n.algorithm.defaultSchema),i=this.serializeUnsigned(a,r),e.next=6,n.signAsync(i,a,r);case 6:this.signature=e.sent;case 7:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=Ea(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=this.signature)||void 0===r.publicKeyId){e.next=24;break}if(e.prev=2,this.verifyKeyOwnership()){e.next=5;break}return e.abrupt("return",!1);case 5:if(this.verifyExpiration()){e.next=7;break}return e.abrupt("return",!1);case 7:return e.next=9,Na(r.publicKeyId,t);case 9:if(e.sent!==Xe.REVOKED){e.next=12;break}return e.abrupt("return",!1);case 12:return e.next=14,Oa(r.publicKeyId,t);case 14:return n=e.sent,a=this.serializeUnsigned(r.algorithm,r.publicKeyId),e.abrupt("return",n.verify(a,r));case 19:return e.prev=19,e.t0=e.catch(2),e.abrupt("return",!1);case 22:e.next=25;break;case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}},e,this,[[2,19]])}));return function(t){return e.apply(this,arguments)}}()},{key:"serializeUnsigned",value:function(e,t){return this.serializeHeader(e,t)+"."+this.serializePayload()}},{key:"serialize",value:function(){var e=this.signature;if(void 0!==e){var t=e.serializeJWT();return this.serializeUnsigned(e.algorithm,e.publicKeyId)+"."+t}return this.serializeUnsigned()}},{key:"serializeHeader",value:function(e,t){var r=void 0;r=void 0!==e?{alg:e.labelJWS,typ:"JWT",kid:t}:{typ:"JWT"};var n=JSON.stringify(r);return Ft.encode(n,"utf-8")}},{key:"verifyExpiration",value:function(){return void 0===this.metadata.expireAt||Ae()<this.metadata.expireAt}},{key:"verifyKeyOwnership",value:function(){var e=this.signature;return void 0!==e&&void 0!==e.publicKeyId&&Ia(e.publicKeyId)===this.metadata.issuer}},{key:"serializePayload",value:function(){var e={jti:this.metadata.messageId,iss:this.metadata.issuer,sub:this.metadata.subject,iat:this.metadata.issuedAt,exp:this.metadata.expireAt},t=this.payloadToJSON(),r=JSON.stringify(xa({},e,t));return Ft.encode(r,"utf-8")}}]),e}(),Oa=function(){var e=Ea(regeneratorRuntime.mark(function e(t,r){var n,a,i,o,u,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ia(t),a=Ca(t),i=new dn(r),o=va(n),e.next=6,i.sendRawTransaction(o.serialize(),!0);case 6:if(!(u=e.sent).Result||!u.Result.Result){e.next=15;break}if(s=Ra.deserialize(u.Result.Result),void 0!==(c=s.publicKeys.find(function(e){return e.id===a}))){e.next=12;break}throw new Error("Not found");case 12:return e.abrupt("return",c.pk);case 15:throw new Error("Not found");case 16:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),Na=function(){var e=Ea(regeneratorRuntime.mark(function e(t,r){var n,a,i,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ia(t),a=Ca(t),i=new dn(r),o=wa(n,a),e.next=6,i.sendRawTransaction(o.serialize(),!0);case 6:if(!(u=e.sent).Result||!u.Result.Result){e.next=11;break}return e.abrupt("return",Xe.fromHexLabel(u.Result.Result));case 11:throw new Error("Not found");case 12:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}();function Ia(e){var t=e.indexOf("#keys-");if(-1===t)throw new Error("Is not a publicKeId.");return e.substr(0,t)}function Ca(e){var t=e.indexOf("#keys-");if(-1===t)throw new Error("Is not a publicKeId.");return Number(e.substr(t+"#keys-".length))}var Ba,Da=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_a=function e(t,r,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,r);if(void 0===a){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in a)return a.value;var o=a.get;return void 0!==o?o.call(n):void 0};function Ha(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}function za(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){e.AttestContract="AttestContract",e.RevocationList="RevocationList"}(Ba||(Ba={}));var Ua,La=function(e){function t(e,r,n){za(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return a.useProof=!0===n,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ta),Da(t,null,[{key:"deserialize",value:function(e){return _a(t.__proto__||Object.getPrototypeOf(t),"deserializeInternal",this).call(this,e,function(e,r){return new t(e,r)})}}]),Da(t,[{key:"verify",value:function(){var e=Ha(regeneratorRuntime.mark(function e(r){var n,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"verify",this).call(this,r);case 2:if(!(n=e.sent)||!a){e.next=7;break}return e.abrupt("return",this.getStatus(r));case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){return this.useProof?_a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this)+"."+this.serializeProof():_a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this)}},{key:"attest",value:function(){var e=Ha(regeneratorRuntime.mark(function e(t,r,n,a,i){var o,u,s,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.metadata.issuer,u=this.metadata.subject,void 0!==(s=this.metadata.messageId)){e.next=5;break}throw new Error("Claim id not specified.");case 5:return c=new Jn(t),l=Yn(s,o,u,r,n,a),e.next=9,zr(l,i);case 9:return e.next=11,c.sendRawTransaction(l.serialize(),!1,!0);case 11:return f=e.sent,h=ea.deserialize(f),console.log(JSON.stringify(h)),e.abrupt("return","Push"===h.Result.Notify[0].States[0]);case 15:case"end":return e.stop()}},e,this)}));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"revoke",value:function(){var e=Ha(regeneratorRuntime.mark(function e(t,r,n,a,i){var o,u,s,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.metadata.issuer,void 0!==(u=this.metadata.messageId)){e.next=4;break}throw new Error("Claim id not specified.");case 4:return s=new Jn(t),c=Qn(u,o,r,n,a),e.next=8,zr(c,i);case 8:return e.next=10,s.sendRawTransaction(c.serialize(),!1,!0);case 10:return l=e.sent,f=ea.deserialize(l),e.abrupt("return","Push"===f.Result.Notify[0].States[0]);case 13:case"end":return e.stop()}},e,this)}));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"getStatus",value:function(){var e=Ha(regeneratorRuntime.mark(function e(t){var r,n,a,i,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.metadata.issuer,void 0!==(n=this.metadata.messageId)){e.next=4;break}throw new Error("Claim id not specified.");case 4:return a=new dn(t),i=Xn(n),e.next=8,a.sendRawTransaction(i.serialize(),!0);case 8:return o=e.sent,u=Ma.deserialize(o),console.log(u),e.abrupt("return",u.status===Ua.ATTESTED&&u.issuerId===r);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"payloadToJSON",value:function(){return{ver:this.version,"@context":this.context,clm:this.content,"clm-rev":this.revocation}}},{key:"payloadFromJSON",value:function(e){this.version=e.ver,this.context=e["@context"],this.content=e.clm,this.revocation=e["clm-rev"]}},{key:"serializeHeader",value:function(e,r){if(this.useProof){if(void 0===e||void 0===r)throw new Error("Signature is needed fow JWT-X.");var n={alg:e.labelJWS,typ:"JWT-X",kid:r},a=JSON.stringify(n);return Ft.encode(a,"utf-8")}return _a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeHeader",this).call(this,e,r)}},{key:"serializeProof",value:function(){var e=JSON.stringify(this.proof);return Ft.encode(e,"utf-8")}}]),t}(),Ma=function(){function e(){za(this,e)}return Da(e,null,[{key:"deserialize",value:function(t){var r=new e;if(void 0!==t.Result&&""===t.Result.Result)return r.status=Ua.NOTFOUND,r;var n=new me(t.Result.Result);n.read(1),n.readNextLen(),n.read(1);var a=se(n.readNextBytes());n.read(1);var i=se(n.readNextBytes());n.read(1);var o=se(n.readNextBytes());n.read(1);var u=n.readNextBytes();return r.claimId=a,r.issuerId=i,r.subjectId=o,u||(u="00"),r.status=u,r}}]),e}();!function(e){e.REVOKED="00",e.ATTESTED="01",e.NOTFOUND="-1"}(Ua||(Ua={}));var Ka=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Va=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Ja(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ga(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ja=function(){function e(t,r,n,a){Ga(this,e),this.hash="sha256",this.id=t,this.encryptedKey=r,this.address=n,this.salt=a}return Va(e,[{key:"toJson",value:function(){var e;return Ka({id:this.id},this.encryptedKey.serializeJson(),(Ja(e={address:this.address.toBase58(),salt:this.salt},"enc-alg","aes-256-gcm"),Ja(e,"hash",this.hash),Ja(e,"publicKey",this.publicKey),e))}}],[{key:"fromJson",value:function(t){var r=nr(t),n=new e(t.id,r,new Ct(t.address),t.salt);return n.publicKey=t.publicKey,n.hash=t.hash,n}}]),e}(),Wa=function(){function e(){Ga(this,e),this.controls=[]}return Va(e,[{key:"addControl",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,i=this.controls[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){if(a.value.address.toBase58()===e.address.toBase58())return}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}e.id=(this.controls.length+1).toString(),this.controls.push(e)}},{key:"toJson",value:function(){return JSON.stringify(this.toJsonObj())}},{key:"toJsonObj",value:function(){return{ontid:this.ontid,label:this.label,lock:this.lock,isDefault:this.isDefault,controls:this.controls.map(function(e){return e.toJson()}),extra:this.extra}}},{key:"exportPrivateKey",value:function(e,t){var r=this.controls[0].encryptedKey,n=this.controls[0].address,a=this.controls[0].salt;return r.decrypt(e,n,a,t)}},{key:"signTransaction",value:function(e,t,r){var n=this.exportPrivateKey(e,r);return Hr(t,n,n.algorithm.defaultSchema),t}}],[{key:"importIdentity",value:function(t,r,n,a,i,o){var u=new e,s=Buffer.from(i,"base64").toString("hex"),c=r.decrypt(n,a,s,o);t||(t=ae(Pe(4)));var l=c.getPublicKey();u.ontid=Ct.generateOntid(l),u.label=t,u.lock=!1,u.isDefault=!1;var f=new ja("1",r,Ct.fromOntid(u.ontid),i);return f.publicKey=l.serializeHex(),u.controls.push(f),u}},{key:"create",value:function(t,r,n,a){var i=new e;i.ontid="",i.label=n,i.lock=!1,i.isDefault=!1;var o=t.getPublicKey();i.ontid=Ct.generateOntid(o);var u=Ct.fromOntid(i.ontid),s=Ee(16),c=t.encrypt(r,u,s,a),l=Buffer.from(s,"hex").toString("base64"),f=new ja("1",c,u,l);return f.publicKey=o.serializeHex(),i.controls.push(f),i}},{key:"parseJson",value:function(t){return e.parseJsonObj(JSON.parse(t))}},{key:"parseJsonObj",value:function(t){var r=new e;return r.ontid=t.ontid,r.label=t.label,r.lock=t.lock,r.isDefault=t.isDefault,r.controls=t.controls.map(function(e){return ja.fromJson(e)}),r.extra=t.extra,r}}]),e}(),Fa=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var qa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.version=0}return Fa(e,[{key:"serialize",value:function(){var e=this.serializeUnsigned();e+=de(this.scripts.length);var t=!0,r=!1,n=void 0;try{for(var a,i=this.scripts[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){e+=a.value.serialize()}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}return e}},{key:"serializeUnsigned",value:function(){var e="";e+=ve(this.type),e+=ve(this.version),e+=this.serializeExclusiveData(),e+=de(this.attributes.length);var t=!0,r=!1,n=void 0;try{for(var a,i=this.attributes[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){e+=a.value.serialize()}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}e+=de(this.inputs.length);var o=!0,u=!1,s=void 0;try{for(var c,l=this.inputs[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){e+=c.value.serialize()}}catch(e){u=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(u)throw s}}e+=de(this.outputs.length);var f=!0,h=!1,v=void 0;try{for(var d,y=this.outputs[Symbol.iterator]();!(f=(d=y.next()).done);f=!0){e+=d.value.serialize()}}catch(e){h=!0,v=e}finally{try{!f&&y.return&&y.return()}finally{if(h)throw v}}return e}},{key:"getHash",value:function(){var e=this.serializeUnsigned(),t=W.enc.Hex.parse(e),r=W.SHA256(t).toString();return W.SHA256(W.enc.Hex.parse(r)).toString()}},{key:"getSignContent",value:function(){return this.getHashData()}},{key:"serializeUnsignedData",value:function(){return this.getHashData()}},{key:"getHashData",value:function(){return this.serializeUnsigned()}},{key:"sign",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.ECDSAwithSHA256;return e.sign(this.getHashData(),t).serializeHex().substring(2)}},{key:"serializeExclusiveData",value:function(){return""}}]),e}(),Ya=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Qa=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.type=Or.Invoke,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,qa),Ya(t,[{key:"serializeExclusiveData",value:function(){var e="";return e+=ce(this.script),e+=ve(this.gas,8,!0)}}]),t}(),Xa=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Za=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return Xa(e,null,[{key:"sendRawTransaction",value:function(e,t){var r=this.makeRequest("sendrawtransaction",t);return $.a.post(e,r).then(function(e){return e.data})}},{key:"makeRequest",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return{jsonrpc:"2.0",method:e,params:r,id:1}}},{key:"getBalance",value:function(e,t,r){var n=this.makeRequest("getstorage",t.toHexString(),r.serialize());return $.a.post(e,n).then(function(e){return e.data})}}]),e}(),$a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var ei=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return $a(e,[{key:"serialize",value:function(){var e="";return e+=ce(this.parameter),e+=ce(this.code)}}],[{key:"deserialize",value:function(t){var r=new me,n=new e;return n.parameter=r.readNextBytes(),n.code=r.readNextBytes(),n}},{key:"programFromParams",value:function(e){return it(e)}},{key:"programFromPubKey",value:function(e){return nt(e)}},{key:"programFromMultiPubKey",value:function(e,t){return at(t,e)}}]),e}(),ti=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var ri=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return ti(e,null,[{key:"makeInvokeTransaction",value:function(e,t,r){var n=Rt(r);return n+=ve(103),n+=e.serialize(),this.makeInvocationTransaction(n,t)}},{key:"makeInvocationTransaction",value:function(e,t){var r=new Qa;r.version=1,r.attributes=[];var n=new Er;n.usage=Rr.Script,n.data=t.serialize(),r.attributes[0]=n;var a=new Er;return a.usage=Rr.DescriptionUrl,a.data=Ee(16),r.attributes[1]=a,r.inputs=[],r.outputs=[],r.script=e,r.gas=0,r}}]),e}(),ni=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var ai=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return ni(e,[{key:"equals",value:function(t){return t===this||null!==t&&(t instanceof e&&(this.prevHash===t.prevHash&&this.prevIndex===t.prevIndex))}},{key:"hashCode",value:function(){return parseInt(ye(this.prevHash),16)+this.prevIndex}},{key:"serialize",value:function(){var e="";return e+=this.prevHash,e+=ve(this.prevIndex,2,!0)}}],[{key:"deserialize",value:function(t){var r=new me(t),n=new e;return n.prevHash=r.read(20),n.prevIndex=parseInt(ye(r.read(2)),16),n}}]),e}(),ii=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var oi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return ii(e,[{key:"serialize",value:function(){var e="";return e+=this.assetId,e+=ve(this.value,8,!0),e+=this.scriptHash.serialize()}}],[{key:"deserialize",value:function(t){var r=new me(t),n=new e;return n.assetId=r.read(32),n.value=r.readLong(),n.scriptHash=new Ct(r.read(20)),n}}]),e}(),ui=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var si=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||D.RPC_URL}return ui(e,[{key:"getUrl",value:function(){return this.url}},{key:"makeRequest",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return{jsonrpc:"2.0",method:e,params:r,id:1}}},{key:"getBalance",value:function(e){var t=this.makeRequest("getbalance",e.toBase58());return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"sendRawTransaction",value:function(e){var t=void 0;return t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.makeRequest("sendrawtransaction",e,1):this.makeRequest("sendrawtransaction",e),$.a.post(this.url,t).then(function(e){return e.data})}},{key:"getRawTransaction",value:function(e){var t=this.makeRequest("getrawtransaction",e);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getRawTransactionJson",value:function(e){var t=this.makeRequest("getrawtransaction",e,1);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getNodeCount",value:function(){var e=this.makeRequest("getconnectioncount");return $.a.post(this.url,e).then(function(e){return e.data})}},{key:"getBlockHeight",value:function(){var e=this.makeRequest("getblockcount");return $.a.post(this.url,e).then(function(e){return e.data})}},{key:"getBlockCount",value:function(){var e=this.makeRequest("getblockcount");return $.a.post(this.url,e).then(function(e){return e.data})}},{key:"getBlockJson",value:function(e){var t=this.makeRequest("getblock",e,1);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getContract",value:function(e){var t=this.makeRequest("getcontractstate",e);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getContractJson",value:function(e){var t=this.makeRequest("getcontractstate",e,1);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getBlock",value:function(e){var t=this.makeRequest("getblock",e);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getSmartCodeEvent",value:function(e){var t=this.makeRequest("getsmartcodeevent",e);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getBlockHeightByTxHash",value:function(e){var t=this.makeRequest("getblockheightbytxhash",e);return $.a.post(this.url,t).then(function(e){return e.data})}},{key:"getStorage",value:function(e,t){var r=this.makeRequest("getstorage",e,t);return console.log(r),$.a.post(this.url,r).then(function(e){return e.data})}},{key:"getMerkleProof",value:function(e){var t=this.makeRequest("getmerkleproof",e);return console.log(this.url),console.log(t),$.a.post(this.url,t).then(function(e){return e.data})}},{key:"getAllowance",value:function(e,t,r){if("ont"!==e&&"ong"!==e)throw g.INVALID_PARAMS;var n=this.makeRequest("getallowance",e,t.toBase58(),r.toBase58());return $.a.post(this.url,n).then(function(e){return e.data})}}]),e}(),ci="0000000000000000000000000000000000000001",li="0000000000000000000000000000000000000002";function fi(e){if(e===H.ONT)return new Ct(ci);if(e===H.ONG)return new Ct(li);throw new Error("Error token type.")}function hi(e){var t=new Q.BigNumber(e);if(!t.isInteger()||t.lte(new Q.BigNumber(0)))throw new Error("Amount is invalid.")}function vi(e,t,r,n,a,i,o){hi(n);var u=new Q.BigNumber(n),s=new yt;s.add(t,r,u);var c=[];c.push([s]);var l=fi(e),f=Kr("transfer",aa(c),l,a,i);return f.tokenType=e,f.from=t,f.to=r,f.amount=n,f.method="transfer",f.payer=o||t,f}function di(e,t,r,n,a,i){hi(r);var o=new Q.BigNumber(r),u=[],s=new yt;s.add(e,new Ct(ci),t,o),u.push(s);var c=Kr("transferFrom",aa(u),new Ct(li),a,i);return c.payer=n,c.tokenType="ONG",c.from=e,c.to=t,c.amount=r,c.method="transferFrom",c}function yi(e,t,r){if("ont"!==(e=e.toLowerCase())&&"ong"!==e)throw g.INVALID_PARAMS;var n="";n="ong"===e?li:ci;var a=[],i=new yt;return i.add(t,r),a.push(i),Kr("allowance",aa(a),new Ct(n),"0","0")}function pi(e,t){if("ont"!==(e=e.toLowerCase())&&"ong"!==e)throw g.INVALID_PARAMS;var r="";return r="ong"===e?li:ci,Kr("balanceOf",ce(t.serialize()),new Ct(r),"0","0")}function gi(e){var t=Br.deserialize(e),r=t.payload.serialize(),n=r.lastIndexOf("14000000000000000000000000000000000000000"),a=r.lastIndexOf("140000000000000000000000000000000000000002");if(n>0&&"1"===r.substr(n+41,1))t.tokenType="ONT";else{if(!(n>0&&"2"===r.substr(n+41,1)))throw new Error("Not a transfer tx");t.tokenType="ONG"}var i=Math.max(n,a),o=r.substring(0,i),u=o.indexOf("6a7cc86c")+8;if("51c1"===o.substr(u,4)){var s=o.substring(u+6);t.method=se(s)}else{var c=o.substring(u+2);t.method=se(c)}if("transfer"===t.method){var l=new me(o);l.pos+=10;var f=new Ct(l.read(20));t.from=f,l.pos+=8;var h=new Ct(l.read(20));t.to=h,l.pos+=6;var v=parseInt(l.read(1),16);if("6a7cc8"===l.str.substr(l.pos,6))t.amount=v-80;else{var d=He.fromHexstr(l.read(v)).value;t.amount=new Q.BigNumber(d).toString()}}else{if("transferFrom"!==t.method)throw new Error("Not a transfer tx");var y=new me(o);y.pos+=10;var p=new Ct(y.read(20));t.from=p,y.pos+=56;var g=new Ct(y.read(20));t.to=g,y.pos+=6;var m=parseInt(y.read(1),16);if("6a7cc8"===y.str.substr(y.pos,6))t.amount=m-80;else{var w=He.fromHexstr(y.read(m)).value;t.amount=new Q.BigNumber(w).toString()}}return t}var mi=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function wi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Si=function e(t,r,n,a){wi(this,e),this.from=t.serialize(),this.to=r.serialize(),this.tokenId=ve(n),this.value=new Q.BigNumber(a)},bi=function e(t,r,n,a,i){wi(this,e),this.spender=t.serialize(),this.from=r.serialize(),this.to=n.serialize(),this.tokenId=ve(a),this.value=new Q.BigNumber(i)},Ai="name",ki="symbol",Ri="totalSupply",xi="balanceOf",Pi="transfer",Ei="transferMulti",Ti="approve",Oi="approveMulti",Ni="allowance",Ii="transferFrom",Ci="transferFromMulti",Bi="compound",Di="init",_i="balancesOf",Hi="totalBalanceOf",zi=function(){function e(t){wi(this,e),this.contractAddr=t}return mi(e,[{key:"makeInitTx",value:function(e,t,r){return Vr(Di,[],this.contractAddr,e,t,r)}},{key:"makeTransferTx",value:function(e,t,r,n,a,i,o){var u=Pi,s=[new vt("sender",lt.ByteArray,e.serialize()),new vt("recv",lt.ByteArray,t.serialize()),new vt("tokenId",lt.ByteArray,r),new vt("amount",lt.Long,n)];return Vr(u,s,this.contractAddr,a,i,o)}},{key:"makeTransferMultiTx",value:function(e,t,r,n){var a=[];a.push(ue(Ei));var i=[],o=!0,u=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;i.push([f.from,f.to,f.tokenId,f.value])}}catch(e){u=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(u)throw s}}a.push(i);var h=Tt(a);return Vr("",h,this.contractAddr,t,r,n)}},{key:"makeApproveTx",value:function(e,t,r,n,a,i,o){var u=Ti,s=[new vt("owner",lt.ByteArray,e.serialize()),new vt("spender",lt.ByteArray,t.serialize()),new vt("tokenId",lt.ByteArray,ve(r)),new vt("amount",lt.Long,n)];return Vr(u,s,this.contractAddr,a,i,o)}},{key:"makeApproveMulti",value:function(e,t,r,n){var a=Oi,i=[];i.push(ue(a));var o=[],u=!0,s=!1,c=void 0;try{for(var l,f=e[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.push([h.from,h.to,h.tokenId,h.value])}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}i.push(o);var v=Tt(i);return Vr("",v,this.contractAddr,t,r,n)}},{key:"makeTransferFromMulti",value:function(e,t,r,n){var a=Ci,i=[];i.push(ue(a));var o=[],u=!0,s=!1,c=void 0;try{for(var l,f=e[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.push([h.spender,h.from,h.to,h.tokenId,h.value])}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}i.push(o);var v=Tt(i);return Vr("",v,this.contractAddr,t,r,n)}},{key:"makeTransferFromTx",value:function(e,t,r,n,a,i,o,u){var s=Ii,c=[new vt("sender",lt.ByteArray,e.serialize()),new vt("from",lt.ByteArray,t.serialize()),new vt("to",lt.ByteArray,r.serialize()),new vt("tokenId",lt.ByteArray,ve(n)),new vt("amount",lt.Long,a)];return Vr(s,c,this.contractAddr,i,o,u)}},{key:"makeCompoundTx",value:function(e,t,r,n,a){var i=Bi,o=[new vt("account",lt.ByteArray,e.serialize()),new vt("compoundNum",lt.Integer,t)];return Vr(i,o,this.contractAddr,r,n,a)}},{key:"makeQueryAllowanceTx",value:function(e,t,r){var n=Ni,a=[new vt("owner",lt.ByteArray,e.serialize()),new vt("spender",lt.ByteArray,t.serialize()),new vt("tokenId",lt.ByteArray,ve(r))];return Vr(n,a,this.contractAddr)}},{key:"makeQueryBalanceOfTx",value:function(e,t){var r=xi,n=[new vt("addr",lt.ByteArray,e.serialize()),new vt("tokenId",lt.ByteArray,ve(t))];return Vr(r,n,this.contractAddr)}},{key:"makeQueryTotalSupplyTx",value:function(e){var t=Ri,r=[new vt("tokenId",lt.ByteArray,ve(e))];return Vr(t,r,this.contractAddr)}},{key:"makeQueryNameTx",value:function(e){var t=Ai,r=[new vt("tokenId",lt.ByteArray,ve(e))];return Vr(t,r,this.contractAddr)}},{key:"makeQueryDecimalsTx",value:function(){return Vr(ki,[],this.contractAddr)}},{key:"makeQuerySymbolTx",value:function(e){var t=ki,r=[new vt("tokenId",lt.ByteArray,ve(e))];return Vr(t,r,this.contractAddr)}},{key:"makeQueryBalancesTx",value:function(e){var t=_i,r=[new vt("account",lt.ByteArray,e.serialize())];return Vr(t,r,this.contractAddr)}},{key:"makeQueryTotalBalanceTx",value:function(e){var t=Hi,r=[new vt("account",lt.ByteArray,e.serialize())];return Vr(t,r,this.contractAddr)}}]),e}(),Ui=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Li=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultOntid="",this.defaultAccountAddress="",this.identities=[],this.accounts=[]}return Ui(e,[{key:"addAccount",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,i=this.accounts[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){if(a.value.address.toBase58()===e.address.toBase58())return}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}this.accounts.push(e)}},{key:"addIdentity",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,i=this.identities[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){if(a.value.ontid===e.ontid)return}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}this.identities.push(e)}},{key:"setDefaultAccount",value:function(e){this.defaultAccountAddress=e}},{key:"setDefaultIdentity",value:function(e){this.defaultOntid=e}},{key:"toJson",value:function(){return JSON.stringify(this.toJsonObj())}},{key:"toJsonObj",value:function(){return{name:this.name,defaultOntid:this.defaultOntid,defaultAccountAddress:this.defaultAccountAddress,createTime:this.createTime,version:this.version,scrypt:this.scrypt,identities:this.identities.map(function(e){return e.toJsonObj()}),accounts:this.accounts.map(function(e){return e.toJsonObj()}),extra:null}}},{key:"signatureData",value:function(){return""}},{key:"toWalletFile",value:function(){return this.toJsonObj()}}],[{key:"parseJson",value:function(t){return e.parseJsonObj(JSON.parse(t))}},{key:"parseJsonObj",value:function(t){var r=new e;return r.name=t.name,r.defaultOntid=t.defaultOntid,r.defaultAccountAddress=t.defaultAccountAddress,r.createTime=t.createTime,r.version=t.version,r.scrypt=t.scrypt,r.identities=t.identities&&t.identities.map(function(e){return Wa.parseJsonObj(e)}),r.accounts=t.accounts&&t.accounts.map(function(e){return Xr.parseJsonObj(e)}),r.extra=t.extra,r}},{key:"fromWalletFile",value:function(t){return e.parseJsonObj(t)}},{key:"create",value:function(t){var r=new e;return r.name=t,r.createTime=(new Date).toISOString(),r.version="1.0",r.scrypt={n:b.cost,r:b.blockSize,p:b.parallel,dkLen:b.size},r}}]),e}(),Mi=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Ki=r(11),Vi="ceab719b8baa2310f232ee0d277c061704541cfb",Ji="http://neonode1.ont.network:10332",Gi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return Mi(e,null,[{key:"setServerNode",value:function(t){if(t){var r="";return r=t.indexOf("http")>-1?t.substr("http://".length):t,void(e.SERVER_NODE=r)}throw new Error("Can not set "+t+"as server node")}},{key:"setRestPort",value:function(t){if(t)return e.REST_PORT=t,void(e.restClient=new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT));throw new Error("Can not set "+t+" as restful port")}},{key:"setSocketPort",value:function(t){if(!t)throw new Error("Can not set "+t+"as socket port");e.SOCKET_PORT=t}},{key:"getDecryptError",value:function(e){return{error:g.Decrypto_ERROR,result:""}}},{key:"transformPassword",value:function(e){return Ie(e)?Buffer.from(e,"base64").toString():e}},{key:"createWallet",value:function(t,r,n,a,i,o){var u=Li.create(t);r=this.transformPassword(r);var s=Zt.random(),c=Wa.create(s,r,t);u.defaultOntid=c.ontid,u.addIdentity(c);var l={error:0,result:u.toJson(),tx:""},f=s.getPublicKey(),h=sa(c.ontid,f,a,i);return h.payer=new Ct(n),Hr(h,s),s.key="",r="",new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT).sendRawTransaction(h.serialize(),!0).then(function(e){if("01"===e.Result.Result)return l.tx=h.serialize(),o&&Se(JSON.stringify(l),o),l;var t={error:g.PreExec_ERROR,result:""};return o&&Se(JSON.stringify(t),o),t}).catch(function(e){l={error:g.NETWORK_ERROR,result:""},o&&Se(JSON.stringify(l),o)})}},{key:"importIdentityWithWallet",value:function(t,r,n,a,i,o){var u=void 0,s=new Wa;try{var c=new Zt(r),l=new Ct(a);n=this.transformPassword(n),s=Wa.importIdentity(t,c,n,l,i)}catch(e){return u=this.getDecryptError(e),o&&Se(JSON.stringify(u),o),u}u={error:g.SUCCESS,result:s.toJson()};var f=Wr(va(s.ontid)),h=Fr("http://"+e.SERVER_NODE+":"+e.REST_PORT,!0);return n="",$.a.post(h,f).then(function(e){return e.data.Result.Result||(u.error=g.UNKNOWN_ONTID,u.result=""),o&&Se(JSON.stringify(u),o),u}).catch(function(e){u={error:g.NETWORK_ERROR,result:""},o&&Se(JSON.stringify(u),o)})}},{key:"importIdentityAndCreateWallet",value:function(t,r,n,a,i,o){var u=new Wa,s={},c=void 0;try{n=this.transformPassword(n);var l=new Zt(r),f=new Ct(a);u=Wa.importIdentity(t,l,n,f,i);var h=Li.create(u.label);h.defaultOntid=u.ontid,h.addIdentity(u);var v=h.toJson();c={error:g.SUCCESS,result:v};var d=Wr(va(u.ontid)),y=Fr("http://"+e.SERVER_NODE+":"+e.REST_PORT,!0);return $.a.post(y,d).then(function(e){return e.data.Result.Result||(c.error=g.UNKNOWN_ONTID,c.result=""),n="",o&&Se(JSON.stringify(c),o),c}).catch(function(e){c={error:g.NETWORK_ERROR,result:""},o&&Se(JSON.stringify(c),o)})}catch(e){return s=this.getDecryptError(e),o&&Se(JSON.stringify(s),o),Promise.reject(s)}}},{key:"createIdentity",value:function(t,r,n,a,i,o){var u=Zt.random();r=this.transformPassword(r);var s=Wa.create(u,r,t),c=s.toJson(),l={error:g.SUCCESS,result:c,tx:""},f=u.getPublicKey(),h=sa(s.ontid,f,a,i);return h.payer=new Ct(n),Hr(h,u),r="",u.key="",new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT).sendRawTransaction(h.serialize(),!0).then(function(e){if("01"===e.Result.Result)return l.tx=h.serialize(),o&&Se(JSON.stringify(l),o),u.key="",r="",l;var t={error:g.PreExec_ERROR,result:""};return o&&Se(JSON.stringify(t),o),t}).catch(function(e){l={error:g.NETWORK_ERROR,result:""},o&&Se(JSON.stringify(l),o)})}},{key:"createAccount",value:function(e,t,r){var n=Te();t=this.transformPassword(t);var a=ue(n),i=Zt.generateFromMnemonic(n),o=Xr.create(i,t,e),u=jt(a,o.address,Buffer.from(o.salt,"base64").toString("hex"),t),s=o.toJson(),c={error:g.SUCCESS,result:s,mnemonicEnc:u};return r&&Se(JSON.stringify(c),r),i.key="",t="",n="",c}},{key:"decryptMnemonicEnc",value:function(e,t,r,n,a){var i;n=this.transformPassword(n);var o=se(Wt(e,new Ct(t),Buffer.from(r,"base64").toString("hex"),n));return i={error:g.SUCCESS,result:o},a&&Se(JSON.stringify(i),a),i}},{key:"importAccountWithWallet",value:function(e,t,r,n,a,i){var o=new Xr;a=this.transformPassword(a);var u=new Zt(t);try{var s=new Ct(r);o=Xr.importAccount(e,u,a,s,n)}catch(e){var c=this.getDecryptError(e);return i&&Se(JSON.stringify(c),i),c}var l={error:g.SUCCESS,result:o.toJson()};return r!==o.address.toBase58()&&(l.error=g.INVALID_ADDR,l.result=""),i&&Se(JSON.stringify(l),i),a="",l}},{key:"signSelfClaim",value:function(t,r,n,a,i,o,u,s){var c=void 0;i=this.transformPassword(i);var l=new Zt(a),f="http://"+e.SERVER_NODE+":"+e.REST_PORT+C.sendRawTx;try{var h=new Ct(o),v=Buffer.from(u,"base64").toString("hex");c=l.decrypt(i,h,v)}catch(e){var d=this.getDecryptError(e);return s&&Se(JSON.stringify(d),s),d}var y={issuer:n,subject:n,issuedAt:Ae()},p=n+"#keys-1",g=new La(y,void 0,void 0);g.sign(f,p,c);var m={error:0,result:g};return s&&Se(JSON.stringify(m),s),c.key="",i="",m}},{key:"decryptEncryptedPrivateKey",value:function(e,t,r,n,a){t=this.transformPassword(t);var i=new Zt(e),o=void 0;try{var u=new Ct(r),s=Buffer.from(n,"base64").toString("hex");o=i.decrypt(t,u,s)}catch(e){var c=this.getDecryptError(e);return a&&Se(JSON.stringify(c),a),c}var l={error:0,result:o.key};return a&&Se(JSON.stringify(l),a),t="",l}},{key:"getClaim",value:function(t,r,n,a,i,o,u,s,c,l,f,h){var v=void 0;o=this.transformPassword(o);var d=new Zt(i);try{var y=new Ct(u),p=Buffer.from(s,"base64").toString("hex");v=d.decrypt(o,y,p)}catch(e){var m=this.getDecryptError(e);return h&&Se(JSON.stringify(m),h),m}var w="claim"+t,S={Type:"JSON",Value:{Context:r,Issuer:n}},b=JSON.stringify(S),A=new ka;A.key=w,A.type="JSON",A.value=b;var k=la(a,[A],v.getPublicKey(),l,f);return k.payer=new Ct(c),Hr(k,v),new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT).sendRawTransaction(k.serialize(),!0).then(function(e){if("01"===e.Result.Result){var t={error:g.SUCCESS,result:"",tx:k.serialize()};return h&&Se(JSON.stringify(t),h),v.key="",o="",t}var r={error:g.PreExec_ERROR,result:""};return h&&Se(JSON.stringify(r),h),r}).catch(function(e){var t={error:g.NETWORK_ERROR,result:""};h&&Se(JSON.stringify(t),h)})}},{key:"signData",value:function(e,t,r,n,a,i){var o=void 0;r=this.transformPassword(r);var u=new Zt(t),s=void 0;try{var c=new Ct(n),l=Buffer.from(a,"base64").toString("hex");o=u.decrypt(r,c,l)}catch(e){return s=this.getDecryptError(e),i&&Se(JSON.stringify(s),i),s}return s=o.sign(e).serializePgp(),i&&Se(JSON.stringify(s),i),o.key="",r="",s}},{key:"getBalance",value:function(t,r){var n=new Ct(t),a="http://"+e.SERVER_NODE+":"+e.REST_PORT+C.getBalance+"/"+n.toBase58();return $.a.get(a).then(function(e){if(0===e.data.Error){var t={error:0,result:e.data.Result};return r&&Se(JSON.stringify(t),r),t}var n={error:e.data.Error,result:""};return r&&Se(JSON.stringify(n),r),n}).catch(function(e){var t={error:g.NETWORK_ERROR,result:""};return r&&Se(JSON.stringify(t),r),Promise.reject(t)})}},{key:"transferAssets",value:function(e,t,r,n,a,i,o,u,s,c,l){var f=void 0,h=void 0;i=this.transformPassword(i);try{f=new Ct(t),h=new Ct(r)}catch(e){var v={error:g.INVALID_PARAMS,result:""};return l&&Se(JSON.stringify(v),l),v}var d=void 0,y=new Zt(a);try{var p=new Ct(t),m=Buffer.from(o,"base64").toString("hex");d=y.decrypt(i,p,m)}catch(e){var w=this.getDecryptError(e);return l&&Se(JSON.stringify(w),l),w}var S=vi(e,f,h,n,u,s);S.payer=new Ct(c),Hr(S,d);var b={error:g.SUCCESS,result:"",tx:S.serialize(),txHash:ye(S.getSignContent())};return l&&Se(JSON.stringify(b),l),d.key="",i="",b}},{key:"claimOng",value:function(e,t,r,n,a,i,o,u,s){var c=void 0;n=this.transformPassword(n);try{c=new Ct(e)}catch(e){var l={error:g.INVALID_PARAMS,result:""};return s&&Se(JSON.stringify(l),s),l}var f=void 0,h=new Zt(r);try{var v=Buffer.from(a,"base64").toString("hex");f=h.decrypt(n,c,v)}catch(e){var d=this.getDecryptError(e);return s&&Se(JSON.stringify(d),s),d}var y=di(c,c,t,new Ct(u),i,o);Hr(y,f);var p={error:g.SUCCESS,result:"",tx:y.serialize(),txHash:ye(y.getSignContent())};return s&&Se(JSON.stringify(p),s),f.key="",n="",p}},{key:"exportIdentityToQrcode",value:function(e,t){var r=Wa.parseJson(e),n=r.controls[0].salt;Ie(n)||(n=Buffer.from(n,"hex").toString("base64"));var a={type:"I",label:r.label,algorithm:"ECDSA",scrypt:{n:4096,p:8,r:8,dkLen:64},key:r.controls[0].encryptedKey.key,salt:n,address:r.controls[0].address.toBase58(),parameters:{curve:"secp256r1"}};return t&&Se(JSON.stringify(a),t),a}},{key:"exportIdentityToKeystring",value:function(e,t){var r=Wa.parseJson(e),n=r.controls[0].address.toBase58(),a=r.controls[0].salt+n+r.controls[0].encryptedKey.key;return t&&Se(JSON.stringify(a),t),a}},{key:"exportAccountToQrcode",value:function(e,t){var r=Xr.parseJson(e),n={type:"A",label:r.label,algorithm:"ECDSA",scrypt:{n:4096,p:8,r:8,dkLen:64},key:r.encryptedKey.key,salt:r.salt,address:r.address.toBase58(),parameters:{curve:"secp256r1"}};return t&&Se(JSON.stringify(n),t),n}},{key:"exportAccountToKeystring",value:function(e,t){var r=Xr.parseJson(e),n=r.salt+r.address.toBase58()+r.encryptedKey.key;return t&&Se(JSON.stringify(n),t),n}},{key:"importAccountMnemonic",value:function(e,t,r,n){if(t=t.trim(),r=this.transformPassword(r),!w.validateMnemonic(t)){var a={error:g.INVALID_PARAMS,result:""};return n&&Se(JSON.stringify(a),n),a}var i=w.mnemonicToSeedHex(t),o=Ki.fromMasterSeed(Buffer.from(i,"hex")).derive(M),u=Buffer.from(o.privateKey).toString("hex"),s=new Zt(u),c=Xr.create(s,r,e).toJson(),l={error:g.SUCCESS,result:c};return n&&Se(JSON.stringify(l),n),s.key="",r="",t="",l}},{key:"exportWifPrivakeKey",value:function(e,t,r,n,a){if(34!==r.length&&40!==r.length){var i={error:g.INVALID_PARAMS,result:""};return a&&Se(JSON.stringify(i),a),i}t=this.transformPassword(t);var o=new Zt(e),u=new Ct(r),s=Buffer.from(n,"base64").toString("hex"),c=o.decrypt(t,u,s),l=c.serializeWIF(),f={error:g.SUCCESS,result:l};return a&&Se(JSON.stringify(f),a),c.key="",l="",t="",f}},{key:"importAccountWithWif",value:function(e,t,r,n){var a=void 0;r=this.transformPassword(r);try{a=Zt.deserializeWIF(t)}catch(e){var i={error:g.INVALID_PARAMS,result:""};return n&&Se(JSON.stringify(i),n),i}var o=Xr.create(a,r,e),u={error:g.SUCCESS,result:o.toJson()};return n&&Se(JSON.stringify(u),n),a.key="",r="",u}},{key:"importAccountWithPrivateKey",value:function(e,t,r,n){if(t=t.trim(),r=this.transformPassword(r),!t||64!==t.length||!Ce(t)){var a={error:g.INVALID_PARAMS,result:""};return n&&Se(JSON.stringify(a),n),a}var i=new Zt(t),o=Xr.create(i,r,e),u={error:g.SUCCESS,result:o.toJson()};return n&&Se(JSON.stringify(u),n),t="",r="",u}},{key:"importAccountWithKeystore",value:function(e,t,r){var n=void 0;t=this.transformPassword(t);try{n=JSON.parse(e)}catch(e){var a={error:g.INVALID_PARAMS,result:""};return r&&Se(JSON.stringify(a),r),a}if("A"!==n.type){var i={error:g.INVALID_PARAMS,result:""};return r&&Se(JSON.stringify(i),r),i}var o=new Xr,u=new Zt(n.key);try{var s={cost:n.scrypt.n||4096,blockSize:n.scrypt.p||8,parallel:n.scrypt.r||8,size:n.scrypt.dkLen||64},c=new Ct(n.address);o=Xr.importAccount(n.label,u,t,c,n.salt,s);var l={error:g.SUCCESS,result:o.toJson()};return r&&Se(JSON.stringify(l),r),t="",l}catch(e){var f=this.getDecryptError(e);return r&&Se(JSON.stringify(f),r),f}}},{key:"getUnclaimedOng",value:function(t,r){return new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT).getAllowance("ong",new Ct(ci),new Ct(t)).then(function(e){var t={error:g.SUCCESS,result:e.Result};return r&&Se(JSON.stringify(t),r),t}).catch(function(e){var t={error:e.Error,result:""};return r&&Se(JSON.stringify(t),r),t})}},{key:"querySmartCodeEventByTxhash",value:function(t,r){return new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT).getSmartCodeEvent(t).then(function(e){var t={error:g.SUCCESS,result:e};return r&&Se(JSON.stringify(t),r),t}).catch(function(e){var t={error:e.Error,result:""};return r&&Se(JSON.stringify(t),r),t})}},{key:"createSharedWallet",value:function(e,t,r){var n=parseInt(e,10),a=[],i=[],o=g.SUCCESS;try{i=(a=JSON.parse(t)).map(function(e){return Qe.deserializeHex(new me(e))})}catch(e){o=g.INVALID_PARAMS}(n<2||a.length<n||a.length>12)&&(o=g.INVALID_PARAMS);var u="";try{u=Ct.fromMultiPubKeys(n,i).toBase58()}catch(e){o=g.INVALID_PARAMS}if(r){var s={error:o,result:u};Se(JSON.stringify(s),r)}return u}},{key:"adderssFromPublicKey",value:function(e,t){var r=Qe.deserializeHex(new me(e)),n=Ct.fromPubKey(r).toBase58(),a={error:g.SUCCESS,result:n};return t&&Se(JSON.stringify(a),t),n}},{key:"makeMultiSignTransaction",value:function(e,t,r,n,a,i,o){var u=void 0,s=void 0;try{u=new Ct(t),s=new Ct(r)}catch(e){var c={error:g.INVALID_PARAMS,result:""};return o&&Se(JSON.stringify(c),o),c}var l=vi(e,u,s,n,a,i);l.payer=u;var f={error:g.SUCCESS,txHash:ye(l.getSignContent()),txData:l.serialize()};return o&&Se(JSON.stringify(f),o),f}},{key:"signMultiAddrTransaction",value:function(e,t,r,n,a,i,o,u){n=this.transformPassword(n);var s=void 0,c=new Zt(e);try{var l=new Ct(t),f=Buffer.from(r,"base64").toString("hex");s=c.decrypt(n,l,f)}catch(e){var h=this.getDecryptError(e);return u&&Se(JSON.stringify(h),u),h}var v=parseInt(i,10),d=Br.deserialize(o),y=JSON.parse(a).map(function(e){return new Qe(e)});Mr(d,v,y,s);var p={error:g.SUCCESS,signedHash:d.serialize()};return u&&Se(JSON.stringify(p),u),d}},{key:"neoTransfer",value:function(e,t,r,n,a,i,o,u){a=this.transformPassword(a);var s=new Ct(t),c=new Ct(e),l=jn.parseJson('{"hash":"0x5bb169f915c916a5e30a3c13a5e0cd228ea26826","entrypoint":"Main","functions":[{"name":"Name","parameters":[],"returntype":"String"},{"name":"Symbol","parameters":[],"returntype":"String"},{"name":"Decimals","parameters":[],"returntype":"Integer"},{"name":"Main","parameters":[{"name":"operation","type":"String"},{"name":"args","type":"Array"}],"returntype":"Any"},{"name":"Init","parameters":[],"returntype":"Boolean"},{"name":"TotalSupply","parameters":[],"returntype":"Integer"},{"name":"Transfer","parameters":[{"name":"from","type":"ByteArray"},{"name":"to","type":"ByteArray"},{"name":"value","type":"Integer"}],"returntype":"Boolean"},{"name":"BalanceOf","parameters":[{"name":"address","type":"ByteArray"}],"returntype":"Integer"}],"events":[{"name":"transfer","parameters":[{"name":"arg1","type":"ByteArray"},{"name":"arg2","type":"ByteArray"},{"name":"arg3","type":"Integer"}],"returntype":"Void"}]}'),f=new Ct(ye(Vi)),h=parseInt(r,10),v=l.getFunction("Transfer");v.name=v.name.toLowerCase();var d=void 0,y=new Zt(n);try{var p=Buffer.from(i,"base64").toString("hex");d=y.decrypt(a,c,p,u)}catch(e){var m=this.getDecryptError(e);return o&&Se(JSON.stringify(m),o),m}var w=new vt("from",lt.ByteArray,c.serialize()),S=new vt("to",lt.ByteArray,s.serialize()),b=new vt("value",lt.Integer,1e8*h);v.setParamsValue(w,S,b);var A=ri.makeInvokeTransaction(f,c,v),k=new ei;return k.parameter=ei.programFromParams([A.sign(d)]),k.code=ei.programFromPubKey(d.getPublicKey()),A.scripts=[k],Za.sendRawTransaction(Ji,A.serialize()).then(function(e){var t={error:g.SUCCESS,result:""};return e.result?(t.result=ye(A.getHash()),o&&Se(JSON.stringify(t),o)):(t.error=g.NETWORK_ERROR,o&&Se(JSON.stringify(t),o)),t})}},{key:"getNeoBalance",value:function(e,t){var r=new Ct(ye(Vi)),n=new Ct(e);return Za.getBalance(Ji,r,n).then(function(e){var r={error:g.SUCCESS,result:0};if(e.result){var n=parseInt(ye(e.result),16);r.result=n}return t&&Se(JSON.stringify(r),t),r})}},{key:"sendTransaction",value:function(t,r){return new dn("http://"+e.SERVER_NODE+":"+e.REST_PORT).sendRawTransaction(t).then(function(e){var t={error:g.SUCCESS,result:e};return r&&Se(JSON.stringify(t),r),t}).catch(function(e){var t={error:e.Error,result:""};return r&&Se(JSON.stringify(t),r),t})}},{key:"queryOep8Balance",value:function(t,r,n,a){var i=new Ct(ye(t)),o=new zi(i),u=new Ct(r),s=o.makeQueryBalanceOfTx(u,n);return e.restClient.sendRawTransaction(s.serialize(),!0).then(function(e){var t={error:g.SUCCESS,result:0};return e.Result.Result&&(t.result=parseInt(ye(e.Result.Result),16)),a&&Se(JSON.stringify(t),a),t})}},{key:"queryOep8Balances",value:function(t,r,n){var a=new Ct(ye(t)),i=new zi(a),o=new Ct(r),u=i.makeQueryBalancesTx(o);return e.restClient.sendRawTransaction(u.serialize(),!0).then(function(e){var t={error:g.SUCCESS,result:[0,0,0,0,0,0,0,0]};if(e.Result.Result){var r=e.Result.Result.map(function(e){return e?parseInt(ye(e),16):0});t.result=r}return n&&Se(JSON.stringify(t),n),t})}},{key:"queryOep8TotalBalance",value:function(t,r,n){var a=new Ct(ye(t)),i=new zi(a),o=new Ct(r),u=i.makeQueryTotalBalanceTx(o);return e.restClient.sendRawTransaction(u.serialize(),!0).then(function(e){var t={error:g.SUCCESS,result:0};return e.Result.Result&&(t.result=parseInt(ye(e.Result.Result),16)),n&&Se(JSON.stringify(t),n),t})}},{key:"transferOep8",value:function(e,t,r,n,a,i,o,u,s,c,l,f){var h=void 0,v=void 0,d=void 0;o=this.transformPassword(o);try{h=new Ct(t),v=new Ct(r),d=new Ct(l)}catch(e){return{error:g.INVALID_PARAMS,result:""}}var y=void 0,p=new Zt(i);try{var m=new Ct(t),w=Buffer.from(u,"base64").toString("hex");y=p.decrypt(o,m,w)}catch(e){return this.getDecryptError(e)}var S=new Ct(ye(e)),b=new zi(S).makeTransferTx(h,v,a,n,s,c,d);Hr(b,y);var A={error:g.SUCCESS,result:"",tx:b.serialize(),txHash:ye(b.getSignContent())};return f&&Se(JSON.stringify(A),f),y.key="",o="",A}},{key:"compoundOep8",value:function(e,t,r,n,a,i,o,u,s,c){var l=void 0;a=this.transformPassword(a);try{l=new Ct(t)}catch(e){return{error:g.INVALID_PARAMS,result:""}}var f=void 0,h=new Zt(n);try{var v=Buffer.from(i,"base64").toString("hex");f=h.decrypt(a,l,v)}catch(e){return this.getDecryptError(e)}var d=new Ct(ye(e)),y=new zi(d).makeCompoundTx(l,r,o,u,l);Hr(y,f);var p={error:g.SUCCESS,result:"",tx:y.serialize(),txHash:ye(y.getSignContent())};return c&&Se(JSON.stringify(p),c),f.key="",a="",p}}]),e}();Gi.SERVER_NODE=E,Gi.REST_PORT=O,Gi.SOCKET_PORT=N,Gi.restClient=new dn;var ji=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Wi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fi(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,i){try{var o=t[a](i),u=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}var qi=new Ct("0000000000000000000000000000000000000007");function Yi(e,t,r,n,a,i,o,u){Ne(a),"did"===e.substr(0,3)&&(e=ue(e));var s=new yt;return s.add(ue(t),n.serialize(),a,e,r),Kr("registerCandidate",aa([s]),qi,o,u,i)}function Qi(e,t,r,n,a){var i=new yt;return i.add(ue(t),e.serialize()),Kr("unRegisterCandidate",aa([i]),qi,n,a,r)}function Xi(e,t,r,n){var a=new yt;return a.add(ue(e)),Kr("approveCandidate",aa([a]),qi,r,n,t)}function Zi(e,t,r,n){var a=new yt;return a.add(ue(e)),Kr("rejectCandidate",aa([a]),qi,r,n,t)}function $i(e,t,r,n,a,i){if(t.length!==r.length)throw g.INVALID_PARAMS;var o=new yt;o.add(e.serialize()),o.add(t.length);var u=!0,s=!1,c=void 0;try{for(var l,f=t[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.add(ue(h))}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}o.add(r.length);var v=!0,d=!1,y=void 0;try{for(var p,m=r[Symbol.iterator]();!(v=(p=m.next()).done);v=!0){var w=p.value;o.add(w)}}catch(e){d=!0,y=e}finally{try{!v&&m.return&&m.return()}finally{if(d)throw y}}return Kr("voteForPeer",aa([o]),qi,a,i,n)}function eo(e,t,r,n,a,i){if(t.length!==r.length)throw g.INVALID_PARAMS;var o=new yt;o.add(e.serialize()),o.add(t.length);var u=!0,s=!1,c=void 0;try{for(var l,f=t[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.add(ue(h))}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}o.add(r.length);var v=!0,d=!1,y=void 0;try{for(var p,m=r[Symbol.iterator]();!(v=(p=m.next()).done);v=!0){var w=p.value;o.add(w)}}catch(e){d=!0,y=e}finally{try{!v&&m.return&&m.return()}finally{if(d)throw y}}return Kr("unVoteForPeer",aa([o]),qi,a,i,n)}function to(e,t,r,n,a,i){if(t.length!==r.length)throw g.INVALID_PARAMS;var o=new yt;o.add(e.serialize()),o.add(t.length);var u=!0,s=!1,c=void 0;try{for(var l,f=t[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.add(ue(h))}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}o.add(r.length);var v=!0,d=!1,y=void 0;try{for(var p,m=r[Symbol.iterator]();!(v=(p=m.next()).done);v=!0){var w=p.value;o.add(w)}}catch(e){d=!0,y=e}finally{try{!v&&m.return&&m.return()}finally{if(d)throw y}}return Kr("withdraw",aa([o]),qi,a,i,n)}function ro(e,t,r,n,a){var i=new yt;return i.add(ue(t),e.serialize()),Kr("quitNode",aa([i]),qi,n,a,r)}function no(e,t,r,n,a,i){var o=new yt;return o.add(ue(e),t.serialize(),r),Kr("changeMaxAuthorization",aa([o]),qi,a,i,n)}function ao(e,t,r,n,a,i){var o=new yt;return o.add(ue(e),t.serialize(),r),Kr("setPeerCost",aa([o]),qi,a,i,n)}function io(e,t,r,n){var a=new yt;return a.add(e.serialize()),Kr("withdrawFee",aa([a]),qi,r,n,t)}function oo(e,t,r,n,a,i){var o=new yt;o.add(e.serialize()),o.add(t.length);var u=!0,s=!1,c=void 0;try{for(var l,f=t[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.add(ue(h))}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}o.add(r.length);var v=!0,d=!1,y=void 0;try{for(var p,g=r[Symbol.iterator]();!(v=(p=g.next()).done);v=!0){var m=p.value;o.add(m)}}catch(e){d=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(d)throw y}}return Kr("authorizeForPeer",aa([o]),qi,a,i,n)}function uo(e,t,r,n,a,i){var o=new yt;o.add(e.serialize()),o.add(t.length);var u=!0,s=!1,c=void 0;try{for(var l,f=t[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var h=l.value;o.add(ue(h))}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}o.add(r.length);var v=!0,d=!1,y=void 0;try{for(var p,g=r[Symbol.iterator]();!(v=(p=g.next()).done);v=!0){var m=p.value;o.add(m)}}catch(e){d=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(d)throw y}}return Kr("unAuthorizeForPeer",aa([o]),qi,a,i,n)}function so(e,t,r,n,a,i){var o=new yt;return o.add(ue(e),t.serialize(),r),Kr("addInitPos",aa([o]),qi,a,i,n)}function co(e,t,r,n,a,i){var o=new yt;return o.add(ue(e),t.serialize(),r),Kr("reduceInitPos",aa([o]),qi,a,i,n)}function lo(e,t,r,n){var a=new yt;return a.add(e.serialize()),Kr("withdrawOng",aa([a]),qi,r,n,t)}var fo=function(){var e=Fi(regeneratorRuntime.mark(function e(t,r){var n,a,i,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new dn(r),a=qi.toHexString(),i=ue("peerAttributes")+t,e.next=5,n.getStorage(a,i);case 5:if(o=e.sent,!(u=o.Result)){e.next=11;break}return e.abrupt("return",Ao.deserialize(new me(u)));case 11:return e.abrupt("return",new Ao);case 12:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),ho=function(){var e=Fi(regeneratorRuntime.mark(function e(t,r){var n,a,i,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new dn(r),a=qi.toHexString(),i=ue("splitFeeAddress")+t.serialize(),e.next=5,n.getStorage(a,i);case 5:if(o=e.sent,!(u=o.Result)){e.next=11;break}return e.abrupt("return",ko.deserialize(new me(u)));case 11:return e.abrupt("return",new ko);case 12:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),vo=function(){var e=Fi(regeneratorRuntime.mark(function e(t,r,n){var a,i,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new dn(n),i=qi.toHexString(),o=ue("voteInfoPool")+t+r.serialize(),e.next=5,a.getStorage(i,o);case 5:if(u=e.sent,!(s=u.Result)){e.next=11;break}return e.abrupt("return",Ro.deserialize(new me(s)));case 11:return e.abrupt("return",new Ro);case 12:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),yo=function(){var e=Fi(regeneratorRuntime.mark(function e(t){var r,n,a,i,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new dn(t),n=qi.toHexString(),a=ue("governanceView"),e.next=5,r.getStorage(n,a);case 5:return i=e.sent,o=i.Result,u=So.deserialize(new me(o)),e.abrupt("return",u);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),po=function(){var e=Fi(regeneratorRuntime.mark(function e(t){var r,n,a,i,o,u,s,c,l,f,h,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new dn(t),n=qi.toHexString(),e.next=4,yo(t);case 4:return a=e.sent,i=ue("peerPool"),o=ve(a.view,4,!0),u=i+o,e.next=10,r.getStorage(n,u);case 10:for(s=e.sent,c=new me(s.Result),l=c.readInt(),f={},h=0;h<l;h++)v=bo.deserialize(c),f[v.peerPubkey]=v;return e.abrupt("return",f);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),go=function(){var e=Fi(regeneratorRuntime.mark(function e(t){var r,n,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new dn(t),n=qi.toHexString(),a=ue("globalParam"),e.next=5,r.getStorage(n,a);case 5:if(!(i=e.sent).Result){e.next=10;break}return e.abrupt("return",xo.deserialize(new me(i.Result)));case 10:return e.abrupt("return",new xo);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),mo=function(){var e=Fi(regeneratorRuntime.mark(function e(t,r){var n,a,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new dn(r),a=qi.toHexString(),i=ue("totalStake")+t.serialize(),e.next=5,n.getStorage(a,i);case 5:if(!(o=e.sent).Result){e.next=10;break}return e.abrupt("return",Po.deserialize(new me(o.Result)));case 10:return e.abrupt("return",new Po);case 11:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),wo=function(){var e=Fi(regeneratorRuntime.mark(function e(t,r){var n,a,i,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mo(t,r);case 2:if((n=e.sent).address){e.next=5;break}return e.abrupt("return",0);case 5:return a=new dn(r),e.next=8,a.getBlockHeight();case 8:return i=e.sent.Result,e.next=11,a.getBlockJson(i);case 11:return o=e.sent.Result,u=o.Header.Timestamp-G,e.abrupt("return",De(n.stake,n.timeOffset,u));case 14:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),So=function(){function e(){Wi(this,e),this.view=0,this.height=0,this.txhash=""}return ji(e,[{key:"serialize",value:function(){var e="";return e+=ve(this.view,4,!0),e+=ve(this.height,4,!0),e+=ce(this.txhash)}}],[{key:"deserialize",value:function(t){var r=new e;return r.view=t.readUint32(),r.height=t.readUint32(),r.txhash=t.read(64),r}}]),e}(),bo=function(){function e(){Wi(this,e),this.index=0,this.peerPubkey="",this.status=0,this.initPos=0,this.totalPos=0}return ji(e,[{key:"serialize",value:function(){var e="";return e+=ve(this.index,4,!0),e+=le(this.peerPubkey),e+=this.address.serialize(),e+=ve(this.status),e+=ve(this.initPos,8,!0),e+=ve(this.totalPos,8,!0)}}],[{key:"deserialize",value:function(t){var r=new e;return r.index=t.readInt(),r.peerPubkey=se(t.readNextBytes()),r.address=Ct.deserialize(t),r.status=parseInt(t.read(1),16),r.initPos=t.readLong(),r.totalPos=t.readLong(),r}}]),e}(),Ao=function(){function e(){Wi(this,e),this.peerPubkey="",this.maxAuthorize=0,this.t2PeerCost=100,this.t1PeerCost=100,this.tPeerCost=0,this.field1="",this.field2="",this.field3="",this.field4=""}return ji(e,[{key:"serialize",value:function(){return""}}],[{key:"deserialize",value:function(t){var r=new e;return r.peerPubkey=se(t.readNextBytes()),r.maxAuthorize=t.readLong(),r.t2PeerCost=t.readLong(),r.t1PeerCost=t.readLong(),r.tPeerCost=t.readLong(),t.isEmpty?r:(r.field1=t.readNextBytes(),r.field2=t.readNextBytes(),r.field3=t.readNextBytes(),r.field4=t.readNextBytes(),r)}}]),e}(),ko=function(){function e(){Wi(this,e),this.amount=0}return ji(e,null,[{key:"deserialize",value:function(t){var r=new e;return r.address=Ct.deserialize(t),r.amount=t.readLong(),r}}]),e}(),Ro=function(){function e(){Wi(this,e),this.peerPubkey="",this.consensusPos=0,this.freezePos=0,this.newPos=0,this.withdrawPos=0,this.withdrawFreezePos=0,this.withdrawUnfreezePos=0}return ji(e,null,[{key:"deserialize",value:function(t){var r=new e;return r.peerPubkey=se(t.readNextBytes()),r.address=Ct.deserialize(t),r.consensusPos=t.readLong(),r.freezePos=t.readLong(),r.newPos=t.readLong(),r.withdrawPos=t.readLong(),r.withdrawFreezePos=t.readLong(),r.withdrawUnfreezePos=t.readLong(),r}}]),e}(),xo=function(){function e(){Wi(this,e)}return ji(e,null,[{key:"deserialize",value:function(t){var r=new e,n=t.readNextBytes(),a=He.fromHexstr(n).value;r.candidateFee=Number(a);var i=He.fromHexstr(t.readNextBytes()).value;r.minInitState=Number(i);var o=He.fromHexstr(t.readNextBytes()).value,u=Number(o);r.candidateNum=u;var s=He.fromHexstr(t.readNextBytes()).value;r.posLimit=Number(s);var c=He.fromHexstr(t.readNextBytes()).value,l=Number(c),f=He.fromHexstr(t.readNextBytes()).value,h=Number(f),v=He.fromHexstr(t.readNextBytes()).value,d=Number(v),y=He.fromHexstr(t.readNextBytes()).value,p=Number(y);return r.A=l,r.B=h,r.yita=d,r.penalty=p,r}}]),e}(),Po=function(){function e(){Wi(this,e)}return ji(e,null,[{key:"deserialize",value:function(t){var r=new e;return r.address=Ct.deserialize(t),r.stake=t.readLong(),r.timeOffset=t.readUint32(),r}}]),e}(),Eo=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function To(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Oo=function(){function e(){To(this,e),this.states=[]}return Eo(e,[{key:"serialize",value:function(){var e="";e+=ve(this.states.length);for(var t=0;t<this.states.length;t++)e+=this.states[t].serialize();return e}}],[{key:"deserialize",value:function(t){for(var r=new e,n=[],a=t.readNextLen(),i=0;i<a;i++){var o=Io.deserialize(t);n.push(o)}return r.states=n,r}}]),e}(),No=function(){function e(){To(this,e)}return Eo(e,[{key:"serialize",value:function(){var e="";e+=this.contract,e+=ve(this.states.length);for(var t=0;t<this.states.length;t++)e+=this.states[t].serialize();return e}}],[{key:"deserialize",value:function(t){var r=new e;r.states=[];var n=t.read(20);r.contract=n;for(var a=t.readNextLen(),i=0;i<a;i++){var o=Io.deserialize(t);r.states.push(o)}return r}}]),e}(),Io=function(){function e(t,r,n){To(this,e);var a=new Q.BigNumber(n);if(!a.isInteger()||a.isNegative())throw g.INVALID_PARAMS;this.from=t,this.to=r,this.value=n}return Eo(e,null,[{key:"deserialize",value:function(t){return new e(new Ct(t.readNextBytes()),new Ct(t.readNextBytes()),He.fromHexstr(t.readNextBytes()).value.toString())}}]),Eo(e,[{key:"serialize",value:function(){var e="";return e+=ce(this.from.serialize()),e+=ce(this.to.serialize()),e+=ce(new He(this.value).toHexstr())}}]),e}(),Co=function(){function e(){To(this,e),this.version="00"}return Eo(e,null,[{key:"deserialize",value:function(t){var r=new e,n=t.read(1),a=Ct.deserialize(t),i=t.readNextBytes(),o=t.readNextBytes();return r.version=n,r.address=a,r.method=se(i),r.args=o,r}}]),Eo(e,[{key:"serialize",value:function(){var e="";return e+=this.version,e+=this.address.serialize(),e+=le(this.method),e+=ce(this.args)}}]),e}(),Bo=function(){function e(t,r,n,a){To(this,e);var i=new Q.BigNumber(a);if(!i.isInteger()||!i.isNegative())throw g.INVALID_PARAMS;this.sender=t,this.from=r,this.to=n,this.value=a}return Eo(e,null,[{key:"deserialize",value:function(t){return new e(new Ct(t.readNextBytes()),new Ct(t.readNextBytes()),new Ct(t.readNextBytes()),He.fromHexstr(t.readNextBytes()).value.toString())}}]),Eo(e,[{key:"serialize",value:function(){var e="";return e+=ce(this.sender.serialize()),e+=ce(this.from.serialize()),e+=ce(this.to.serialize()),e+=ce(new He(this.value).toHexstr())}}]),e}(),Do=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function _o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ho="init",zo="transfer",Uo="transferMulti",Lo="approve",Mo="transferFrom",Ko="allowance",Vo="balanceOf",Jo="totalSupply",Go="symbol",jo="decimals",Wo="name",Fo=function e(t,r,n){_o(this,e),this.from=t.serialize(),this.to=r.serialize(),this.amount=new Q.BigNumber(n)},qo=function(){function e(t){_o(this,e),this.contractAddr=t}return Do(e,[{key:"init",value:function(e,t,r){return Vr(Ho,[],this.contractAddr,e,t,r)}},{key:"makeTransferTx",value:function(e,t,r,n,a,i){var o=zo,u=new vt("from",lt.ByteArray,e.serialize()),s=new vt("to",lt.ByteArray,t.serialize()),c=new vt("value",lt.Long,r);return Vr(o,[u,s,c],this.contractAddr,n,a,i)}},{key:"makeTransferMultiTx",value:function(e,t,r,n){var a=[];a.push(ue(Uo));var i=[],o=!0,u=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;i.push([f.from,f.to,f.amount])}}catch(e){u=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(u)throw s}}a.push(i);var h=Tt(a);return Vr("",h,this.contractAddr,t,r,n)}},{key:"makeApproveTx",value:function(e,t,r,n,a,i){var o=Lo,u=[new vt("owner",lt.ByteArray,e.serialize()),new vt("spender",lt.ByteArray,t.serialize()),new vt("amount",lt.Long,r)];return Vr(o,u,this.contractAddr,n,a,i)}},{key:"makeTransferFromTx",value:function(e,t,r,n,a,i,o){var u=Mo,s=[new vt("owner",lt.ByteArray,e.serialize()),new vt("from",lt.ByteArray,t.serialize()),new vt("to",lt.ByteArray,r.serialize()),new vt("amount",lt.Long,n)];return Vr(u,s,this.contractAddr,a,i,o)}},{key:"makeQueryAllowanceTx",value:function(e,t){var r=Ko,n=[new vt("owner",lt.ByteArray,e.serialize()),new vt("spender",lt.ByteArray,t.serialize())];return Vr(r,n,this.contractAddr)}},{key:"queryBalanceOf",value:function(e){var t=Vo,r=new vt("from",lt.ByteArray,e.serialize());return Vr(t,[r],this.contractAddr)}},{key:"queryTotalSupply",value:function(){return Vr(Jo,[],this.contractAddr)}},{key:"queryDecimals",value:function(){return Vr(jo,[],this.contractAddr)}},{key:"querySymbol",value:function(){return Vr(Go,[],this.contractAddr)}},{key:"queryName",value:function(){return Vr(Wo,[],this.contractAddr)}}]),e}(),Yo=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Qo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Xo=function e(t,r){Qo(this,e),this.toAcct=t.serialize(),this.tokenId=r},Zo="init",$o="name",eu="symbol",tu="totalSupply",ru="balanceOf",nu="ownerOf",au="transfer",iu="transferMulti",ou="approve",uu="takeOwnership",su="queryTokenIDByIndex",cu="queryTokenByID",lu="getApproved",fu=function(){function e(t){Qo(this,e),this.contractAddr=t}return Yo(e,[{key:"makeInitTx",value:function(e,t,r){return Vr(Zo,[],this.contractAddr,e,t,r)}},{key:"makeOwnerOfTx",value:function(e){var t=nu,r=[new vt("tokenId",lt.ByteArray,e)];return Vr(t,r,this.contractAddr)}},{key:"makeTransferTx",value:function(e,t,r,n){var a=au,i=[new vt("toAcct",lt.ByteArray,e.toAcct),new vt("tokenId",lt.ByteArray,e.tokenId)];return Vr(a,i,this.contractAddr,t,r,n)}},{key:"makeTransferMultiTx",value:function(e,t,r,n){var a=[];a.push(ue(iu));var i=[],o=!0,u=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;i.push([f.toAcct,f.tokenId])}}catch(e){u=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(u)throw s}}a.push(i);var h=Tt(a);return Vr("",h,this.contractAddr,t,r,n)}},{key:"makeApproveTx",value:function(e,t,r,n){var a=ou,i=[new vt("toAcct",lt.ByteArray,e.toAcct),new vt("tokenId",lt.ByteArray,e.tokenId)];return Vr(a,i,this.contractAddr,t,r,n)}},{key:"makeTakeOwnershipTx",value:function(e,t,r,n){var a=uu,i=[new vt("toAcct",lt.ByteArray,e.toAcct),new vt("tokenId",lt.ByteArray,e.tokenId)];return Vr(a,i,this.contractAddr,t,r,n)}},{key:"makeQueryBalanceOfTx",value:function(e){var t=ru,r=[new vt("addr",lt.ByteArray,e.serialize())];return Vr(t,r,this.contractAddr)}},{key:"makeQueryTotalSupplyTx",value:function(){return Vr(tu,[],this.contractAddr)}},{key:"makeQueryTokenIDByIndexTx",value:function(e){var t=su,r=[new vt("index",lt.Long,e)];return Vr(t,r,this.contractAddr)}},{key:"makeQueryTokenByIDTx",value:function(e){var t=cu,r=[new vt("tokenId",lt.ByteArray,e)];return Vr(t,r,this.contractAddr)}},{key:"makeGetApprovedTx",value:function(e){var t=lu,r=[new vt("tokenId",lt.ByteArray,e)];return Vr(t,r,this.contractAddr)}},{key:"makeQueryNameTx",value:function(){return Vr($o,[],this.contractAddr)}},{key:"makeQuerySymbolTx",value:function(){return Vr(eu,[],this.contractAddr)}}]),e}();r.d(t,"Account",function(){return Xr}),r.d(t,"Identity",function(){return Wa}),r.d(t,"Claim",function(){return La}),r.d(t,"retrievePublicKeyState",function(){return Na}),r.d(t,"DDO",function(){return Ra}),r.d(t,"DDOAttribute",function(){return ka}),r.d(t,"Transaction",function(){return Br}),r.d(t,"Transfer",function(){return Dr}),r.d(t,"TxSignature",function(){return Nr}),r.d(t,"Parameter",function(){return vt}),r.d(t,"ParameterType",function(){return lt}),r.d(t,"AbiFunction",function(){return wr}),r.d(t,"AbiInfo",function(){return jn}),r.d(t,"TransactionBuilder",function(){return s}),r.d(t,"OntAssetTxBuilder",function(){return f}),r.d(t,"GovernanceTxBuilder",function(){return v}),r.d(t,"utils",function(){return a}),r.d(t,"scrypt",function(){return o}),r.d(t,"CONST",function(){return n}),r.d(t,"Wallet",function(){return Li}),r.d(t,"SDK",function(){return Gi}),r.d(t,"Token",function(){return d}),r.d(t,"OntidContract",function(){return c}),r.d(t,"RestClient",function(){return dn}),r.d(t,"RpcClient",function(){return si}),r.d(t,"WebsocketClient",function(){return Jn}),r.d(t,"Crypto",function(){return u}),r.d(t,"Struct",function(){return yt}),r.d(t,"ScriptBuilder",function(){return i}),r.d(t,"NeoCore",function(){return l}),r.d(t,"Oep4",function(){return y}),r.d(t,"Oep8",function(){return h}),r.d(t,"Oep5",function(){return p});var hu=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var vu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Account=Xr,this.Identity=Wa,this.Claim=La,this.DDO=Ra,this.DDOAttribute=ka,this.Transaction=Br,this.Transfer=Dr,this.TxSignature=Nr,this.TransactionBuilder=s,this.OntAssetTxBuilder=f,this.GovernanceTxBuilder=v,this.Parameter=vt,this.ParameterType=lt,this.AbiFunction=wr,this.AbiInfo=jn,this.utils=a,this.scrypt=o,this.CONST=n,this.Wallet=Li,this.SDK=Gi,this.Token=d,this.OntidContract=c,this.RestClient=dn,this.RpcClient=si,this.WebsocketClient=Jn,this.Crypto=u,this.Struct=yt,this.ScriptBuilder=i,this.NeoCore=l,this.Oep4=y,this.Oep8=h,this.Oep5=p}return hu(e,[{key:"setNode",value:function(e){this.CONST.TEST_NODE=e}},{key:"setRpcPort",value:function(e){this.CONST.HTTP_JSON_PORT=e}},{key:"setRestPort",value:function(e){this.CONST.HTTP_REST_PORT=e}},{key:"setSocketPort",value:function(e){this.CONST.HTTP_WS_PORT=e}}]),e}();t.default=vu}]);
//# sourceMappingURL=index.js.map