module.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=19)}([function(t,e){t.exports=require("crypto-js")},function(t,e){t.exports=require("axios")},function(t,e){t.exports=require("bignumber.js")},function(t,e){t.exports=require("bip39")},function(t,e){t.exports=require("base64-url")},function(t,e){t.exports=require("sm.js")},function(t,e){t.exports=require("elliptic")},function(t,e){t.exports=require("bs58")},function(t,e){t.exports=require("js-sha3")},function(t,e){t.exports=require("long")},function(t,e){t.exports=require("secure-random")},function(t,e){t.exports=require("@ont-community/hdkey-secp256r1")},function(t,e){t.exports=require("wif")},function(t,e){t.exports=require("crypto")},function(t,e){t.exports=require("scrypt-async")},function(t,e){t.exports=require("milagro-crypto-js")},function(t,e){t.exports=require("@ont-community/html5-websocket")},function(t,e){t.exports=require("websocket-as-promised")},function(t,e){t.exports=require("uuid")},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"ADDR_VERSION",function(){return S}),r.d(n,"DEFAULT_SCRYPT",function(){return w}),r.d(n,"OEP_HEADER",function(){return A}),r.d(n,"OEP_FLAG",function(){return T}),r.d(n,"WEBVIEW_SCHEME",function(){return E}),r.d(n,"DEFAULT_ALGORITHM",function(){return b}),r.d(n,"DEFAULT_SM2_ID",function(){return R}),r.d(n,"TEST_NODE",function(){return P}),r.d(n,"MAIN_NODE",function(){return N}),r.d(n,"HTTP_REST_PORT",function(){return I}),r.d(n,"HTTP_WS_PORT",function(){return x}),r.d(n,"HTTP_JSON_PORT",function(){return O}),r.d(n,"REST_API",function(){return B}),r.d(n,"ONT_NETWORK",function(){return v}),r.d(n,"TEST_ONT_URL",function(){return C}),r.d(n,"MAIN_ONT_URL",function(){return k}),r.d(n,"TOKEN_TYPE",function(){return D}),r.d(n,"DEFAULT_GAS_LIMIT",function(){return _}),r.d(n,"NATIVE_INVOKE_NAME",function(){return H}),r.d(n,"TX_MAX_SIG_SIZE",function(){return z}),r.d(n,"ONT_BIP44_PATH",function(){return U}),r.d(n,"UNBOUND_GENERATION_AMOUNT",function(){return M}),r.d(n,"UNBOUND_TIME_INTERVAL",function(){return L}),r.d(n,"ONT_TOTAL_SUPPLY",function(){return K}),r.d(n,"GENESIS_BLOCK_TIMESTAMP",function(){return V});var s={};r.r(s),r.d(s,"hexstring2ab",function(){return et}),r.d(s,"ab2hexstring",function(){return rt}),r.d(s,"ab2str",function(){return nt}),r.d(s,"str2ab",function(){return st}),r.d(s,"str2hexstr",function(){return it}),r.d(s,"hexstr2str",function(){return at}),r.d(s,"hex2VarBytes",function(){return ot}),r.d(s,"str2VarBytes",function(){return ct}),r.d(s,"bool2VarByte",function(){return ut}),r.d(s,"hexXor",function(){return lt}),r.d(s,"num2hexstring",function(){return ht}),r.d(s,"num2VarInt",function(){return dt}),r.d(s,"reverseHex",function(){return ft}),r.d(s,"bigIntFromBytes",function(){return pt}),r.d(s,"bigIntToBytes",function(){return gt}),r.d(s,"StringReader",function(){return yt}),r.d(s,"EventEmitter",function(){return mt}),r.d(s,"sendBackResult2Native",function(){return St}),r.d(s,"axiosPost",function(){return wt}),r.d(s,"now",function(){return At}),r.d(s,"sha256",function(){return Tt}),r.d(s,"ripemd160",function(){return Et}),r.d(s,"hash160",function(){return bt}),r.d(s,"generateRandomArray",function(){return Rt}),r.d(s,"randomBytes",function(){return Pt}),r.d(s,"generateMnemonic",function(){return Nt}),r.d(s,"parseMnemonic",function(){return It}),r.d(s,"varifyPositiveInt",function(){return xt}),r.d(s,"isBase64",function(){return Ot}),r.d(s,"isHexString",function(){return Bt}),r.d(s,"unboundDeadline",function(){return vt}),r.d(s,"calcUnboundOng",function(){return Ct});var i={};r.r(i),r.d(i,"pushBool",function(){return se}),r.d(i,"pushInt",function(){return ie}),r.d(i,"pushBigNum",function(){return ae}),r.d(i,"pushHexString",function(){return oe}),r.d(i,"getStructBytes",function(){return ce}),r.d(i,"getMapBytes",function(){return ue}),r.d(i,"pushMap",function(){return le}),r.d(i,"pushParam",function(){return he}),r.d(i,"serializeAbiFunction",function(){return de}),r.d(i,"convertArray",function(){return fe}),r.d(i,"convertMap",function(){return pe}),r.d(i,"deserializeItem",function(){return ge}),r.d(i,"createCodeParamsScript",function(){return ye}),r.d(i,"buildSmartContractParam",function(){return me}),r.d(i,"buildWasmContractParam",function(){return Se});var a={};r.r(a),r.d(a,"encryptWithCtr",function(){return Ne}),r.d(a,"decryptWithCtr",function(){return Ie}),r.d(a,"checkCtrDecrypted",function(){return xe}),r.d(a,"encryptWithEcb",function(){return Oe}),r.d(a,"decryptWithEcb",function(){return Be}),r.d(a,"checkEcbDecrypted",function(){return ve}),r.d(a,"encryptWithGcm",function(){return Ce}),r.d(a,"decryptWithGcm",function(){return ke});var o={};r.r(o),r.d(o,"Address",function(){return we}),r.d(o,"KeyType",function(){return _t}),r.d(o,"CurveLabel",function(){return Ht}),r.d(o,"SignatureScheme",function(){return Dt}),r.d(o,"KeyParameters",function(){return Lt}),r.d(o,"PrivateKey",function(){return ze}),r.d(o,"registerKeyDeserializer",function(){return Le}),r.d(o,"PublicKey",function(){return Vt}),r.d(o,"PublicKeyStatus",function(){return Jt}),r.d(o,"Signature",function(){return _e}),r.d(o,"Issuer",function(){return Je}),r.d(o,"User",function(){return Ge});var c={};r.r(c),r.d(c,"Default_params",function(){return cr}),r.d(c,"signTransaction",function(){return ur}),r.d(c,"signTransactionAsync",function(){return lr}),r.d(c,"addSign",function(){return hr}),r.d(c,"signTx",function(){return fr}),r.d(c,"makeNativeContractTx",function(){return pr}),r.d(c,"makeInvokeTransaction",function(){return gr}),r.d(c,"makeDeployCodeTransaction",function(){return yr}),r.d(c,"buildTxParam",function(){return mr}),r.d(c,"buildRpcParam",function(){return Sr}),r.d(c,"buildRestfulParam",function(){return wr}),r.d(c,"sendRawTxRestfulUrl",function(){return Ar});var u={};r.r(u),r.d(u,"ONTID_CONTRACT",function(){return Vr}),r.d(u,"buildRegisterOntidTx",function(){return Gr}),r.d(u,"buildRegIdWithAttributes",function(){return Wr}),r.d(u,"buildAddAttributeTx",function(){return Fr}),r.d(u,"buildRemoveAttributeTx",function(){return qr}),r.d(u,"buildGetAttributesTx",function(){return jr}),r.d(u,"buildGetDDOTx",function(){return $r}),r.d(u,"buildAddControlKeyTx",function(){return Qr}),r.d(u,"buildRemoveControlKeyTx",function(){return Yr}),r.d(u,"buildGetPublicKeysTx",function(){return Xr}),r.d(u,"buildAddRecoveryTx",function(){return Zr}),r.d(u,"buildChangeRecoveryTx",function(){return tn}),r.d(u,"buildGetPublicKeyStateTx",function(){return en});var l={};r.r(l),r.d(l,"InvocationTransaction",function(){return wn}),r.d(l,"NeoRpc",function(){return An}),r.d(l,"Program",function(){return Tn}),r.d(l,"SmartContract",function(){return En}),r.d(l,"TransactionInput",function(){return bn}),r.d(l,"TransactionOutput",function(){return Rn}),r.d(l,"TransactionNeo",function(){return Sn});var h={};r.r(h),r.d(h,"ONT_CONTRACT",function(){return Nn}),r.d(h,"ONG_CONTRACT",function(){return In}),r.d(h,"getTokenContract",function(){return xn}),r.d(h,"verifyAmount",function(){return On}),r.d(h,"makeTransferTx",function(){return Bn}),r.d(h,"makeWithdrawOngTx",function(){return vn}),r.d(h,"makeQueryAllowanceTx",function(){return Cn}),r.d(h,"makeQueryBalanceTx",function(){return kn}),r.d(h,"deserializeTransferTx",function(){return Dn});var d={};r.r(d),r.d(d,"Oep8State",function(){return _n}),r.d(d,"TransferFrom",function(){return Hn}),r.d(d,"Oep8TxBuilder",function(){return Un});var f={};r.r(f),r.d(f,"makeRegisterCandidateTx",function(){return Xn}),r.d(f,"makeUnregisterCandidateTx",function(){return Zn}),r.d(f,"makeApproveCandidateTx",function(){return ts}),r.d(f,"makeRejectCandidateTx",function(){return es}),r.d(f,"makeVoteForPeerTx",function(){return rs}),r.d(f,"makeUnvoteForPeerTx",function(){return ns}),r.d(f,"makeWithdrawTx",function(){return ss}),r.d(f,"makeQuitNodeTx",function(){return is}),r.d(f,"makeChangeAuthorizationTx",function(){return as}),r.d(f,"makeSetPeerCostTx",function(){return os}),r.d(f,"makeWithdrawFeeTx",function(){return cs}),r.d(f,"makeAuthorizeForPeerTx",function(){return us}),r.d(f,"makeUnauthorizeForPeerTx",function(){return ls}),r.d(f,"makeAddInitPosTx",function(){return hs}),r.d(f,"makeReduceInitPosTx",function(){return ds}),r.d(f,"makeWithdrawPeerUnboundOngTx",function(){return fs}),r.d(f,"getAttributes",function(){return ps}),r.d(f,"getSplitFeeAddress",function(){return gs}),r.d(f,"getAuthorizeInfo",function(){return ys}),r.d(f,"getGovernanceView",function(){return ms}),r.d(f,"getPeerPoolMap",function(){return Ss}),r.d(f,"getGlobalParam",function(){return ws}),r.d(f,"getTotalStake",function(){return As}),r.d(f,"getPeerUnboundOng",function(){return Ts}),r.d(f,"GovernanceView",function(){return Es}),r.d(f,"PeerPoolItem",function(){return bs}),r.d(f,"PeerAttributes",function(){return Rs}),r.d(f,"SplitFeeAddress",function(){return Ps}),r.d(f,"AuthorizeInfo",function(){return Ns}),r.d(f,"GlobalParam",function(){return Is}),r.d(f,"TotalStake",function(){return xs});var p={};r.r(p),r.d(p,"Transfers",function(){return Os}),r.d(p,"TokenTransfer",function(){return Bs}),r.d(p,"State",function(){return vs}),r.d(p,"Contract",function(){return Cs}),r.d(p,"TransferFrom",function(){return ks});var g={};r.r(g),r.d(g,"Oep4State",function(){return _s}),r.d(g,"Oep4TxBuilder",function(){return Hs});var y={};r.r(y),r.d(y,"Oep5Param",function(){return zs}),r.d(y,"Oep5TxBuilder",function(){return Ms});var m=r(3);const S="17",w={cost:4096,blockSize:8,parallel:8,size:64},A="0142",T="e0",E="Ont",b={algorithm:"ECDSA",parameters:{curve:"P-256"}},R="1234567812345678",P="polaris1.ont.io",N="dappnode1.ont.io",I="20334",x="20335",O="20336",B={getBalance:"/api/v1/balance",sendRawTx:"/api/v1/transaction",getMerkleProof:"/api/v1/merkleproof"},v={MAIN:"MainNet",TEST:"TestNet"},C={SOCKET_URL:`ws://${P}:${x}`,RPC_URL:`http://${P}:${O}`,REST_URL:`http://${P}:${I}`,sendRawTxByRestful:`http://${P}:${I}${B.sendRawTx}`},k={SOCKET_URL:`ws://${N}:${x}`,RPC_URL:`http://${N}:${O}/`,REST_URL:`http://${N}:${I}/`,sendRawTxByRestful:`http://${P}:${I}${B.sendRawTx}`},D={ONT:"ONT",ONG:"ONG"},_=3e4,H="Ontology.Native.Invoke",z=16,U="m/44'/1024'/0'/0/0",M=[5,4,3,3,2,2,2,1,1,1,1,1,1,1,1,1,1,1],L=31536e3,K=1e9,V=1530316800;var J,G,W=r(7),F=r(0);!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.SESSION_EXPIRED=41001]="SESSION_EXPIRED",t[t.SERVICE_CEILING=41002]="SERVICE_CEILING",t[t.ILLEGAL_DATAFORMAT=41003]="ILLEGAL_DATAFORMAT",t[t.INVALID_VERSION=41004]="INVALID_VERSION",t[t.INVALID_METHOD=42001]="INVALID_METHOD",t[t.INVALID_PARAMS=42002]="INVALID_PARAMS",t[t.INVALID_TRANSACTION=43001]="INVALID_TRANSACTION",t[t.INVALID_ASSET=43002]="INVALID_ASSET",t[t.INVALID_BLOCK=43003]="INVALID_BLOCK",t[t.UNKNOWN_TRANSACTION=44001]="UNKNOWN_TRANSACTION",t[t.UNKNOWN_ASSET=44002]="UNKNOWN_ASSET",t[t.UNKNOWN_BLOCK=44003]="UNKNOWN_BLOCK",t[t.UNKNWN_CONTRACT=44004]="UNKNWN_CONTRACT",t[t.INTERNAL_ERROR=45001]="INTERNAL_ERROR",t[t.SMARTCODE_ERROR=47001]="SMARTCODE_ERROR",t[t.UNKNOWN_ONTID=51e3]="UNKNOWN_ONTID",t[t.NETWORK_ERROR=52e3]="NETWORK_ERROR",t[t.Decrypto_ERROR=53e3]="Decrypto_ERROR",t[t.INVALID_ADDR=53001]="INVALID_ADDR",t[t.PreExec_ERROR=54e3]="PreExec_ERROR"}(J||(J={})),function(t){t[t.PUSH0=0]="PUSH0",t[t.PUSHF=0]="PUSHF",t[t.PUSHBYTES1=1]="PUSHBYTES1",t[t.PUSHBYTES75=75]="PUSHBYTES75",t[t.PUSHDATA1=76]="PUSHDATA1",t[t.PUSHDATA2=77]="PUSHDATA2",t[t.PUSHDATA4=78]="PUSHDATA4",t[t.PUSHM1=79]="PUSHM1",t[t.PUSH1=81]="PUSH1",t[t.PUSHT=81]="PUSHT",t[t.PUSH2=82]="PUSH2",t[t.PUSH3=83]="PUSH3",t[t.PUSH4=84]="PUSH4",t[t.PUSH5=85]="PUSH5",t[t.PUSH6=86]="PUSH6",t[t.PUSH7=87]="PUSH7",t[t.PUSH8=88]="PUSH8",t[t.PUSH9=89]="PUSH9",t[t.PUSH10=90]="PUSH10",t[t.PUSH11=91]="PUSH11",t[t.PUSH12=92]="PUSH12",t[t.PUSH13=93]="PUSH13",t[t.PUSH14=94]="PUSH14",t[t.PUSH15=95]="PUSH15",t[t.PUSH16=96]="PUSH16",t[t.NOP=97]="NOP",t[t.JMP=98]="JMP",t[t.JMPIF=99]="JMPIF",t[t.JMPIFNOT=100]="JMPIFNOT",t[t.CALL=101]="CALL",t[t.RET=102]="RET",t[t.APPCALL=103]="APPCALL",t[t.SYSCALL=104]="SYSCALL",t[t.TAILCALL=105]="TAILCALL",t[t.DUPFROMALTSTACK=106]="DUPFROMALTSTACK",t[t.TOALTSTACK=107]="TOALTSTACK",t[t.FROMALTSTACK=108]="FROMALTSTACK",t[t.XDROP=109]="XDROP",t[t.XSWAP=114]="XSWAP",t[t.XTUCK=115]="XTUCK",t[t.DEPTH=116]="DEPTH",t[t.DROP=117]="DROP",t[t.DUP=118]="DUP",t[t.NIP=119]="NIP",t[t.OVER=120]="OVER",t[t.PICK=121]="PICK",t[t.ROLL=122]="ROLL",t[t.ROT=123]="ROT",t[t.SWAP=124]="SWAP",t[t.TUCK=125]="TUCK",t[t.CAT=126]="CAT",t[t.SUBSTR=127]="SUBSTR",t[t.LEFT=128]="LEFT",t[t.RIGHT=129]="RIGHT",t[t.SIZE=130]="SIZE",t[t.INVERT=131]="INVERT",t[t.AND=132]="AND",t[t.OR=133]="OR",t[t.XOR=134]="XOR",t[t.EQUAL=135]="EQUAL",t[t.INC=139]="INC",t[t.DEC=140]="DEC",t[t.NEGATE=143]="NEGATE",t[t.ABS=144]="ABS",t[t.NOT=145]="NOT",t[t.NZ=146]="NZ",t[t.ADD=147]="ADD",t[t.SUB=148]="SUB",t[t.MUL=149]="MUL",t[t.DIV=150]="DIV",t[t.MOD=151]="MOD",t[t.SHL=152]="SHL",t[t.SHR=153]="SHR",t[t.BOOLAND=154]="BOOLAND",t[t.BOOLOR=155]="BOOLOR",t[t.NUMEQUAL=156]="NUMEQUAL",t[t.NUMNOTEQUAL=158]="NUMNOTEQUAL",t[t.LT=159]="LT",t[t.GT=160]="GT",t[t.LTE=161]="LTE",t[t.GTE=162]="GTE",t[t.MIN=163]="MIN",t[t.MAX=164]="MAX",t[t.WITHIN=165]="WITHIN",t[t.SHA1=167]="SHA1",t[t.SHA256=168]="SHA256",t[t.HASH160=169]="HASH160",t[t.HASH256=170]="HASH256",t[t.CHECKSIG=172]="CHECKSIG",t[t.CHECKMULTISIG=174]="CHECKMULTISIG",t[t.ARRAYSIZE=192]="ARRAYSIZE",t[t.PACK=193]="PACK",t[t.UNPACK=194]="UNPACK",t[t.PICKITEM=195]="PICKITEM",t[t.SETITEM=196]="SETITEM",t[t.NEWARRAY=197]="NEWARRAY",t[t.NEWSTRUCT=198]="NEWSTRUCT",t[t.NEWMAP=199]="NEWMAP",t[t.APPEND=200]="APPEND",t[t.REVERSE=201]="REVERSE",t[t.REMOVE=202]="REMOVE",t[t.HASKEY=203]="HASKEY",t[t.KEYS=204]="KEYS",t[t.VALUES=205]="VALUES",t[t.THROW=240]="THROW",t[t.THROWIFNOT=241]="THROWIFNOT"}(G||(G={}));var q=G,j=r(6),$=r(5),Q=r(2),Y=r(9),X=r(1),Z=r.n(X),tt=r(10);function et(t){const e=[];for(;t.length>=2;)e.push(parseInt(t.substring(0,2),16)),t=t.substring(2,t.length);return e}function rt(t){let e="";const r=new Uint8Array(t);for(let t=0;t<r.byteLength;t++){let n=r[t].toString(16);e+=n=0===n.length?"00":1===n.length?"0"+n:n}return e}function nt(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function st(t){const e=new ArrayBuffer(t.length),r=new Uint8Array(e);for(let e=0,n=t.length;e<n;e++)r[e]=t.charCodeAt(e);return e}function it(t){return rt(st(t))}function at(t){return nt(et(t))}function ot(t){let e="";return e+=dt(t.length/2),e+=t}function ct(t){let e="";const r=it(t);return e+=dt(r.length/2),e+=r}function ut(t){return t?"01":"00"}function lt(t,e){if(t.length!==e.length)throw new Error("strings are disparate lengths");if(t.length%2!=0)throw new Error("strings must be hex");const r=new ArrayBuffer(t.length/2),n=new Uint8Array(r);for(let r=0;r<t.length;r+=2)n[r/2]=parseInt(t.substr(r,2),16)^parseInt(e.substr(r,2),16);return rt(r)}const ht=(t,e=1,r=!1)=>{if(t<0)throw new RangeError("num must be >=0");if(e%1!=0)throw new Error("size must be a whole integer");if(!Number.isSafeInteger(t))throw new RangeError(`num (${t}) must be a safe integer`);e*=2;let n=t.toString(16);return n=n.length%e==0?n:("0".repeat(e)+n).substring(n.length),r&&(n=ft(n)),n},dt=t=>t<253?ht(t):t<=65535?"fd"+ht(t,2,!0):t<=4294967295?"fe"+ht(t,4,!0):"ff"+ht(t,8,!0),ft=t=>{if(t.length%2!=0)throw new Error(`Incorrect Length: ${t}`);let e="";for(let r=t.length-2;r>=0;r-=2)e+=t.substr(r,2);return e};function pt(t){const e=Buffer.from(t,"hex");let r=Array.from(e.subarray(0));return r[r.length-1]>>7==1&&(r=r.concat(Array(8-r.length).fill(255))),Y.fromBytesLE(r)}function gt(t){let e=t.toBytesLE();const r=t.neg().toBytesLE();let n,s=n=t.isNegative()?255:0,i=0;for(let a=e.length-1;a>=0;a--)if(e[a]!==n){s=t.isNegative()?r[a]:e[a],i=a+1;break}return e=e.slice(0,i),s>>7==1&&e.push(t.isNegative()?255:0),new Buffer(e).toString("hex")}class yt{constructor(t=""){if(t.length%2!=0)throw new Error("Param's length is not even.");this.str=t,this.pos=0,this.size=this.str.length/2}isEmpty(){return this.pos>=this.str.length}read(t){if(this.isEmpty())throw new Error("StringReader reached the end.");const e=this.str.substr(this.pos,2*t);return this.pos+=2*t,e}unreadBytes(t){if(this.pos-2*t<0)throw new Error("Can not unread too many bytes.");this.pos-=2*t}readNullTerminated(){const t=this.str.indexOf("00",this.pos);if(-1===t)throw new Error("No ending NULL found");const e=this.str.substring(this.pos,t);return this.pos=t+2,e}readNextBytes(){const t=this.readNextLen();return 0===t?"":this.read(t)}readNextLen(){let t=parseInt(this.read(1),16);return 253===t?t=parseInt(ft(this.read(2)),16):254===t?t=parseInt(ft(this.read(4)),16):255===t&&(t=parseInt(ft(this.read(8)),16)),t}readUint8(){return parseInt(ft(this.read(1)),16)}readUint16(){return parseInt(ft(this.read(2)),16)}readUint32(){return parseInt(ft(this.read(4)),16)}readInt(){return parseInt(ft(this.read(4)),16)}readLong(){return parseInt(ft(this.read(8)),16)}readBoolean(){return 0!==parseInt(this.read(1),16)}}class mt{constructor(){this.handlers={}}on(t,e){void 0===this.handlers[t]&&(this.handlers[t]=[]),this.handlers[t].push(e)}trigger(t,e){if(this.handlers[t]instanceof Array){const r=this.handlers[t];for(let t=0,n=r.length;t<n;t++)r[t](e)}}off(t){delete this.handlers[t]}}const St=(t,e)=>{window&&window.prompt&&window.prompt(`${E}://${e}?params=${t}`)},wt=(t,e)=>Z.a.post(t,e).then(t=>(console.log("axios res:"+t),t)).catch(t=>(console.log("axios res:"+JSON.stringify(t)),t));function At(){return Math.floor(Date.now()/1e3)}function Tt(t){const e=F.enc.Hex.parse(t);return F.SHA256(e).toString()}function Et(t){const e=F.enc.Hex.parse(t);return F.RIPEMD160(e).toString()}function bt(t){return Et(Tt(t))}function Rt(t){return tt(t)}function Pt(t){return rt(Rt(t))}function Nt(t=16){const e=rt(Rt(t));return m.entropyToMnemonic(e)}function It(t){return m.mnemonicToEntropy(t)}function xt(t){if(!/^[1-9]\d*$/.test(t.toString()))throw J.INVALID_PARAMS}function Ot(t){return Buffer.from(t,"base64").toString("base64")===t}function Bt(t){return/^[0-9a-fA-F]+$/.test(t)&&t.length%2==0}function vt(){let t=0;for(const e of M)t+=e;t*=L;const e=M.length;if(1!==M[e-1]||!(t-L<K&&K<=t))throw new Error("incompatible constants setting");return L*e-(t-K)}function Ct(t,e,r){let n=0;if(e>=r)return 0;const s=vt();if(e<s){let t=Math.floor(e/L),i=e%L;r>=s&&(r=s);const a=Math.floor(r/L),o=r%L;for(;t<a;)n+=(L-i)*M[t],t++,i=0;n+=(o-i)*M[t]}return n*t}class kt{static fromHexstr(t){t=ft(t);const e=new Q.BigNumber(t,16).toString();return new kt(e)}constructor(t){const e=new Q.BigNumber(t);if(!e.isInteger()||e.isNegative())throw J.INVALID_PARAMS;this.value=t}toHexstr(){return gt(Y.fromValue(this.value))}}class Dt{constructor(t,e,r){this.label=t,this.hex=e,this.labelJWS=r,Dt.values.push(this)}static fromHex(t){const e=Dt.values.find(e=>e.hex===t);if(void 0===e)throw new Error("Enum value not found");return e}static fromLabel(t){const e=Dt.values.find(e=>e.label===t);if(void 0===e)throw new Error("Enum value not found");return e}static fromLabelJWS(t){const e=Dt.values.find(e=>e.labelJWS===t);if(void 0===e)throw new Error("Enum value not found");return e}}Dt.values=[],Dt.ECDSAwithSHA224=new Dt("SHA224withECDSA",0,"ES224"),Dt.ECDSAwithSHA256=new Dt("SHA256withECDSA",1,"ES256"),Dt.ECDSAwithSHA384=new Dt("SHA384withECDSA",2,"ES384"),Dt.ECDSAwithSHA512=new Dt("SHA512withECDSA",3,"ES512"),Dt.ECDSAwithSHA3_224=new Dt("SHA3-224withECDSA",4,"ES3-224"),Dt.ECDSAwithSHA3_256=new Dt("SHA3-256withECDSA",5,"ES3-256"),Dt.ECDSAwithSHA3_384=new Dt("SHA3-384withECDSA",6,"ES3-384"),Dt.ECDSAwithSHA3_512=new Dt("SHA3-512withECDSA",7,"ES3-512"),Dt.ECDSAwithRIPEMD160=new Dt("RIPEMD160withECDSA",8,"ER160"),Dt.SM2withSM3=new Dt("SM3withSM2",9,"SM"),Dt.EDDSAwithSHA512=new Dt("SHA512withEdDSA",10,"EDS512");class _t{constructor(t,e,r){this.label=t,this.hex=e,this.defaultSchema=r,_t.values.push(this)}static fromHex(t){const e=_t.values.find(e=>e.hex===t);if(void 0===e)throw new Error("Enum value not found");return e}static fromLabel(t){const e=_t.values.find(e=>e.label===t);if(void 0===e)throw new Error("Enum value not found");return e}}_t.values=[],_t.ECDSA=new _t("ECDSA",18,Dt.ECDSAwithSHA256),_t.SM2=new _t("SM2",19,Dt.SM2withSM3),_t.EDDSA=new _t("EDDSA",20,Dt.EDDSAwithSHA512);class Ht{constructor(t,e,r){this.label=t,this.hex=e,this.preset=r,Ht.values.push(this)}static fromHex(t){const e=Ht.values.find(e=>e.hex===t);if(void 0===e)throw new Error("Enum value not found");return e}static fromLabel(t){const e=Ht.values.find(e=>e.label===t);if(void 0===e)throw new Error("Enum value not found");return e}}Ht.values=[],Ht.SECP224R1=new Ht("P-224",1,"p224"),Ht.SECP256R1=new Ht("P-256",2,"p256"),Ht.SECP384R1=new Ht("P-384",3,"p384"),Ht.SECP521R1=new Ht("P-521",4,"p521"),Ht.SM2P256V1=new Ht("sm2p256v1",20,"sm2p256v1"),Ht.ED25519=new Ht("ed25519",25,"ed25519");var zt,Ut,Mt=r(8);class Lt{static deserializeJson(t){return new Lt(Ht.fromLabel(t.curve))}constructor(t){this.curve=t}serializeJson(){return{curve:this.curve.label}}}class Kt{constructor(t,e,r){this.key=t,void 0===e&&(e=_t.fromLabel(b.algorithm)),void 0===r&&(r=Lt.deserializeJson(b.parameters)),this.algorithm=e,this.parameters=r}computeHash(t,e){switch(e){case Dt.ECDSAwithSHA224:return F.SHA224(F.enc.Hex.parse(t)).toString();case Dt.ECDSAwithSHA256:return F.SHA256(F.enc.Hex.parse(t)).toString();case Dt.ECDSAwithSHA384:return F.SHA384(F.enc.Hex.parse(t)).toString();case Dt.ECDSAwithSHA512:case Dt.EDDSAwithSHA512:return F.SHA512(F.enc.Hex.parse(t)).toString();case Dt.ECDSAwithSHA3_224:return Object(Mt.sha3_224)(et(t));case Dt.ECDSAwithSHA3_256:return Object(Mt.sha3_256)(et(t));case Dt.ECDSAwithSHA3_384:return Object(Mt.sha3_384)(et(t));case Dt.ECDSAwithSHA3_512:return Object(Mt.sha3_512)(et(t));case Dt.ECDSAwithRIPEMD160:return F.RIPEMD160(F.enc.Hex.parse(t)).toString();case Dt.SM2withSM3:return(new $.sm3).sum(et(t),"hex");default:throw new Error("Unsupported hash algorithm.")}}isSchemaSupported(t){switch(t){case Dt.ECDSAwithSHA224:case Dt.ECDSAwithSHA256:case Dt.ECDSAwithSHA384:case Dt.ECDSAwithSHA512:case Dt.ECDSAwithSHA3_224:case Dt.ECDSAwithSHA3_256:case Dt.ECDSAwithSHA3_384:case Dt.ECDSAwithSHA3_512:case Dt.ECDSAwithRIPEMD160:return this.algorithm===_t.ECDSA;case Dt.EDDSAwithSHA512:return this.algorithm===_t.EDDSA;case Dt.SM2withSM3:return this.algorithm===_t.SM2;default:throw new Error("Unsupported signature schema.")}}serializeJson(){return{algorithm:this.algorithm.label,parameters:this.parameters.serializeJson(),key:this.key}}}class Vt extends Kt{static deserializeHex(t,e=33){if(33===e){const e=_t.ECDSA,r=Ht.SECP256R1,n=t.read(33);return new Vt(n,e,new Lt(r))}{const r=parseInt(t.read(1),16),n=parseInt(t.read(1),16),s=t.read(e-2);return new Vt(s,_t.fromHex(r),new Lt(Ht.fromHex(n)))}}verify(t,e){if(!this.isSchemaSupported(e.algorithm))throw new Error("Signature schema does not match key type.");let r;return"string"!=typeof t&&(t=t.getSignContent()),r=e.algorithm===Dt.SM2withSM3?t:this.computeHash(t,e.algorithm),this.verifySignature(r,e.value,e.algorithm)}serializeHex(){let t="";switch(this.algorithm){case _t.ECDSA:t+=this.key;break;case _t.EDDSA:case _t.SM2:t+=ht(this.algorithm.hex),t+=ht(this.parameters.curve.hex),t+=this.key}return t}verifySignature(t,e,r){switch(r){case Dt.ECDSAwithSHA224:case Dt.ECDSAwithSHA256:case Dt.ECDSAwithSHA384:case Dt.ECDSAwithSHA512:case Dt.ECDSAwithSHA3_224:case Dt.ECDSAwithSHA3_256:case Dt.ECDSAwithSHA3_384:case Dt.ECDSAwithSHA3_512:case Dt.ECDSAwithRIPEMD160:return this.verifyEcDSASignature(t,e);case Dt.EDDSAwithSHA512:return this.verifyEdDSASignature(t,e);case Dt.SM2withSM3:return this.verifySM2Signature(t,e);default:throw new Error("Unsupported signature schema.")}}verifyEcDSASignature(t,e){const r=e.substr(0,64),n=e.substr(64,64);return new j.ec(this.parameters.curve.preset).verify(t,{r:r,s:n},this.key,"hex")}verifyEdDSASignature(t,e){const r=e.substr(0,64),n=e.substr(64,64);return new j.eddsa(this.parameters.curve.preset).verify(t,{r:r,s:n},this.key,"hex")}verifySM2Signature(t,e){const r=new yt(e),n=at(r.readNullTerminated());if(n!==R&&""!==n)throw new Error("Unsupported SM2 id used.");const s=r.read(32),i=r.read(32);return $.sm2.SM2KeyPair(this.key).verify(et(t),s,i)}}class Jt{constructor(t){this.label=t,Jt.values.push(this)}static fromHexLabel(t){const e=at(t),r=Jt.values.find(t=>t.label===e);if(void 0===r)throw new Error("Enum value not found");return r}}function Gt(t,e){if(t.algorithm!==e.algorithm)return t.algorithm.hex-e.algorithm.hex;switch(t.algorithm){case _t.ECDSA:const r=new j.ec(t.parameters.curve.preset),n=r.keyFromPublic(t.key,"hex",!0),s=r.keyFromPublic(e.key,"hex",!0),i=n.getPublic(),a=s.getPublic();return i.getX()!==a.getX()?i.getX()-a.getX():i.getY()-a.getY();case _t.SM2:const o=new $.sm2.SM2KeyPair,c=new $.sm2.SM2KeyPair;return o._pubFromString(t.key),c._pubFromString(e.key),o.getX().toString()!==c.getX().toString()?Number(o.getX().toString())-Number(c.getX().toString()):Number(o.getY().toString())-Number(c.getY().toString());case _t.EDDSA:return Number(t.key)-Number(e.key);default:return 0}}function Wt(t){return ht(t)}function Ft(t){return-1===t?ht(q.PUSHM1):0===t?ht(q.PUSH0):t>0&&t<=16?ht(q.PUSH1-1+t):ht(t,8,!0)}function qt(t){if(0===t)return Wt(q.PUSH0);if(t<=16)return ht(t-1+q.PUSH1);return jt(new kt(t.toString()).toHexstr())}function jt(t){let e="";if(0===t.length)throw new Error("pushBytes error, hexstr is empty.");const r=t.length/2;if(r<=q.PUSHBYTES75+1-q.PUSHBYTES1)e+=ht(r+q.PUSHBYTES1-1);else if(r<256)e+=ht(q.PUSHDATA1),e+=ht(r);else if(r<65536)e+=ht(q.PUSHDATA2),e+=ht(r,2,!0);else{if(!(r<4294967296))throw J.INVALID_PARAMS;e+=ht(q.PUSHDATA4),e+=ht(r,4,!0)}return e+=t}function $t(t){let e="";return e+=function(t){return jt(t.serializeHex())}(t),e+=Wt(q.CHECKSIG)}function Qt(t,e){const r=t.length;if(!(1<=e&&e<=r&&r<=1024))throw new Error("Wrong multi-sig param");t.sort(Gt);let n="";n+=qt(e);for(const e of t)n+=jt(e.serializeHex());return n+=qt(r),n+=Wt(q.CHECKMULTISIG)}function Yt(t){let e="";t.sort();for(const r of t)e+=jt(r);return e}function Xt(t){return parseInt(t.read(1),16)}function Zt(t){const e=Xt(t);let r;if(e===q.PUSHDATA4)r=t.readUint32();else if(e===q.PUSHDATA2)r=t.readUint16();else if(e===q.PUSHDATA1)r=t.readUint8();else{if(!(e<=q.PUSHBYTES75&&e>=q.PUSHBYTES1))throw new Error("unexpected opcode: "+e);r=e-q.PUSHBYTES1+1}return t.read(r)}function te(t){const e=t.readNextBytes();return Vt.deserializeHex(new yt(e))}Jt.values=[],Jt.IN_USE=new Jt("in use"),Jt.REVOKED=new Jt("revoked");class ee{}!function(t){t.Boolean="Boolean",t.Integer="Integer",t.ByteArray="ByteArray",t.Interface="Interface",t.Array="Array",t.Struct="Struct",t.Map="Map",t.String="String",t.Int="Int",t.Long="Long",t.IntArray="IntArray",t.LongArray="LongArray",t.Address="Address"}(zt||(zt={})),function(t){t[t.ByteArray=0]="ByteArray",t[t.Boolean=1]="Boolean",t[t.Integer=2]="Integer",t[t.Interface=64]="Interface",t[t.Array=128]="Array",t[t.Struct=129]="Struct",t[t.Map=130]="Map"}(Ut||(Ut={}));class re{constructor(t,e,r){this.name=t,this.type=e,this.value=r}getName(){return this.name}getType(){return this.type}getValue(){return this.value}setValue(t){return t.type===this.type&&t.name===this.name&&null!=t.value&&(this.value=t.value,!0)}}class ne{constructor(){this.list=[]}add(...t){for(const e of t)this.list.push(e)}}const se=t=>{let e="";return e+=ht(t?q.PUSHT:q.PUSHF)},ie=t=>{let e="";if(-1===t)e=ht(q.PUSHM1);else if(0===t)e=ht(q.PUSH0);else if(t>0&&t<16){const r=q.PUSH1-1+t;e=ht(r)}else{const r=new kt(t.toString()).toHexstr();e=oe(r)}return e},ae=t=>{let e="";if(t.isEqualTo(-1))e=ht(q.PUSHM1);else if(t.isEqualTo(0))e=ht(q.PUSH0);else if(t.isGreaterThan(0)&&t.isLessThan(16)){const r=q.PUSH1-1+t.toNumber();e=ht(r)}else{const r=new kt(t.toString()).toHexstr();e=oe(r)}return e},oe=t=>{let e="";const r=t.length/2;return r<=q.PUSHBYTES75?e+=ht(r):r<256?(e+=ht(q.PUSHDATA1),e+=ht(r)):r<65536?(e+=ht(q.PUSHDATA2),e+=ht(r,2,!0)):(e+=ht(q.PUSHDATA4),e+=ht(r,4,!0)),e+=t},ce=t=>{let e="";e+=ht(Ut.Struct),e+=ht(t.list.length);for(const r of t.list)if("string"==typeof r)e+=ht(Ut.ByteArray),e+=oe(r);else{if("number"!=typeof r)throw J.INVALID_PARAMS;e+=ht(Ut.ByteArray),e+=oe(dt(r))}return e},ue=t=>{let e="";e+=ht(Ut.Map),e+=ht(t.size);for(const r of t.keys()){e+=ht(Ut.ByteArray),e+=oe(it(r));const n=t.get(r);if(n&&n.getType()===zt.ByteArray)e+=ht(Ut.ByteArray),e+=oe(n.getValue());else if(n&&n.getType()===zt.String)e+=ht(Ut.ByteArray),e+=oe(it(n.getValue()));else if(n&&n.getType()===zt.Integer)e+=ht(Ut.Integer),e+=oe(dt(n.getValue()));else{if(!n||n.getType()!==zt.Long)throw J.INVALID_PARAMS;e+=ht(Ut.Integer),e+=oe(dt(n.getValue()))}}return e},le=t=>{let e="";e+=ht(q.NEWMAP),e+=ht(q.TOALTSTACK);for(const r of t.keys())e+=ht(q.DUPFROMALTSTACK),e+=oe(it(r)),e+=he(t.get(r)),e+=ht(q.SETITEM);return e+=ht(q.FROMALTSTACK)},he=t=>{if(!t)throw Error("Parameter can not be undefined");let e="";if(t.type===zt.ByteArray)e+=oe(t.value);else if(t.type===zt.String)e+=oe(it(t.value));else if(t.type===zt.Boolean)e+=se(Boolean(t.value)),e+=ht(q.PUSH0),e+=ht(q.BOOLOR);else if(t instanceof Map)e+=le(t);else if(t.type===zt.Array){for(let r=t.value.length-1;r>-1;r--)e+=he(t.value[r]);e+=ie(t.value.length),e+=ht(q.PACK)}else if(t.type===zt.Integer)e+=ie(t.value),e+=ht(q.PUSH0),e+=ht(q.ADD);else{if(t.type!==zt.Long)throw Error("Invalid parameter type: "+t.type);e+=ae(new Q.BigNumber(t.value)),e+=ht(q.PUSH0),e+=ht(q.ADD)}return e},de=t=>{const e=[];e.push(it(t.name));const r=[];for(const e of t.parameters)e.getType()===zt.String?r.push(it(e.getValue())):e.getType()===zt.Long?r.push(new Q.BigNumber(e.getValue())):e.getType()===zt.Map?r.push(pe(e)):r.push(e.getValue());return e.length>0&&e.push(r),ye(e)};function fe(t){const e=[];for(const r of t)r.getType&&r.getType()===zt.String?e.push(it(r.getValue())):r.getType&&r.getType()===zt.Long?e.push(new Q.BigNumber(r.getValue())):r.getType&&r.getType()===zt.Array?e.push(fe(r.value)):r.getType&&r.getType()===zt.Map?e.push(pe(r)):e.push(r.getValue?r.getValue():r);return e}function pe(t){const e=new Map;for(const r of Object.keys(t.value)){const n=t.value[r];n.type&&n.type===zt.Map?e.set(r,pe(n)):e.set(r,n)}return e}function ge(t){const e=parseInt(t.read(1),16);if(e===Ut.ByteArray)return t.readNextBytes();if(e===Ut.Boolean)return t.readBoolean();if(e===Ut.Integer){return pt(t.readNextBytes()).toNumber()}if(e===Ut.Array||e===Ut.Struct){const e=[];for(let r=t.readNextLen();r>0;r--){const r=ge(t);e.push(r)}return e}if(e===Ut.Map){const e=t.readNextLen(),r=new Map;for(let n=e;n>0;n--){const e=at(ge(t)),n=ge(t);r.set(e,n)}return r}throw Error("Invalid parameter type: "+e)}const ye=t=>{let e="";for(let r=t.length-1;r>=0;r--){const n=t[r];if("string"==typeof n)e+=oe(n);else if("number"==typeof n)e+=ie(n);else if("boolean"==typeof n)e+=se(n);else if(n instanceof Q.BigNumber)e+=ae(n);else if(n instanceof Map)e+=le(n);else if(n instanceof ne){const t=ce(n);e+=oe(t)}else n instanceof Array&&(e+=ye(fe(n)),e+=ie(n.length),e+=ht(q.PACK))}return e},me=(t,e)=>{let r="";for(let t=e.length-1;t>-1;t--){switch(e[t].getType()){case zt.Boolean:r+=se(e[t].getValue());break;case zt.Integer:r+=ie(e[t].getValue());break;case zt.String:const n=it(e[t].getValue());r+=oe(n);break;case zt.ByteArray:r+=oe(e[t].getValue());break;case zt.Map:const s=ue(e[t].getValue());r+=oe(s);break;case zt.Struct:const i=ce(e[t].getValue());r+=oe(i);break;default:throw new Error("Unsupported param type: "+JSON.stringify(e[t]))}}return r+=ie(e.length),r+=ht(q.PACK),r+=oe(it(t))},Se=t=>{const e=[];for(const r of t){let t;switch(r.getType()){case zt.String:t={type:"string",value:r.getValue()};break;case zt.Int:t={type:"int",value:r.getValue().toString()};break;case zt.Long:t={type:"int64",value:r.getValue()};break;case zt.IntArray:case zt.LongArray:t={type:"int_array",value:r.getValue()}}e.push(t)}const r={Params:e};return it(JSON.stringify(r))};class we{static deserialize(t){return new we(t.read(20))}static fromPubKey(t){const e=bt($t(t));return new we(e)}static fromOntid(t){const e=t.substr(8);return new we(e)}static fromVmCode(t){const e=bt(t);return new we(e)}static fromMultiPubKeys(t,e){const r=e.length;if(t<=0||t>r||r>24)throw J.INVALID_PARAMS;e.sort(Gt);let n="";n+=Ft(t);for(const t of e)n+=oe(t.serializeHex());n+=Ft(r);const s=bt(n+=ht(q.CHECKMULTISIG));return new we(s)}static generateOntid(t){return"did:ont:"+we.fromPubKey(t).toBase58()}constructor(t){if(40!==t.length&&34!==t.length)throw J.INVALID_PARAMS;this.value=t}toBase58(){return 34===this.value.length?this.value:Ae(this.value)}toHexString(){let t;return t=40===this.value.length?this.value:Te(this.value),ft(t)}serialize(){return 40===this.value.length?this.value:Te(this.value)}getB58Checksum(){const t=this.toBase58();return Tt(F.SHA256(t).toString()).slice(0,8)}}function Ae(t){const e=S+t,r=e+Tt(Tt(e)).slice(0,8);return W.encode(new Buffer(r,"hex"))}function Te(t){const e=rt(W.decode(t)).substr(2,40);if(t!==Ae(e))throw new Error("[addressToU160] decode encoded verify failed");return e}var Ee=r(12),be=r(13),Re=r(14);function Pe(t,e,r){let n=[];return Re(t.normalize("NFC"),et(e),{N:r.cost,r:r.blockSize,p:r.parallel,dkLen:r.size},t=>{n=t}),new Buffer(n)}function Ne(t,e,r,n=w){const s=Vt.deserializeHex(new yt(e)),i=Pe(r,we.fromPubKey(s).getB58Checksum(),n).toString("hex"),a=i.slice(0,32),o=i.slice(64),c=F.enc.Hex.parse(a),u=F.AES.encrypt(F.enc.Hex.parse(t),F.enc.Hex.parse(o),{mode:F.mode.CTR,padding:F.pad.NoPadding,iv:c}).ciphertext.toString();return new Buffer(u,"hex").toString("base64")}function Ie(t,e,r,n=w){const s=Buffer.from(t,"base64").toString("hex");let i="";if("string"==typeof r&&8===r.length)i=r;else{if(!(r instanceof we))throw J.INVALID_PARAMS;i=r.getB58Checksum()}const a=Pe(e,i,n).toString("hex"),o=a.slice(0,32),c=a.slice(64),u=F.enc.Hex.parse(o),l={ciphertext:F.enc.Hex.parse(s),salt:"",iv:""};return F.AES.decrypt(l,F.enc.Hex.parse(c),{mode:F.mode.CTR,padding:F.pad.NoPadding,iv:u}).toString()}function xe(t,e){let r="";if("string"==typeof t&&8===t.length)r=t;else{if(!(t instanceof we))throw J.INVALID_PARAMS;r=t.getB58Checksum()}const n=Vt.deserializeHex(new yt(e));if(we.fromPubKey(n).getB58Checksum()!==r)throw console.log("keyphrase error."),J.Decrypto_ERROR}function Oe(t,e,r,n=w){const s=Vt.deserializeHex(new yt(e)),i=we.fromPubKey(s).getB58Checksum(),a=Pe(r,i,n).toString("hex"),o=a.slice(0,64),c=a.slice(64),u=lt(t,o),l=F.AES.encrypt(F.enc.Hex.parse(u),F.enc.Hex.parse(c),{mode:F.mode.ECB,padding:F.pad.NoPadding}),h=A+T+i+l.ciphertext.toString();return W.encode(Buffer.from(h,"hex"))}function Be(t,e,r=w){const n=rt(W.decode(t)),s=n.substr(6,8),i=n.substr(-64),a=Pe(e,s,r).toString("hex"),o=a.slice(0,64),c=a.slice(64),u={ciphertext:F.enc.Hex.parse(i),salt:"",iv:""};return lt(F.AES.decrypt(u,F.enc.Hex.parse(c),{mode:F.mode.ECB,padding:F.pad.NoPadding}).toString(),o)}function ve(t,e,r){const n=rt(W.decode(t)).substr(6,8),s=Vt.deserializeHex(new yt(r));if(we.fromPubKey(s).getB58Checksum()!==n)throw console.log("keyphrase error."),J.Decrypto_ERROR}function Ce(t,e,r,n,s=w){if(!Bt(t))throw new Error(J.INVALID_PARAMS+", Invalid private key");const i=Pe(n,r,s),a=i.slice(0,12),o=i.slice(32),c=a,u=new Buffer(e.toBase58()),l=Object(be.createCipheriv)("aes-256-gcm",o,c);l.setAAD(u);const h=Buffer.from(t,"hex");let d=l.update(h);const f=l.final(),p=l.getAuthTag();return d=Buffer.concat([d,f]),Buffer.concat([d,p]).toString("base64")}function ke(t,e,r,n,s=w){if(32!==r.length)throw J.INVALID_PARAMS;const i=Buffer.from(t,"base64"),a=i.slice(0,i.length-16),o=i.slice(i.length-16),c=Pe(n,r,s),u=c.slice(0,12),l=c.slice(32),h=u,d=new Buffer(e.toBase58()),f=Object(be.createDecipheriv)("aes-256-gcm",l,h);f.setAAD(d),f.setAuthTag(o);let p=f.update(a).toString("hex");try{p+=f.final().toString("hex")}catch(t){throw J.Decrypto_ERROR}return p}var De=r(4);class _e{static deserializeJWT(t,e,r){const n=De.decode(t,"hex");return new _e(e,n,r)}static deserializePgp(t){const e=new Buffer(t.Value,"base64").toString("hex"),r=_e.deserializeHex(e).value;return new _e(Dt.fromLabel(t.Algorithm),r)}static deserializeHex(t){if(t.length<4)throw new Error("Invalid params.");const e=new yt(t),r=parseInt(e.read(1),16),n=Dt.fromHex(r),s=t.substr(2);return new _e(n,s)}constructor(t,e,r){this.algorithm=t,this.value=e,this.publicKeyId=r}serializeHex(){let t="";return t+=ht(this.algorithm.hex),t+=this.value}serializePgp(t){return{PublicKeyId:t,Format:"pgp",Value:new Buffer(this.serializeHex(),"hex").toString("base64"),Algorithm:this.algorithm.label}}serializeJWT(){return De.encode(this.value,"hex")}}const He=r(11);class ze extends Kt{static random(t,e){return void 0===t&&(t=_t.fromLabel(b.algorithm)),void 0===e&&(e=Lt.deserializeJson(b.parameters)),new ze(rt(tt(32)),t,e)}static deserializeWIF(t){const e=rt(Ee.decode(t,128).privateKey);return new ze(e)}static generateFromMnemonic(t,e=U){if(t.split(" ").length<12)throw J.INVALID_PARAMS;const r=m.mnemonicToSeedHex(t),n=He.fromMasterSeed(Buffer.from(r,"hex")).derive(e),s=Buffer.from(n.privateKey).toString("hex");return new ze(s)}sign(t,e,r){if(void 0===e&&(e=this.algorithm.defaultSchema),!this.isSchemaSupported(e))throw new Error("Signature schema does not match key type.");let n;"string"!=typeof t&&(t=t.getSignContent()),n=e===Dt.SM2withSM3?t:this.computeHash(t,e);const s=this.computeSignature(n,e);return new _e(e,s,r)}async signAsync(t,e,r){return this.sign(t,e,r)}getPublicKey(){switch(this.algorithm){case _t.ECDSA:return this.getEcDSAPublicKey();case _t.EDDSA:return this.getEdDSAPublicKey();case _t.SM2:return this.getSM2PublicKey();default:throw new Error("Unsupported signature schema.")}}decrypt(t,e,r,n){24===r.length&&Ot(r)&&(r=Buffer.from(r,"base64").toString("hex"));const s=ke(this.key,e,r,t,n),i=new ze(s,this.algorithm,this.parameters),a=i.getPublicKey();if(we.fromPubKey(a).toBase58()!==e.toBase58())throw J.Decrypto_ERROR;return i}encrypt(t,e,r,n){const s=this.getPublicKey();if(we.fromPubKey(s).toBase58()!==e.toBase58())throw J.INVALID_ADDR;const i=Ce(this.key,e,r,t,n);return new ze(i,this.algorithm,this.parameters)}getEcDSAPublicKey(){const t=new j.ec(this.parameters.curve.preset).keyFromPrivate(this.key,"hex").getPublic(!0,"hex");return new Vt(t,this.algorithm,this.parameters)}getEdDSAPublicKey(){const t=new j.eddsa(this.parameters.curve.preset).keyFromSecret(this.key,"hex").getPublic(!0,"hex");return new Vt(t,this.algorithm,this.parameters)}getSM2PublicKey(){const t=$.sm2.SM2KeyPair(null,this.key).pubToString("compress");return new Vt(t,this.algorithm,this.parameters)}computeSignature(t,e){switch(e){case Dt.ECDSAwithSHA224:case Dt.ECDSAwithSHA256:case Dt.ECDSAwithSHA384:case Dt.ECDSAwithSHA512:case Dt.ECDSAwithSHA3_224:case Dt.ECDSAwithSHA3_256:case Dt.ECDSAwithSHA3_384:case Dt.ECDSAwithSHA3_512:case Dt.ECDSAwithRIPEMD160:return this.computeEcDSASignature(t);case Dt.EDDSAwithSHA512:return this.computeEdDSASignature(t);case Dt.SM2withSM3:return this.computeSM2Signature(t);default:throw new Error("Unsupported signature schema.")}}computeEcDSASignature(t){const e=new j.ec(this.parameters.curve.preset).sign(t,this.key,{canonical:!0});return Buffer.concat([e.r.toArrayLike(Buffer,"be",32),e.s.toArrayLike(Buffer,"be",32)]).toString("hex")}computeEdDSASignature(t){const e=new j.eddsa(this.parameters.curve.preset).sign(t,this.key,null);return Buffer.concat([e.R.toArrayLike(Buffer,"be",32),e.S.toArrayLike(Buffer,"be",32)]).toString("hex")}computeSM2Signature(t){const e=$.sm2.SM2KeyPair(null,this.key).sign(et(t));return it(R+"\0")+e.r+e.s}serializeWIF(){return Ee.encode(128,Buffer.from(this.key,"hex"),!0)}}const Ue=[],Me=new class{getType(){return""}deserialize(t){if(null!=t.key)return new ze(t.key,_t.fromLabel(t.algorithm),Lt.deserializeJson(t.parameters));throw new Error("Unsupported Key type.")}};function Le(t){Ue.push(t)}function Ke(t){if(null==t.external)return Me.deserialize(t);for(const e of Ue)if(e.getType()===t.external.type)return e.deserialize(t);throw new Error("Unsupported Key type.")}var Ve=r(15);class Je{constructor(t){this.param=new We(t),this.sk=new qe(this.param)}GenerateSk(){return this.sk.Rand(),this.sk}GenerateKeyPair(){this.sk=qe.GenerateSk(this.param),this.pk=this.sk.GenerateIssuerPublicKey()}SetAttributeSet(t){this.AttributeName=t,this.pk.GenerateAttr(t)}Sign(t,e){const r=this.param.getRandBN(),n=this.param.getRandBN(),s=new this.param.ECP;s.copy(this.param.g1),s.add(this.param.PAIR.G1mul(this.pk.h0,n)),s.add(t);for(let t=0;t<this.pk.attr.length;t++)s.add(this.param.PAIR.G1mul(this.pk.h[t],e[t]));let i=new this.param.ECP;const a=new this.param.BIG;a.copy(r),a.add(this.sk.value),a.invmodp(this.param.order),i=this.param.PAIR.G1mul(s,a);const o=new $e(this.param);return o.Set(i,s,r,n,e),o}GetPk(){return je.COPY(this.pk)}GenerateNonce(){return this.param.getRandBN()}VerifyCredentialRequest(t){return this.pk.VerifyCredentialRequest(t)}}class Ge{constructor(t){this.param=new We(t)}GenerateSk(){return this.sk=qe.GenerateSk(this.param),this.sk}SetIpk(t){this.ipk=je.COPY(t)}GenerateCrendentialRequest(t){if(void 0===this.ipk)return void console.log("Please set ipk first.");const e=this.ipk,r=this.param.PAIR.G1mul(e.h_sk,this.sk.value),n=this.param.getRandBN(),s=this.param.PAIR.G1mul(e.h_sk,n),i=this.param.hashToBN(s,e.h_sk,r,t),a=this.param.BIG.modmul(i,this.sk.value,this.param.order);a.add(n),a.mod(this.param.order);const o={C:i,S:a},c=this.param.genAttrBN(e.attr);return this.Nym=r,this.attrs=c,{Nym:r,pi:o,nonce:t,attrs:c}}VerifyBBSplus(t){const e=new this.param.ECP2;e.copy(this.ipk.w),e.add(this.param.PAIR.G2mul(this.param.g2,t.sig.e)),e.affine();const r=new this.param.ECP;r.copy(t.sig.A),r.affine();let n=this.param.PAIR.ate(e,r);n=this.param.PAIR.fexp(n);const s=new this.param.ECP;s.copy(this.param.g1),s.add(this.param.PAIR.G1mul(this.ipk.h0,t.sig.s)),s.add(this.Nym);for(let e=0;e<t.attrs.length;e++)s.add(this.param.PAIR.G1mul(this.ipk.h[e],t.attrs[e]));s.affine();let i=this.param.PAIR.ate(this.param.g2,s);return i=this.param.PAIR.fexp(i),n.equals(i)}SetCredential(t){return this.Cred=new $e(this.param),this.Cred.Copy(t),!0}Prove(t){const e=this.ipk,r=this.Cred,n=this.param.getRandBN(),s=this.param.PAIR.G1mul(r.sig.A,n),i=new this.param.BIG(0);i.copy(n),i.invmodp(this.param.order);let a=new this.param.BIG(0);a.copy(r.sig.e),a=this.param.BIG.modneg(a,this.param.order);const o=this.param.PAIR.G1mul(s,a);o.add(this.param.PAIR.G1mul(r.sig.B,n));const c=this.param.getRandBN();let u=new this.param.BIG(0);u.copy(c),u=this.param.BIG.modneg(u,this.param.order);const l=this.param.PAIR.G1mul(r.sig.B,n);l.add(this.param.PAIR.G1mul(e.h0,u));let h=this.param.BIG.modmul(c,i,this.param.order);(h=this.param.BIG.modneg(h,this.param.order)).add(r.sig.s),h.mod(this.param.order);const d=[];for(let e=0;e<t.length;e++)0===t[e]?d[e]=this.param.getRandBN():d[e]=!1;const f=this.param.getRandBN(),p=this.param.getRandBN(),g=this.param.getRandBN(),y=this.param.getRandBN(),m=this.param.getRandBN(),S=this.param.PAIR.G1mul(e.h_sk,m),w=this.param.PAIR.G1mul(s,f);w.add(this.param.PAIR.G1mul(e.h0,p));const A=this.param.PAIR.G1mul(l,g);A.add(this.param.PAIR.G1mul(e.h0,y)),A.add(this.param.PAIR.G1mul(S,new this.param.BIG(-1)));for(let t=0;t<d.length;t++)!1!==d[t]&&A.add(this.param.PAIR.G1mul(e.h[t],d[t]));const T=this.param.hashToBN(s,o,l,this.Nym,w,A,this.param.g1,e.h0,e.h,e.w),E=this.param.getRandBN(),b=this.param.hashToBN(E,T,t,this.attrs),R=new this.param.BIG(0);R.copy(m),R.add(this.param.BIG.modmul(b,this.sk.value,this.param.order)),R.mod(this.param.order);const P=[];for(let e=0;e<t.length;e++)0===t[e]?(P[e]=new this.param.BIG(0),P[e].copy(d[e]),P[e].sub(this.param.BIG.modmul(b,this.attrs[e],this.param.order)),P[e].mod(this.param.order)):P[e]=!1;const N=new this.param.BIG(0);N.copy(f),N.sub(this.param.BIG.modmul(b,r.sig.e,this.param.order)),N.mod(this.param.order);const I=new this.param.BIG(0);I.copy(p),I.add(this.param.BIG.modmul(b,c,this.param.order)),I.mod(this.param.order);const x=new this.param.BIG(0);x.copy(g),x.add(this.param.BIG.modmul(b,i,this.param.order)),x.mod(this.param.order);const O=new this.param.BIG(0);O.copy(y),O.sub(this.param.BIG.modmul(b,h,this.param.order)),O.mod(this.param.order);const B={c:b,s_sk:R,s_a:P,s_e:N,s_r2:I,s_r3:x,s_s_:O,nonce:E};return{A_:s,_A:o,B_:l,Nym:this.Nym,pi:B}}Verify(t,e,r){const n=this.ipk,s=new this.param.ECP(0);if(t.A_.equals(s))return console.log("A' == O return true, verify failed."),!1;const i=new this.param.ECP;i.copy(t.A_);const a=new this.param.ECP2;a.copy(n.w);const o=new this.param.ECP;o.copy(t._A);const c=new this.param.ECP2;c.copy(this.param.g2),i.affine(),a.affine(),o.affine(),c.affine();let u=this.param.PAIR.ate(a,i),l=this.param.PAIR.ate(c,o);if(u=this.param.PAIR.fexp(u),l=this.param.PAIR.fexp(l),!u.equals(l))return console.log("e(A', w) == e(_A, g2) return false, verify failed."),!1;o.copy(t._A);const h=this.param.PAIR.G1mul(i,t.pi.s_e);h.add(this.param.PAIR.G1mul(n.h0,t.pi.s_r2)),o.sub(t.B_),h.add(this.param.PAIR.G1mul(o,this.param.BIG.modneg(t.pi.c,this.param.order)));const d=this.param.PAIR.G1mul(t.B_,t.pi.s_r3);d.add(this.param.PAIR.G1mul(n.h0,t.pi.s_s_)),d.add(this.param.PAIR.G1mul(n.h_sk,this.param.BIG.modneg(t.pi.s_sk,this.param.order)));const f=new this.param.ECP;f.copy(this.param.g1);for(let s=0;s<e.length;s++)0===e[s]?d.add(this.param.PAIR.G1mul(n.h[s],t.pi.s_a[s])):f.add(this.param.PAIR.G1mul(n.h[s],r[s]));d.add(this.param.PAIR.G1mul(f,this.param.BIG.modneg(t.pi.c,this.param.order)));const p=this.param.hashToBN(t.A_,t._A,t.B_,t.Nym,h,d,this.param.g1,n.h0,n.h,n.w),g=this.param.hashToBN(t.pi.nonce,p,e,r);return 0===this.param.BIG.comp(g,t.pi.c)||(console.log("c == H(nonce, H(A', _A, B', Nym, ~t1, ~t2, g1, HRand, h1, ... , hL, w), (D, I)) return false, verify failed."),!1)}}class We{constructor(t){this.curve=t,this.ctx=new Ve(t),this.PAIR=this.ctx.PAIR,this.ECP=this.ctx.ECP,this.ECP2=this.ctx.ECP2,this.BIG=this.ctx.BIG,this.rng=new this.ctx.RAND,this.g1=this.getG1Generator(),this.g2=this.getG2Generator(),this.order=this.getOrder()}getG1Generator(){const t=new this.ctx.ECP(0),e=new this.ctx.BIG(0),r=new this.ctx.BIG(0);return e.rcopy(this.ctx.ROM_CURVE.CURVE_Gx),r.rcopy(this.ctx.ROM_CURVE.CURVE_Gy),t.setxy(e,r),t}getG2Generator(){const t=new this.ctx.ECP2(0),e=new this.ctx.BIG(0),r=new this.ctx.BIG(0),n=new this.ctx.FP2(0),s=new this.ctx.FP2(0);return e.rcopy(this.ctx.ROM_CURVE.CURVE_Pxa),r.rcopy(this.ctx.ROM_CURVE.CURVE_Pxb),n.bset(e,r),e.rcopy(this.ctx.ROM_CURVE.CURVE_Pya),r.rcopy(this.ctx.ROM_CURVE.CURVE_Pyb),s.bset(e,r),t.setxy(n,s),t}getOrder(){const t=new this.ctx.BIG(0);return t.rcopy(this.ctx.ROM_CURVE.CURVE_Order),t}getRandBN(){const t=Rt(256);return this.rng.clean(),this.rng.seed(256,t),this.BIG.randomnum(this.order,this.rng)}getRandG1(){const t=this.getRandBN();return this.PAIR.G1mul(this.g1,t)}getRandG2(){const t=this.getRandBN();return this.PAIR.G2mul(this.g2,t)}hashToBN(...t){let e=[],r=[];t.forEach(t=>{Array.isArray(t)?"number"==typeof t[0]?(e=e.concat(t),r=[]):t.forEach(t=>{t.toBytes(r),e=e.concat(r),r=[]}):(t.toBytes(r),e=e.concat(r),r=[])});const n=new this.ctx.HASH256;n.process_array(e);const s=n.hash(),i=this.BIG.fromBytes(s);return i.mod(this.order),i}genAttrBN(t){const e=[];for(let r=0;r<t.length;r++){const t=this.getRandBN();e[r]=t}return e}genAttrElement(t){const e=[];for(let r=0;r<t.length;r++){const t=this.getRandG1();e[r]=t}return e}}class Fe{constructor(t){this.param=t}}class qe extends Fe{static GenerateSk(t){const e=t.getRandBN(),r=new qe(t);return r.setValue(e),r}constructor(t){super(t),this.value=new this.param.BIG(0)}setValue(t){this.value.copy(t)}GenerateIssuerPublicKey(){const t=this.value,e=this.param.PAIR.G2mul(this.param.g2,t);let r=this.param.getRandBN();const n=this.param.PAIR.G1mul(this.param.g1,r),s=this.param.PAIR.G1mul(n,t);r=this.param.getRandBN();const i=this.param.PAIR.G2mul(this.param.g2,r),a=this.param.PAIR.G1mul(n,r),o=this.param.hashToBN(i,a,this.param.g2,n,e,s),c=this.param.BIG.modmul(o,t,this.param.order);c.add(r),c.mod(this.param.order);const u={C:o,S:c},l=new je(this.param);return l.SetBasicValue(e,n,s,u),l}ToBytes(){return void 0===this.value?"":this.value.toBytes()}FromBytes(t){return this.value=this.param.BIG.fromBytes(t),this.value.toString()}Rand(){const t=this.param.getRandBN();this.setValue(t)}}class je extends Fe{static COPY(t){const e=new je(t.param);return e.SetBasicValue(t.w,t._g1,t._g2,t.pi),e.SetAttrValue(t.h0,t.h_sk,t.h,t.attr),e}constructor(t){super(t),this.w=new this.param.ECP2,this._g1=new this.param.ECP,this._g2=new this.param.ECP;const e=new this.param.BIG,r=new this.param.BIG;this.pi={C:e,S:r},this.h0=new this.param.ECP,this.h_sk=new this.param.ECP,this.attr=[]}SetBasicValue(t,e,r,n){this.w.copy(t),this._g1.copy(e),this._g2.copy(r),this.pi.C.copy(n.C),this.pi.S.copy(n.S)}SetAttrValue(t,e,r,n){this.h0.copy(t),this.h_sk.copy(e),this.h=[],this.attr=[];for(let t=0;t<r.length;t++)this.h[t]=new this.param.ECP,this.h[t].copy(r[t]);for(let t=0;t<n.length;t++)this.attr[t]=n[t]}GenerateAttr(t){const e=this.param.genAttrElement(t),r=this.param.getRandG1(),n=this.param.getRandG1(),s=[];e.forEach(t=>{s.push(t)}),this.h0=r,this.h_sk=n,this.h=s,this.attr=t}VerifyCredentialRequest(t){const e=new this.param.BIG(0);e.copy(t.pi.C);const r=this.param.PAIR.G1mul(this.h_sk,t.pi.S);r.add(this.param.PAIR.G1mul(t.Nym,this.param.BIG.modneg(e,this.param.order)));const n=this.param.hashToBN(r,this.h_sk,t.Nym,t.nonce);return 0===this.param.BIG.comp(t.pi.C,n)}}class $e extends Fe{constructor(t){super(t);const e=new this.param.ECP,r=new this.param.ECP,n=new this.param.BIG,s=new this.param.BIG;this.sig={A:e,B:r,e:n,s:s},this.attrs=[]}Set(t,e,r,n,s){this.sig.A.copy(t),this.sig.B.copy(e),this.sig.e.copy(r),this.sig.s.copy(n);for(let t=0;t<s.length;t++)this.attrs[t]=new this.param.BIG,this.attrs[t].copy(s[t])}Copy(t){this.Set(t.sig.A,t.sig.B,t.sig.e,t.sig.s,t.attrs)}}const Qe=8;class Ye{static deserialize(t){const e=new Ye;let r=t.read(8);for(r=ft(r);"00"===r.substr(0,2);)r=r.substring(2);return e.value=new Q.BigNumber(r,16).toString(),e}constructor(t){if(t&&t.length>16||t&&!/^[0-9]\d*$/.test(t))throw new Error("Invalid value."+t);this.value=t||"0000000000000000"}serialize(){let t=new Q.BigNumber(this.value).toString(16);const e=2*Qe;return t=t.length%e==0?t:("0".repeat(e)+t).substring(t.length),t=ft(t)}}class Xe{constructor(t,e,r){this.name=t,this.returntype=e,this.parameters=r}getParameter(t){for(const e of this.parameters)if(e.getName()===t)return e;return null}setParamsValue(...t){for(let e=0,r=t.length;e<r;e++)for(let r=0;r<this.parameters.length;r++)t[e].name===this.parameters[r].getName()&&this.parameters[r].setValue(t[e])}toString(){const t={name:this.name,returntype:this.returntype,parameters:this.parameters};return JSON.stringify(t)}}class Ze{}class tr extends Ze{serialize(){let t="";return t+=ot(this.code),t+=ut(this.needStorage),t+=ct(this.name),t+=ct(this.version),t+=ct(this.author),t+=ct(this.email),t+=ct(this.description)}deserialize(t){const e=t.readNextBytes();this.code=e;const r=t.read(1);this.needStorage="00"!==r;const n=t.readNextBytes();this.name=at(n);const s=t.readNextBytes();this.version=at(s);const i=t.readNextBytes();this.author=at(i);const a=t.readNextBytes();this.email=at(a);const o=t.readNextBytes();this.description=at(o)}}class er extends Ze{constructor(){super()}serialize(){let t="";return t+=ot(this.code)}deserialize(t){const e=t.readNextBytes();return this.code=e,this}}var rr,nr;!function(t){t[t.Nonce=0]="Nonce",t[t.Script=32]="Script",t[t.DescriptionUrl=129]="DescriptionUrl",t[t.Description=144]="Description"}(rr||(rr={}));class sr{serialize(){let t="";if(t+=ht(this.usage),this.usage===rr.Script)t+=this.data;else{if(this.usage!==rr.DescriptionUrl&&this.usage!==rr.Description&&this.usage!==rr.Nonce)throw J.INVALID_PARAMS;t+=ot(this.data)}return t}deserialize(t){const e=parseInt(t.read(1),16),r=t.readNextLen(),n=t.read(r);this.usage=e,this.data=n}}class ir{static deserialize(t){const e=new ir,r=t.readNextBytes(),n=t.readNextBytes(),s=function(t){const e=[],r=new yt(t);for(;!r.isEmpty();)e.push(Zt(r));return e}(r),i=function(t){const e=new ee,r=parseInt(t.substr(-2,2),16);if(r===q.CHECKSIG){const r=te(new yt(t));return e.M=1,e.pubKeys=[r],e}if(r===q.CHECKMULTISIG){const r=new yt(t),n=parseInt(r.read(1),16)-q.PUSH1+1,s=parseInt(t.substr(-4,2),16)-q.PUSH1+1;e.M=n,e.pubKeys=[];for(let t=0;t<s;t++){const t=te(r);e.pubKeys.push(t)}return e}throw new Error("Unsupported program.")}(n);return e.M=i.M,e.pubKeys=i.pubKeys,e.sigData=s,e}static create(t,e,r){const n=new ir;return n.M=1,n.pubKeys=[e.getPublicKey()],n.sigData=[e.sign(t,r).serializeHex()],n}static async createAsync(t,e,r){const n=new ir;return n.M=1,n.pubKeys=[e.getPublicKey()],n.sigData=[(await e.signAsync(t,r)).serializeHex()],n}serialize(){let t="";const e=Yt(this.sigData);let r="";if(0===this.pubKeys.length)throw new Error("No pubkeys in sig");return r=1===this.pubKeys.length?$t(this.pubKeys[0]):Qt(this.pubKeys,this.M),t+=ot(e),t+=ot(r)}}!function(t){t[t.BookKeeper=2]="BookKeeper",t[t.Claim=3]="Claim",t[t.Deploy=208]="Deploy",t[t.Invoke=209]="Invoke",t[t.Enrollment=4]="Enrollment",t[t.Vote=5]="Vote"}(nr||(nr={}));class ar{constructor(){this.type=209,this.version=0,this.txAttributes=[],this.sigs=[],this.nonce=rt(Rt(4)),this.gasPrice=new Ye,this.gasLimit=new Ye,this.payer=new we("0000000000000000000000000000000000000000")}static deserialize(t){const e=new ar,r=new yt(t);let n;switch(e.version=parseInt(r.read(1),16),e.type=parseInt(r.read(1),16),e.nonce=r.read(4),e.gasPrice=Ye.deserialize(r),e.gasLimit=Ye.deserialize(r),e.payer=new we(r.read(20)),e.type){case nr.Invoke:n=new er;break;case nr.Deploy:n=new tr;break;default:n=new er}n.deserialize(r),e.payload=n,e.txAttributes=[],e.sigs=[];const s=r.readNextLen();for(let t=0;t<s;t++){const t=new sr;t.deserialize(r),e.txAttributes.push(t)}const i=r.readNextLen();for(let t=0;t<i;t++)e.sigs.push(ir.deserialize(r));return e}serialize(){return this.serializeUnsignedData()+this.serializeSignedData()}serializeUnsignedData(){let t="";t+=ht(this.version),t+=ht(this.type),t+=this.nonce,t+=this.gasPrice.serialize(),t+=this.gasLimit.serialize(),t+=this.payer.serialize(),t+=this.payload.serialize(),t+=ht(this.txAttributes.length);for(let e=0;e<this.txAttributes.length;e++)t+=this.txAttributes[e].serialize();return t}serializeSignedData(){let t="";t+=ht(this.sigs.length);for(let e=0;e<this.sigs.length;e++)t+=this.sigs[e].serialize();return t}getSignContent(){const t=this.serializeUnsignedData(),e=F.enc.Hex.parse(t),r=F.SHA256(e).toString();return F.SHA256(F.enc.Hex.parse(r)).toString()}getHash(){return this.getSignContent()}}class or extends ar{}const cr={Action:"sendrawtransaction",Version:"1.0.0",Type:"",Op:"test"},ur=(t,e,r)=>{const n=ir.create(t,e,r);t.sigs=[n]},lr=async(t,e,r)=>{const n=await ir.createAsync(t,e,r);t.sigs=[n]},hr=(t,e,r)=>{const n=ir.create(t,e,r);t.sigs.push(n)},dr=(t,e)=>{if(t===e)return!0;if(t.sort(Gt),e.sort(Gt),t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r].key!==e[r].key)return!1;return!0},fr=(t,e,r,n,s)=>{if(0===t.sigs.length)t.sigs=[];else{if(t.sigs.length>z||e>r.length||e<=0||0===r.length)throw J.INVALID_PARAMS;for(let e=0;e<t.sigs.length;e++)if(dr(t.sigs[e].pubKeys,r)){if(t.sigs[e].sigData.length+1>r.length)throw new Error("Too many sigData");const i=n.sign(t,s).serializeHex();return void t.sigs[e].sigData.push(i)}}const i=new ir;i.M=e,i.pubKeys=r,i.sigData=[n.sign(t,s).serializeHex()],t.sigs.push(i)};function pr(t,e,r,n,s,i){let a="";a+=e,a+=oe(it(t)),a+=oe(r.serialize()),a+=ie(0),a+=ht(q.SYSCALL),a+=oe(it(H));const o=new er;let c;return o.code=a,(c="transfer"===t||"transferFrom"===t?new or:new ar).type=nr.Invoke,c.payload=o,s&&(c.gasLimit=new Ye(s)),n&&(c.gasPrice=new Ye(n)),i&&(c.payer=i),c}const gr=(t,e,r,n,s,i)=>{const a=new ar;a.type=nr.Invoke;let o="";if("string"==typeof e)o=e;else{const r=new Xe(t,"",e);o=de(r)}let c=o+ht(q.APPCALL);c+=r.serialize();const u=new er;return u.code=c,a.payload=u,s&&(a.gasLimit=new Ye(s)),n&&(a.gasPrice=new Ye(n)),i&&(a.payer=i),a};function yr(t,e="",r="1.0",n="",s="",i="",a=!0,o,c,u){const l=new tr;l.author=n,l.code=t,l.version=r,l.description=i,l.email=s,l.name=e,l.needStorage=a;const h=new ar;return h.version=0,h.payload=l,h.type=nr.Deploy,h.gasLimit=new Ye(c),h.gasPrice=new Ye(o),u&&(h.payer=u),h}function mr(t,e=!1){const r=e?{PreExec:"1"}:{},n=t.serialize();return JSON.stringify(Object.assign({},cr,{Data:n},r))}function Sr(t,e){const r=t.serialize();return{jsonrpc:"2.0",method:e||"sendrawtransaction",params:[r],id:10}}function wr(t){return{Action:"sendrawtransaction",Version:"1.0.0",Data:t.serialize()}}function Ar(t,e=!1){"/"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1));let r=t+B.sendRawTx;return e&&(r+="?preExec=1"),r}var Tr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};const Er=r(11);class br{constructor(){this["enc-alg"]="aes-256-gcm",this.hash="sha256"}static importAccount(t,e,r,n,s,i){const a=new br,o=Buffer.from(s,"base64").toString("hex"),c=e.decrypt(r,n,o,i);t||(t=rt(Rt(4))),a.label=t,a.lock=!1,a.isDefault=!1,a.salt=s,a.encryptedKey=e;const u=c.getPublicKey();return a.publicKey=u.key,a.address=we.fromPubKey(u),a}static importWithMnemonic(t,e,r,n){if(e=e.trim(),!m.validateMnemonic(e))throw J.INVALID_PARAMS;const s=m.mnemonicToSeedHex(e),i=Er.fromMasterSeed(Buffer.from(s,"hex")).derive(U),a=Buffer.from(i.privateKey).toString("hex"),o=new ze(a);return br.create(o,r,t,n)}static create(t,e,r,n){const s=new br;r||(r=rt(Rt(4))),s.label=r,s.lock=!1,s.isDefault=!1;const i=Pt(16),a=t.getPublicKey(),o=we.fromPubKey(a);return s.publicKey=a.serializeHex(),s.address=o,s.encryptedKey=t.encrypt(e,o,i,n),s.salt=Buffer.from(i,"hex").toString("base64"),s}static parseJson(t){return br.parseJsonObj(JSON.parse(t))}static parseJsonObj(t){const e=new br;return e.address=new we(t.address),e.label=t.label,e.lock=t.lock,e.isDefault=t.isDefault,e.publicKey=t.publicKey,e.hash=t.hash,e.salt=t.salt,e.encryptedKey=Ke({algorithm:t.algorithm,parameters:t.parameters,key:t.key,external:t.external}),e.extra=t.extra,e}toJson(){return JSON.stringify(this.toJsonObj())}toJsonObj(){return Tr({address:this.address.toBase58(),label:this.label,lock:this.lock},this.encryptedKey.serializeJson(),{"enc-alg":this["enc-alg"],hash:this.hash,salt:this.salt,isDefault:this.isDefault,publicKey:this.publicKey,signatureScheme:this.encryptedKey.algorithm.defaultSchema.label})}exportPrivateKey(t,e){return this.encryptedKey.decrypt(t,this.address,this.salt,e)}signTransaction(t,e,r){const n=this.exportPrivateKey(t,r);return ur(e,n,n.algorithm.defaultSchema),e}}var Rr={Url_send_transaction:"/api/v1/transaction",Url_get_transaction:"/api/v1/transaction/",Url_get_generate_block_time:"/api/v1/node/generateblocktime",Url_get_node_count:"/api/v1/node/connectioncount",Url_get_block_height:"/api/v1/block/height",Url_get_block_by_height:"/api/v1/block/details/height/",Url_get_block_by_hash:"/api/v1/block/details/hash/",Url_get_account_balance:"/api/v1/balance/",Url_get_contract_state:"/api/v1/contract/",Url_get_smartcodeevent_txs_by_height:"/api/v1/smartcode/event/transactions/",Url_get_smartcodeevent_by_txhash:"/api/v1/smartcode/event/txhash/",Url_get_block_height_by_txhash:"/api/v1/block/height/txhash/",Url_get_storage:"/api/v1/storage/",Url_get_merkleproof:"/api/v1/merkleproof/",Url_get_allowance:"/api/v1/allowance/"};class Pr{constructor(t){this.version="v1.0.0",this.action="sendrawtransaction",this.url=t||C.REST_URL,"/"===this.url[this.url.length-1]&&(this.url=this.url.substring(0,this.url.length-1))}concatParams(t){let e="";if(0===t.size)return"";for(const r of t.keys()){let n=t.get(r);n&&(n=encodeURIComponent(n)),e+=`&${r}=${n}`}return"?"+e.substr(1)}getUrl(){return this.url}sendRawTransaction(t,e=!1,r){const n=new Map;r&&n.set("userid",r),e&&n.set("preExec","1");let s=this.url+Rr.Url_send_transaction;s+=this.concatParams(n);const i={Action:this.action,Version:this.version,Data:t};return Z.a.post(s,i).then(t=>t.data)}getRawTransaction(t){const e=new Map;e.set("raw","1");let r=this.url+Rr.Url_get_transaction+t;return r+=this.concatParams(e),Z.a.get(r).then(t=>t.data)}getRawTransactionJson(t){const e=new Map;e.set("raw","0");let r=this.url+Rr.Url_get_transaction+t;return r+=this.concatParams(e),Z.a.get(r).then(t=>t.data)}getNodeCount(){const t=this.url+Rr.Url_get_node_count;return Z.a.get(t).then(t=>t.data)}getBlockHeight(){const t=this.url+Rr.Url_get_block_height;return Z.a.get(t).then(t=>t.data)}getBlock(t){const e=new Map;e.set("raw","1");let r="";return"number"==typeof t?r=this.url+Rr.Url_get_block_by_height+t:"string"==typeof t&&(r=this.url+Rr.Url_get_block_by_hash+t),r+=this.concatParams(e),Z.a.get(r).then(t=>t.data)}getContract(t){const e=new Map;e.set("raw","1");let r=this.url+Rr.Url_get_contract_state+t;return r+=this.concatParams(e),Z.a.get(r).then(t=>t.data)}getContractJson(t){const e=new Map;e.set("raw","0");let r=this.url+Rr.Url_get_contract_state+t;return r+=this.concatParams(e),Z.a.get(r).then(t=>t.data)}getSmartCodeEvent(t){let e="";return"string"==typeof t?e=this.url+Rr.Url_get_smartcodeevent_by_txhash+t:"number"==typeof t&&(e=this.url+Rr.Url_get_smartcodeevent_txs_by_height+t),Z.a.get(e).then(t=>t.data)}getBlockHeightByTxHash(t){const e=this.url+Rr.Url_get_block_height_by_txhash+t;return Z.a.get(e).then(t=>t.data)}getStorage(t,e){const r=this.url+Rr.Url_get_storage+t+"/"+e;return Z.a.get(r).then(t=>t.data)}getMerkleProof(t){const e=this.url+Rr.Url_get_merkleproof+t;return console.log("url: "+e),Z.a.get(e).then(t=>t.data)}getBalance(t){const e=this.url+Rr.Url_get_account_balance+t.toBase58();return Z.a.get(e).then(t=>t.data)}getBlockJson(t){let e="";return"number"==typeof t?e=this.url+Rr.Url_get_block_by_height+t:"string"==typeof t&&(e=this.url+Rr.Url_get_block_by_hash+t),Z.a.get(e).then(t=>t.data)}getAllowance(t,e,r){if("ont"!==(t=t.toLowerCase())&&"ong"!==t)throw J.INVALID_PARAMS;const n=this.url+Rr.Url_get_allowance+t.toLowerCase()+"/"+e.toBase58()+"/"+r.toBase58();return Z.a.get(n).then(t=>t.data)}}class Nr{constructor(){this.resolve=(t=>{this._resolve(t)}),this.reject=(t=>{this._reject(t)}),this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}get promise(){return this._promise}}var Ir=r(16),xr=r(17),Or=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};class Br{static generateReqId(){return Math.floor(1e9*Math.random())}constructor(t=C.SOCKET_URL,e=!1){this.debug=e,this.wsp=new xr(t,{createWebSocket:t=>new Ir(t),attachRequestId:(t,e)=>Or({Id:e},t),extractRequestId:t=>t&&t.Id,packMessage:t=>JSON.stringify(t),unpackMessage:t=>JSON.parse(t)}),this.wsp.onOpen.addListener(()=>{this.debug&&console.log("connected")}),this.wsp.onClose.addListener(()=>{this.debug&&console.log("disconnected")}),this.wsp.onSend.addListener(t=>{this.debug&&console.log("sent: ",t)}),this.wsp.onMessage.addListener(t=>{this.debug&&console.log("received: ",t)}),this.wsp.onError.addListener(t=>{this.debug&&console.log("error: ",t)})}async send(t,e=!0){try{if(!t)return;return await this.wsp.open(),await this.wsp.sendRequest(t,{requestId:Br.generateReqId()})}finally{e&&await this.wsp.close()}}addListener(t){this.wsp.onUnpackedMessage.addListener(t)}close(){this.wsp.close()}}class vr{constructor(t=C.SOCKET_URL,e=!1,r=!0){this.autoClose=r,this.promises=new Map,this.sender=new Br(t,e),this.sender.addListener(this.notifyListener.bind(this))}async sendHeartBeat(){const t={Action:"heartbeat",Version:"V1.0.0"};return this.send(t)}async sendSubscribe(t=!1,e=!1,r=!1,n=!1){const s=function(t=!1,e=!1,r=!1,n=!1){return{Action:"subscribe",Version:"1.0.0",SubscribeEvent:t,SubscribeJsonBlock:e,SubscribeRawBlock:r,SubscribeBlockTxHashs:n}}(t,e,r,n);return this.send(s)}async sendRawTransaction(t,e=!1,r=!1){const n=function(t,e=!1){let r={Action:"sendrawtransaction",Version:"1.0.0",Data:t};return e&&(r=Object.assign(r,{PreExec:"1"})),r}(t,e),s=await this.send(n,this.autoClose&&!r);if(0!==s.Error)throw console.log(s),new Error(JSON.stringify(s));if(r){const t=s.Result,e=new Nr;return this.promises.set(t,e),e.promise}return s}async getRawTransaction(t){const e=function(t){return{Action:"gettransaction",Version:"1.0.0",Hash:t,Raw:"1"}}(t);return this.send(e)}async getRawTransactionJson(t){const e=function(t){return{Action:"gettransaction",Version:"1.0.0",Hash:t,Raw:"0"}}(t);return this.send(e)}async getNodeCount(){const t={Action:"getconnectioncount",Version:"1.0.0"};return this.send(t)}async getBlockHeight(){const t={Action:"getblockheight",Version:"1.0.0"};return this.send(t)}async getBlock(t){const e=function(t){let e={};return"number"==typeof t?e={Action:"getblockbyheight",Version:"1.0.0",Height:t,Raw:"1"}:"string"==typeof t&&(e={Action:"getblockbyhash",Version:"1.0.0",Hash:t,Raw:"1"}),e}(t);return this.send(e)}async getBlockJson(t){const e=function(t){let e={};return"number"==typeof t?e={Action:"getblockbyheight",Version:"1.0.0",Height:t}:"string"==typeof t&&(e={Action:"getblockbyhash",Version:"1.0.0",Hash:t}),e}(t);return this.send(e)}async getBalance(t){const e=function(t){return{Action:"getbalance",Version:"1.0.0",Addr:t.toBase58()}}(t);return this.send(e)}async getUnboundong(t){const e=function(t){return{Action:"getunboundong",Version:"1.0.0",Addr:t.toBase58()}}(t);return this.send(e)}async getContract(t){const e=function(t){return{Action:"getcontract",Version:"1.0.0",Hash:t,Raw:"1"}}(t);return this.send(e)}async getContractJson(t){const e=function(t){return{Action:"getcontract",Version:"1.0.0",Hash:t,Raw:"0"}}(t);return this.send(e)}async getSmartCodeEvent(t){const e=function(t){let e={};return"number"==typeof t?e={Action:"getsmartcodeeventbyheight",Version:"1.0.0",Height:t}:"string"==typeof t&&(e={Action:"getsmartcodeeventbyhash",Version:"1.0.0",Hash:t}),e}(t);return this.send(e)}async getBlockHeightByTxHash(t){const e=function(t){return{Action:"getblockheightbytxhash",Version:"1.0.0",Hash:t}}(t);return this.send(e)}async getStorage(t,e){const r=function(t,e){return{Action:"getstorage",Version:"1.0.0",Hash:t,Key:e}}(t,e);return this.send(r)}async getMerkleProof(t){const e=function(t){return{Action:"getmerkleproof",Version:"1.0.0",Hash:t}}(t);return this.send(e)}async getAllowance(t,e,r){const n=function(t,e,r){return{Action:"getallowance",Version:"1.0.0",Asset:t,From:e.toBase58(),To:r.toBase58()}}(t,e,r);return this.send(n)}async getBlockHash(t){const e=function(t){return{Action:"getblockhash",Version:"1.0.0",Height:t}}(t);return this.send(e)}async getBlockTxsByHeight(t){const e=function(t){return{Action:"getblocktxsbyheight",Version:"1.0.0",Height:t}}(t);return this.send(e)}async getGasPrice(){const t={Action:"getgasprice",Version:"1.0.0"};return this.send(t)}async getGrantOng(t){const e=function(t){return{Action:"getgrantong",Version:"1.0.0",Addr:t.toBase58()}}(t);return this.send(e)}async getMempoolTxCount(){const t={Action:"getmempooltxcount",Version:"1.0.0"};return this.send(t)}async getMempoolTxState(t){const e=function(t){return{Action:"getmempooltxstate",Version:"1.0.0",Hash:t}}(t);return this.send(e)}async getVersion(){const t={Action:"getversion",Version:"1.0.0"};return this.send(t)}async getNetworkId(){const t={Action:"getnetworkid",Version:"1.0.0"};return this.send(t)}addNotifyListener(t){this.sender.addListener(e=>{"Notify"===e.Action&&t(e)})}close(){this.sender.close()}async send(t,e=this.autoClose){return this.sender.send(t,e)}notifyListener(t){if("Notify"===t.Action){const e=t.Result.TxHash;if(void 0!==e){const r=this.promises.get(e);void 0!==r?(this.promises.delete(e),r.resolve(t)):console.warn("Received Notify event for unknown transaction"),this.autoClose&&this.sender.close()}}}}class Cr{constructor(){this.functions=[]}static parseJson(t){const e=new Cr,r=JSON.parse(t);return e.hash=r.hash,e.entrypoint=r.entrypoint,e.functions=r.functions,e}getHash(){return this.hash}getEntryPoint(){return this.entrypoint}getFunction(t){for(const e of this.functions)if(e.name===t){const t=e.parameters.map(t=>new re(t.name,t.type,""));return new Xe(e.name,e.returntype,t)}throw Error("not found")}}const kr=Cr.parseJson(JSON.stringify({hash:"36bb5c053b6b839c8f6b923fe852f91239b9fccc",entrypoint:"Main",functions:[{name:"Main",parameters:[{name:"operation",type:"String"},{name:"args",type:"Array"}],returntype:"Any"},{name:"Commit",parameters:[{name:"claimId",type:"ByteArray"},{name:"commiterId",type:"ByteArray"},{name:"ownerId",type:"ByteArray"}],returntype:"Boolean"},{name:"Revoke",parameters:[{name:"claimId",type:"ByteArray"},{name:"ontId",type:"ByteArray"}],returntype:"Boolean"},{name:"GetStatus",parameters:[{name:"claimId",type:"ByteArray"}],returntype:"ByteArray"}],events:[{name:"ErrorMsg",parameters:[{name:"arg1",type:"ByteArray"},{name:"arg2",type:"String"}],returntype:"Void"},{name:"Push",parameters:[{name:"arg1",type:"ByteArray"},{name:"arg2",type:"String"},{name:"arg3",type:"ByteArray"}],returntype:"Void"}]})),Dr=kr.getHash().replace("0x",""),_r=new we(ft(Dr));class Hr{constructor(){this.Action="Notify"}static deserialize(t){const e=new Hr;return e.Action=t.Action,e.Error=t.Error,e.Desc=t.Desc,e.Result=zr.deserialize(t.Result),e}}class zr{static deserialize(t){const e=new zr;return e.TxHash=t.TxHash,e.State=t.State,e.GasConsumed=t.GasConsumed,e.Notify=t.Notify.map(t=>({ContractAddress:t.ContractAddress,States:t.States.map(t=>"string"==typeof t?at(t):t)})),e.Version=t.Version,e}}var Ur=r(18);function Mr(t){let e="";if("string"==typeof t)e+=oe(t);else if("boolean"==typeof t)e+=se(t);else if("number"==typeof t)e+=ie(t);else if(t instanceof Q.BigNumber)e+=ae(t);else if(t instanceof we)e+=oe(t.serialize());else if(t instanceof ne)for(const r of t.list)e+=Mr(r),e+=ht(q.DUPFROMALTSTACK),e+=ht(q.SWAP),e+=ht(q.APPEND);return e}function Lr(t){let e="";for(let r=t.length-1;r>=0;r--){const n=t[r];if("string"==typeof n)e+=oe(n);else if("boolean"==typeof n)e+=se(n);else if("number"==typeof n)e+=ie(n);else if(n instanceof Q.BigNumber)e+=ae(n);else if(n instanceof we)e+=oe(n.serialize());else if(n instanceof ne){e+=ie(0),e+=ht(q.NEWSTRUCT),e+=ht(q.TOALTSTACK);for(const t of n.list)e+=Mr(t),e+=ht(q.DUPFROMALTSTACK),e+=ht(q.SWAP),e+=ht(q.APPEND);e+=ht(q.FROMALTSTACK)}else if(Array.isArray(n)&&Kr(n,ne)){e+=ie(0),e+=ht(q.NEWSTRUCT),e+=ht(q.TOALTSTACK);for(const t of n)e+=Mr(t);e+=ht(q.FROMALTSTACK),e+=ie(n.length),e+=ht(q.PACK)}else Array.isArray(n)&&(e+=Lr(n),e+=ie(n.length),e+=ht(q.PACK))}return e}function Kr(t,e){let r=!0;for(const n of t)if(!(n instanceof e)){r=!1;break}return r}const Vr="0000000000000000000000000000000000000003",Jr={regIDWithPublicKey:"regIDWithPublicKey",regIDWithAttributes:"regIDWithAttributes",addAttributes:"addAttributes",removeAttribute:"removeAttribute",getAttributes:"getAttributes",getDDO:"getDDO",addKey:"addKey",removeKey:"removeKey",getPublicKeys:"getPublicKeys",addRecovery:"addRecovery",changeRecovery:"changeRecovery",getKeyState:"getKeyState"};function Gr(t,e,r,n,s){const i=Jr.regIDWithPublicKey;"did"===t.substr(0,3)&&(t=it(t));const a=new ne;return a.add(t,e.serializeHex()),pr(i,Lr([a]),new we(Vr),r,n,s)}function Wr(t,e,r,n,s,i){const a=Jr.regIDWithAttributes;"did"===t.substr(0,3)&&(t=it(t));const o=e.length,c=new ne;c.add(t,r.serializeHex(),o);for(const t of e){const e=it(t.key),r=it(t.type),n=it(t.value);c.add(e,r,n)}return pr(a,Lr([c]),new we(Vr),n,s,i)}function Fr(t,e,r,n,s,i){const a=Jr.addAttributes;"did"===t.substr(0,3)&&(t=it(t));const o=new ne;o.add(t,e.length);for(const t of e){const e=it(t.key),r=it(t.type),n=it(t.value);o.add(e,r,n)}return o.list.push(r.serializeHex()),pr(a,Lr([o]),new we(Vr),n,s,i)}function qr(t,e,r,n,s,i){const a=Jr.removeAttribute;"did"===t.substr(0,3)&&(t=it(t));const o=new ne;return o.add(t,it(e),r.serializeHex()),pr(a,Lr([o]),new we(Vr),n,s,i)}function jr(t){const e=Jr.getAttributes;"did"===t.substr(0,3)&&(t=it(t));const r=new ne;return r.add(t),pr(e,Lr([r]),new we(Vr))}function $r(t){const e=Jr.getDDO;"did"===t.substr(0,3)&&(t=it(t));const r=new ne;return r.add(t),pr(e,Lr([r]),new we(Vr))}function Qr(t,e,r,n,s,i){const a=Jr.addKey;"did"===t.substr(0,3)&&(t=it(t));const o=t,c=e.serializeHex();let u;r instanceof Vt?u=r.serializeHex():r instanceof we&&(u=r.serialize());const l=new ne;return l.add(o,c,u),pr(a,Lr([l]),new we(Vr),n,s,i)}function Yr(t,e,r,n,s,i){const a=Jr.removeKey;"did"===t.substr(0,3)&&(t=it(t));const o=t,c=e.serializeHex();let u;r instanceof Vt?u=r.serializeHex():r instanceof we&&(u=r.serialize());const l=new ne;return l.add(o,c,u),pr(a,Lr([l]),new we(Vr),n,s,i)}function Xr(t){const e=Jr.getPublicKeys;"did"===t.substr(0,3)&&(t=it(t));const r=new ne;return r.add(t),pr(e,Lr([r]),new we(Vr))}function Zr(t,e,r,n,s,i){const a=Jr.addRecovery;"did"===t.substr(0,3)&&(t=it(t));const o=t,c=e,u=r.serializeHex(),l=new ne;return l.add(o,c,u),pr(a,Lr([l]),new we(Vr),n,s,i)}function tn(t,e,r,n,s,i){const a=Jr.changeRecovery;"did"===t.substr(0,3)&&(t=it(t));const o=t,c=e,u=r,l=new ne;l.add(o,c,u);const h=pr(a,Lr([l]),new we(Vr),n,s);return h.payer=i||r,h}function en(t,e){const r=Jr.getKeyState;"did"===t.substr(0,3)&&(t=it(t)),console.log("did: "+t);const n=ht(e,4,!0);console.log("index: "+n);const s=new ne;return s.add(t,e),pr(r,Lr([s]),new we(Vr))}class rn{static deserialize(t){const e=new yt(t),r=[];for(;!e.isEmpty();){const t=e.readUint32(),n=e.readNextBytes(),s=new rn;s.id=t,s.pk=Vt.deserializeHex(new yt(n)),r.push(s)}return r}}class nn{static deserialize(t){const e=new yt(t),r=[];for(;!e.isEmpty();){const t=at(e.readNextBytes()),n=at(e.readNextBytes()),s=at(e.readNextBytes()),i=new nn;i.key=t,i.type=n,i.value=s,r.push(i)}return r}serialize(){let t="";return t+=ct(this.key),t+=ct(this.type),t+=ct(this.value)}}class sn{constructor(){this.publicKeys=[],this.attributes=[],this.recovery=""}static deserialize(t){const e=new yt(t),r=new sn,n=e.readNextLen();n>0&&(r.publicKeys=rn.deserialize(e.read(n)));const s=e.readNextLen();s>0&&(r.attributes=nn.deserialize(e.read(s)));const i=e.readNextLen();return i>0&&(r.recovery=e.read(i)),r}}var an,on,cn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};class un{static deserializeInternal(t,e){const r=t.split(".",3);if(r.length<2)throw new Error("Invalid message.");const n=un.deserializeHeader(r[0]),s=un.deserializePayload(r[1]);let i;if(r.length>2){if(void 0===n.algorithm||void 0===n.publicKeyId)throw new Error("Signature scheme was not specified.");i=_e.deserializeJWT(r[2],n.algorithm,n.publicKeyId)}const a=e(s.metadata,i);return a.payloadFromJSON(s.rest),a}static deserializePayload(t){const e=De.decode(t),r=JSON.parse(e),{jti:n,iss:s,sub:i,iat:a,exp:o}=r;return{metadata:{messageId:n,issuer:s,subject:i,issuedAt:a,expireAt:o},rest:function(t,e){var r={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}(r,["jti","iss","sub","iat","exp"])}}static deserializeHeader(t){const e=De.decode(t),r=JSON.parse(e);return{algorithm:void 0!==r.alg?Dt.fromLabelJWS(r.alg):void 0,publicKeyId:r.kid}}constructor(t,e){this.metadata=t,this.signature=e,void 0===this.metadata.messageId&&(this.metadata.messageId=Ur())}async sign(t,e,r,n){await ln(e,t),void 0===n&&(n=r.algorithm.defaultSchema);const s=this.serializeUnsigned(n,e);this.signature=await r.signAsync(s,n,e)}async verify(t){const e=this.signature;if(void 0===e||void 0===e.publicKeyId)return!1;try{if(!this.verifyKeyOwnership())return!1;if(!this.verifyExpiration())return!1;if(await async function(t,e){const r=hn(t),n=dn(t),s=new Pr(e),i=en(r,n),a=await s.sendRawTransaction(i.serialize(),!0);if(a.Result&&a.Result.Result)return Jt.fromHexLabel(a.Result.Result);throw new Error("Not found")}(e.publicKeyId,t)===Jt.REVOKED)return!1;const r=await ln(e.publicKeyId,t),n=this.serializeUnsigned(e.algorithm,e.publicKeyId);return r.verify(n,e)}catch(t){return!1}}serializeUnsigned(t,e){return this.serializeHeader(t,e)+"."+this.serializePayload()}serialize(){const t=this.signature;if(void 0!==t){const e=t.serializeJWT();return this.serializeUnsigned(t.algorithm,t.publicKeyId)+"."+e}return this.serializeUnsigned()}serializeHeader(t,e){let r;r=void 0!==t?{alg:t.labelJWS,typ:"JWT",kid:e}:{typ:"JWT"};const n=JSON.stringify(r);return De.encode(n,"utf-8")}verifyExpiration(){return void 0===this.metadata.expireAt||At()<this.metadata.expireAt}verifyKeyOwnership(){const t=this.signature;if(void 0!==t&&void 0!==t.publicKeyId){return hn(t.publicKeyId)===this.metadata.issuer}return!1}serializePayload(){const t={jti:this.metadata.messageId,iss:this.metadata.issuer,sub:this.metadata.subject,iat:this.metadata.issuedAt,exp:this.metadata.expireAt},e=this.payloadToJSON(),r=JSON.stringify(cn({},t,e));return De.encode(r,"utf-8")}}async function ln(t,e){const r=hn(t),n=dn(t),s=new Pr(e),i=$r(r),a=await s.sendRawTransaction(i.serialize(),!0);if(a.Result&&a.Result.Result){const t=sn.deserialize(a.Result.Result).publicKeys.find(t=>t.id===n);if(void 0===t)throw new Error("Not found");return t.pk}throw new Error("Not found")}function hn(t){const e=t.indexOf("#keys-");if(-1===e)throw new Error("Is not a publicKeId.");return t.substr(0,e)}function dn(t){const e=t.indexOf("#keys-");if(-1===e)throw new Error("Is not a publicKeId.");return Number(t.substr(e+"#keys-".length))}!function(t){t.AttestContract="AttestContract",t.RevocationList="RevocationList"}(an||(an={}));class fn extends un{static deserialize(t){return super.deserializeInternal(t,(t,e)=>new fn(t,e))}constructor(t,e,r){super(t,e),this.useProof=!0===r}async verify(t,e=!0){const r=await super.verify(t);return r&&e?this.getStatus(t):r}serialize(){if(this.useProof){return super.serialize()+"."+this.serializeProof()}return super.serialize()}async attest(t,e,r,n,s){const i=this.metadata.issuer,a=this.metadata.subject,o=this.metadata.messageId;if(void 0===o)throw new Error("Claim id not specified.");const c=new vr(t),u=function(t,e,r,n,s,i){const a=kr.getFunction("Commit");"did"===e.substr(0,3)&&(e=it(e)),"did"===r.substr(0,3)&&(r=it(e));const o=new re(a.parameters[0].getName(),zt.ByteArray,it(t)),c=new re(a.parameters[1].getName(),zt.ByteArray,e),u=new re(a.parameters[2].getName(),zt.ByteArray,r);let l=new ar;return l=gr(a.name,[o,c,u],_r,n,s,i)}(o,i,a,e,r,n);await lr(u,s);const l=await c.sendRawTransaction(u.serialize(),!1,!0),h=Hr.deserialize(l);return console.log(JSON.stringify(h)),"Push"===h.Result.Notify[0].States[0]}async revoke(t,e,r,n,s){const i=this.metadata.issuer,a=this.metadata.messageId;if(void 0===a)throw new Error("Claim id not specified.");const o=new vr(t),c=function(t,e,r,n,s){const i=kr.getFunction("Revoke"),a=i.parameters[0].getName(),o=zt.ByteArray;"did"===e.substr(0,3)&&(e=it(e));const c=new re(a,o,it(t)),u=new re(i.parameters[1].getName(),zt.ByteArray,e);return gr(i.name,[c,u],_r,r,n,s)}(a,i,e,r,n);await lr(c,s);const u=await o.sendRawTransaction(c.serialize(),!1,!0);return"Push"===Hr.deserialize(u).Result.Notify[0].States[0]}async getStatus(t){const e=this.metadata.issuer,r=this.metadata.messageId;if(void 0===r)throw new Error("Claim id not specified.");const n=new Pr(t),s=function(t){const e=kr.getFunction("GetStatus"),r=new re(e.parameters[0].getName(),zt.ByteArray,it(t));return gr(e.name,[r],_r)}(r),i=await n.sendRawTransaction(s.serialize(),!0),a=pn.deserialize(i);return console.log(a),a.status===on.ATTESTED&&a.issuerId===e}payloadToJSON(){return{ver:this.version,"@context":this.context,clm:this.content,"clm-rev":this.revocation}}payloadFromJSON(t){this.version=t.ver,this.context=t["@context"],this.content=t.clm,this.revocation=t["clm-rev"]}serializeHeader(t,e){if(this.useProof){if(void 0===t||void 0===e)throw new Error("Signature is needed fow JWT-X.");{const r={alg:t.labelJWS,typ:"JWT-X",kid:e},n=JSON.stringify(r);return De.encode(n,"utf-8")}}return super.serializeHeader(t,e)}serializeProof(){const t=JSON.stringify(this.proof);return De.encode(t,"utf-8")}}class pn{static deserialize(t){const e=new pn;if(void 0!==t.Result&&""===t.Result.Result)return e.status=on.NOTFOUND,e;const r=new yt(t.Result.Result);r.read(1),r.readNextLen(),r.read(1);const n=at(r.readNextBytes());r.read(1);const s=at(r.readNextBytes());r.read(1);const i=at(r.readNextBytes());r.read(1);let a=r.readNextBytes();return e.claimId=n,e.issuerId=s,e.subjectId=i,a||(a="00"),e.status=a,e}}!function(t){t.REVOKED="00",t.ATTESTED="01",t.NOTFOUND="-1"}(on||(on={}));var gn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};class yn{constructor(t,e,r,n){this.hash="sha256",this.id=t,this.encryptedKey=e,this.address=r,this.salt=n}static fromJson(t){const e=Ke(t),r=new yn(t.id,e,new we(t.address),t.salt);return r.publicKey=t.publicKey,r.hash=t.hash,r}toJson(){return gn({id:this.id},this.encryptedKey.serializeJson(),{address:this.address.toBase58(),salt:this.salt,"enc-alg":"aes-256-gcm",hash:this.hash,publicKey:this.publicKey})}}class mn{constructor(){this.controls=[]}static importIdentity(t,e,r,n,s,i){const a=new mn,o=Buffer.from(s,"base64").toString("hex"),c=e.decrypt(r,n,o,i);t||(t=rt(Rt(4)));const u=c.getPublicKey();a.ontid=we.generateOntid(u),a.label=t,a.lock=!1,a.isDefault=!1;const l=new yn("1",e,we.fromOntid(a.ontid),s);return l.publicKey=u.serializeHex(),a.controls.push(l),a}static create(t,e,r,n){const s=new mn;s.ontid="",s.label=r,s.lock=!1,s.isDefault=!1;const i=t.getPublicKey();s.ontid=we.generateOntid(i);const a=we.fromOntid(s.ontid),o=Pt(16),c=t.encrypt(e,a,o,n),u=Buffer.from(o,"hex").toString("base64"),l=new yn("1",c,a,u);return l.publicKey=i.serializeHex(),s.controls.push(l),s}static parseJson(t){return mn.parseJsonObj(JSON.parse(t))}static parseJsonObj(t){const e=new mn;return e.ontid=t.ontid,e.label=t.label,e.lock=t.lock,e.isDefault=t.isDefault,e.controls=t.controls.map(t=>yn.fromJson(t)),e.extra=t.extra,e}addControl(t){for(const e of this.controls)if(e.address.toBase58()===t.address.toBase58())return;t.id=(this.controls.length+1).toString(),this.controls.push(t)}toJson(){return JSON.stringify(this.toJsonObj())}toJsonObj(){return{ontid:this.ontid,label:this.label,lock:this.lock,isDefault:this.isDefault,controls:this.controls.map(t=>t.toJson()),extra:this.extra}}exportPrivateKey(t,e){const r=this.controls[0].encryptedKey,n=this.controls[0].address,s=this.controls[0].salt;return r.decrypt(t,n,s,e)}signTransaction(t,e,r){const n=this.exportPrivateKey(t,r);return ur(e,n,n.algorithm.defaultSchema),e}}class Sn{constructor(){this.version=0}serialize(){let t=this.serializeUnsigned();t+=dt(this.scripts.length);for(const e of this.scripts)t+=e.serialize();return t}serializeUnsigned(){let t="";t+=ht(this.type),t+=ht(this.version),t+=this.serializeExclusiveData(),t+=dt(this.attributes.length);for(const e of this.attributes)t+=e.serialize();t+=dt(this.inputs.length);for(const e of this.inputs)t+=e.serialize();t+=dt(this.outputs.length);for(const e of this.outputs)t+=e.serialize();return t}getHash(){const t=this.serializeUnsigned(),e=F.enc.Hex.parse(t),r=F.SHA256(e).toString();return F.SHA256(F.enc.Hex.parse(r)).toString()}getSignContent(){return this.getHashData()}serializeUnsignedData(){return this.getHashData()}getHashData(){return this.serializeUnsigned()}sign(t,e=Dt.ECDSAwithSHA256){return t.sign(this.getHashData(),e).serializeHex().substring(2)}serializeExclusiveData(){return""}}class wn extends Sn{constructor(){super(),this.type=nr.Invoke}serializeExclusiveData(){let t="";return t+=ot(this.script),t+=ht(this.gas,8,!0)}}class An{static sendRawTransaction(t,e){const r=this.makeRequest("sendrawtransaction",e);return Z.a.post(t,r).then(t=>t.data)}static makeRequest(t,...e){return{jsonrpc:"2.0",method:t,params:e,id:1}}static getBalance(t,e,r){const n=this.makeRequest("getstorage",e.toHexString(),r.serialize());return Z.a.post(t,n).then(t=>t.data)}}class Tn{static deserialize(t){const e=new yt,r=new Tn;return r.parameter=e.readNextBytes(),r.code=e.readNextBytes(),r}static programFromParams(t){return Yt(t)}static programFromPubKey(t){return $t(t)}static programFromMultiPubKey(t,e){return Qt(e,t)}serialize(){let t="";return t+=ot(this.parameter),t+=ot(this.code)}}class En{static makeInvokeTransaction(t,e,r){let n=de(r);return n+=ht(103),n+=t.serialize(),this.makeInvocationTransaction(n,e)}static makeInvocationTransaction(t,e){const r=new wn;r.version=1,r.attributes=[];const n=new sr;n.usage=rr.Script,n.data=e.serialize(),r.attributes[0]=n;const s=new sr;return s.usage=rr.DescriptionUrl,s.data=Pt(16),r.attributes[1]=s,r.inputs=[],r.outputs=[],r.script=t,r.gas=0,r}}class bn{static deserialize(t){const e=new yt(t),r=new bn;return r.prevHash=e.read(20),r.prevIndex=parseInt(ft(e.read(2)),16),r}equals(t){return t===this||null!==t&&(t instanceof bn&&(this.prevHash===t.prevHash&&this.prevIndex===t.prevIndex))}hashCode(){return parseInt(ft(this.prevHash),16)+this.prevIndex}serialize(){let t="";return t+=this.prevHash,t+=ht(this.prevIndex,2,!0)}}class Rn{static deserialize(t){const e=new yt(t),r=new Rn;return r.assetId=e.read(32),r.value=e.readLong(),r.scriptHash=new we(e.read(20)),r}serialize(){let t="";return t+=this.assetId,t+=ht(this.value,8,!0),t+=this.scriptHash.serialize()}}class Pn{constructor(t){this.url=t||C.RPC_URL}getUrl(){return this.url}makeRequest(t,...e){return{jsonrpc:"2.0",method:t,params:e,id:1}}getBalance(t){const e=this.makeRequest("getbalance",t.toBase58());return Z.a.post(this.url,e).then(t=>t.data)}sendRawTransaction(t,e=!1){let r;return r=e?this.makeRequest("sendrawtransaction",t,1):this.makeRequest("sendrawtransaction",t),Z.a.post(this.url,r).then(t=>t.data)}getRawTransaction(t){const e=this.makeRequest("getrawtransaction",t);return Z.a.post(this.url,e).then(t=>t.data)}getRawTransactionJson(t){const e=this.makeRequest("getrawtransaction",t,1);return Z.a.post(this.url,e).then(t=>t.data)}getNodeCount(){const t=this.makeRequest("getconnectioncount");return Z.a.post(this.url,t).then(t=>t.data)}getBlockHeight(){const t=this.makeRequest("getblockcount");return Z.a.post(this.url,t).then(t=>t.data)}getBlockCount(){const t=this.makeRequest("getblockcount");return Z.a.post(this.url,t).then(t=>t.data)}getBlockJson(t){const e=this.makeRequest("getblock",t,1);return Z.a.post(this.url,e).then(t=>t.data)}getContract(t){const e=this.makeRequest("getcontractstate",t);return Z.a.post(this.url,e).then(t=>t.data)}getContractJson(t){const e=this.makeRequest("getcontractstate",t,1);return Z.a.post(this.url,e).then(t=>t.data)}getBlock(t){const e=this.makeRequest("getblock",t);return Z.a.post(this.url,e).then(t=>t.data)}getSmartCodeEvent(t){const e=this.makeRequest("getsmartcodeevent",t);return Z.a.post(this.url,e).then(t=>t.data)}getBlockHeightByTxHash(t){const e=this.makeRequest("getblockheightbytxhash",t);return Z.a.post(this.url,e).then(t=>t.data)}getStorage(t,e){const r=this.makeRequest("getstorage",t,e);return console.log(r),Z.a.post(this.url,r).then(t=>t.data)}getMerkleProof(t){const e=this.makeRequest("getmerkleproof",t);return console.log(this.url),console.log(e),Z.a.post(this.url,e).then(t=>t.data)}getAllowance(t,e,r){if("ont"!==t&&"ong"!==t)throw J.INVALID_PARAMS;const n=this.makeRequest("getallowance",t,e.toBase58(),r.toBase58());return Z.a.post(this.url,n).then(t=>t.data)}}const Nn="0000000000000000000000000000000000000001",In="0000000000000000000000000000000000000002";function xn(t){if(t===D.ONT)return new we(Nn);if(t===D.ONG)return new we(In);throw new Error("Error token type.")}function On(t){const e=new Q.BigNumber(t);if(!e.isInteger()||e.lte(new Q.BigNumber(0)))throw new Error("Amount is invalid.")}function Bn(t,e,r,n,s,i,a){On(n);const o=new Q.BigNumber(n),c=new ne;c.add(e,r,o);const u=[];u.push([c]);const l=xn(t),h=pr("transfer",Lr(u),l,s,i);return h.tokenType=t,h.from=e,h.to=r,h.amount=n,h.method="transfer",h.payer=a||e,h}function vn(t,e,r,n,s,i){On(r);const a=new Q.BigNumber(r),o=[],c=new ne;c.add(t,new we(Nn),e,a),o.push(c);const u=pr("transferFrom",Lr(o),new we(In),s,i);return u.payer=n,u.tokenType="ONG",u.from=t,u.to=e,u.amount=r,u.method="transferFrom",u}function Cn(t,e,r){if("ont"!==(t=t.toLowerCase())&&"ong"!==t)throw J.INVALID_PARAMS;let n="";n="ong"===t?In:Nn;const s=[],i=new ne;return i.add(e,r),s.push(i),pr("allowance",Lr(s),new we(n),"0","0")}function kn(t,e){if("ont"!==(t=t.toLowerCase())&&"ong"!==t)throw J.INVALID_PARAMS;let r="";return r="ong"===t?In:Nn,pr("balanceOf",ot(e.serialize()),new we(r),"0","0")}function Dn(t){const e=ar.deserialize(t),r=e.payload.serialize(),n=r.lastIndexOf("14000000000000000000000000000000000000000"),s=r.lastIndexOf("140000000000000000000000000000000000000002");if(n>0&&"1"===r.substr(n+41,1))e.tokenType="ONT";else{if(!(n>0&&"2"===r.substr(n+41,1)))throw new Error("Not a transfer tx");e.tokenType="ONG"}const i=Math.max(n,s),a=r.substring(0,i),o=a.indexOf("6a7cc86c")+8;if("51c1"===a.substr(o,4)){const t=a.substring(o+6);e.method=at(t)}else{const t=a.substring(o+2);e.method=at(t)}if("transfer"===e.method){const t=new yt(a);t.pos+=10;const r=new we(t.read(20));e.from=r,t.pos+=8;const n=new we(t.read(20));e.to=n,t.pos+=6;const s=parseInt(t.read(1),16);if("6a7cc8"===t.str.substr(t.pos,6))e.amount=s-80;else{const r=kt.fromHexstr(t.read(s)).value;e.amount=new Q.BigNumber(r).toString()}}else{if("transferFrom"!==e.method)throw new Error("Not a transfer tx");{const t=new yt(a);t.pos+=10;const r=new we(t.read(20));e.from=r,t.pos+=56;const n=new we(t.read(20));e.to=n,t.pos+=6;const s=parseInt(t.read(1),16);if("6a7cc8"===t.str.substr(t.pos,6))e.amount=s-80;else{const r=kt.fromHexstr(t.read(s)).value;e.amount=new Q.BigNumber(r).toString()}}}return e}class _n{constructor(t,e,r,n){this.from=t.serialize(),this.to=e.serialize(),this.tokenId=ht(r),this.value=new Q.BigNumber(n)}}class Hn{constructor(t,e,r,n,s){this.spender=t.serialize(),this.from=e.serialize(),this.to=r.serialize(),this.tokenId=ht(n),this.value=new Q.BigNumber(s)}}const zn={Name:"name",Symbol:"symbol",TotalSupply:"totalSupply",BalanceOf:"balanceOf",Transfer:"transfer",TransferMulti:"transferMulti",Approve:"approve",ApproveMulti:"approveMulti",Allowance:"allowance",TransferFrom:"transferFrom",TransferFromMulti:"transferFromMulti",Compound:"compound",Concatkey:"concatkey",Init:"init",CreateMultiKindsPumpkin:"createMultiKindsPumpkin",CheckTokenPrefix:"checkTokenPrefix",BalancesOf:"balancesOf",TotalBalanceOf:"totalBalanceOf",CheckTokenId:"checkTokenId"};class Un{constructor(t){this.contractAddr=t}makeInitTx(t,e,r){const n=zn.Init;return gr(n,[],this.contractAddr,t,e,r)}makeTransferTx(t,e,r,n,s,i,a){const o=zn.Transfer,c=[new re("sender",zt.ByteArray,t.serialize()),new re("recv",zt.ByteArray,e.serialize()),new re("tokenId",zt.ByteArray,r),new re("amount",zt.Long,n)];return gr(o,c,this.contractAddr,s,i,a)}makeTransferMultiTx(t,e,r,n){const s=[];s.push(it(zn.TransferMulti));const i=[];for(const e of t)i.push([e.from,e.to,e.tokenId,e.value]);s.push(i);const a=ye(s);return gr("",a,this.contractAddr,e,r,n)}makeApproveTx(t,e,r,n,s,i,a){const o=zn.Approve,c=[new re("owner",zt.ByteArray,t.serialize()),new re("spender",zt.ByteArray,e.serialize()),new re("tokenId",zt.ByteArray,ht(r)),new re("amount",zt.Long,n)];return gr(o,c,this.contractAddr,s,i,a)}makeApproveMulti(t,e,r,n){const s=zn.ApproveMulti,i=[];i.push(it(s));const a=[];for(const e of t)a.push([e.from,e.to,e.tokenId,e.value]);i.push(a);const o=ye(i);return gr("",o,this.contractAddr,e,r,n)}makeTransferFromMulti(t,e,r,n){const s=zn.TransferFromMulti,i=[];i.push(it(s));const a=[];for(const e of t)a.push([e.spender,e.from,e.to,e.tokenId,e.value]);i.push(a);const o=ye(i);return gr("",o,this.contractAddr,e,r,n)}makeTransferFromTx(t,e,r,n,s,i,a,o){const c=zn.TransferFrom,u=[new re("sender",zt.ByteArray,t.serialize()),new re("from",zt.ByteArray,e.serialize()),new re("to",zt.ByteArray,r.serialize()),new re("tokenId",zt.ByteArray,ht(n)),new re("amount",zt.Long,s)];return gr(c,u,this.contractAddr,i,a,o)}makeCompoundTx(t,e,r,n,s){const i=zn.Compound,a=[new re("account",zt.ByteArray,t.serialize()),new re("compoundNum",zt.Integer,e)];return gr(i,a,this.contractAddr,r,n,s)}makeQueryAllowanceTx(t,e,r){const n=zn.Allowance,s=[new re("owner",zt.ByteArray,t.serialize()),new re("spender",zt.ByteArray,e.serialize()),new re("tokenId",zt.ByteArray,ht(r))];return gr(n,s,this.contractAddr)}makeQueryBalanceOfTx(t,e){const r=zn.BalanceOf,n=[new re("addr",zt.ByteArray,t.serialize()),new re("tokenId",zt.ByteArray,ht(e))];return gr(r,n,this.contractAddr)}makeQueryTotalSupplyTx(t){const e=zn.TotalSupply,r=[new re("tokenId",zt.ByteArray,ht(t))];return gr(e,r,this.contractAddr)}makeQueryNameTx(t){const e=zn.Name,r=[new re("tokenId",zt.ByteArray,ht(t))];return gr(e,r,this.contractAddr)}makeQueryDecimalsTx(){const t=zn.Symbol;return gr(t,[],this.contractAddr)}makeQuerySymbolTx(t){const e=zn.Symbol,r=[new re("tokenId",zt.ByteArray,ht(t))];return gr(e,r,this.contractAddr)}makeQueryBalancesTx(t){const e=zn.BalancesOf,r=[new re("account",zt.ByteArray,t.serialize())];return gr(e,r,this.contractAddr)}makeQueryTotalBalanceTx(t){const e=zn.TotalBalanceOf,r=[new re("account",zt.ByteArray,t.serialize())];return gr(e,r,this.contractAddr)}}class Mn{constructor(){this.defaultOntid="",this.defaultAccountAddress="",this.identities=[],this.accounts=[]}static parseJson(t){return Mn.parseJsonObj(JSON.parse(t))}static parseJsonObj(t){const e=new Mn;return e.name=t.name,e.defaultOntid=t.defaultOntid,e.defaultAccountAddress=t.defaultAccountAddress,e.createTime=t.createTime,e.version=t.version,e.scrypt=t.scrypt,e.identities=t.identities&&t.identities.map(t=>mn.parseJsonObj(t)),e.accounts=t.accounts&&t.accounts.map(t=>br.parseJsonObj(t)),e.extra=t.extra,e}static fromWalletFile(t){return Mn.parseJsonObj(t)}static create(t){const e=new Mn;return e.name=t,e.createTime=(new Date).toISOString(),e.version="1.0",e.scrypt={n:w.cost,r:w.blockSize,p:w.parallel,dkLen:w.size},e}addAccount(t){for(const e of this.accounts)if(e.address.toBase58()===t.address.toBase58())return;this.accounts.push(t)}addIdentity(t){for(const e of this.identities)if(e.ontid===t.ontid)return;this.identities.push(t)}setDefaultAccount(t){this.defaultAccountAddress=t}setDefaultIdentity(t){this.defaultOntid=t}toJson(){return JSON.stringify(this.toJsonObj())}toJsonObj(){return{name:this.name,defaultOntid:this.defaultOntid,defaultAccountAddress:this.defaultAccountAddress,createTime:this.createTime,version:this.version,scrypt:this.scrypt,identities:this.identities.map(t=>t.toJsonObj()),accounts:this.accounts.map(t=>t.toJsonObj()),extra:null}}signatureData(){return""}toWalletFile(){return this.toJsonObj()}}const Ln=r(11),Kn="ceab719b8baa2310f232ee0d277c061704541cfb",Vn="http://neonode1.ont.network:10332",Jn='{"hash":"0x5bb169f915c916a5e30a3c13a5e0cd228ea26826","entrypoint":"Main","functions":[{"name":"Name","parameters":[],"returntype":"String"},{"name":"Symbol","parameters":[],"returntype":"String"},{"name":"Decimals","parameters":[],"returntype":"Integer"},{"name":"Main","parameters":[{"name":"operation","type":"String"},{"name":"args","type":"Array"}],"returntype":"Any"},{"name":"Init","parameters":[],"returntype":"Boolean"},{"name":"TotalSupply","parameters":[],"returntype":"Integer"},{"name":"Transfer","parameters":[{"name":"from","type":"ByteArray"},{"name":"to","type":"ByteArray"},{"name":"value","type":"Integer"}],"returntype":"Boolean"},{"name":"BalanceOf","parameters":[{"name":"address","type":"ByteArray"}],"returntype":"Integer"}],"events":[{"name":"transfer","parameters":[{"name":"arg1","type":"ByteArray"},{"name":"arg2","type":"ByteArray"},{"name":"arg3","type":"Integer"}],"returntype":"Void"}]}',Gn=1e8;class Wn{static setServerNode(t){if(t){let e="";return e=t.indexOf("http")>-1?t.substr("http://".length):t,void(Wn.SERVER_NODE=e)}throw new Error("Can not set "+t+"as server node")}static setRestPort(t){if(t)return Wn.REST_PORT=t,void(Wn.restClient=new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`));throw new Error("Can not set "+t+" as restful port")}static setSocketPort(t){if(!t)throw new Error("Can not set "+t+"as socket port");Wn.SOCKET_PORT=t}static getDecryptError(t){return{error:J.Decrypto_ERROR,result:""}}static transformPassword(t){return Ot(t)?Buffer.from(t,"base64").toString():t}static createWallet(t,e,r,n,s,i){const a=Mn.create(t);e=this.transformPassword(e);const o=ze.random(),c=mn.create(o,e,t);a.defaultOntid=c.ontid,a.addIdentity(c);let u={error:0,result:a.toJson(),tx:""};const l=o.getPublicKey(),h=Gr(c.ontid,l,n,s);return h.payer=new we(r),ur(h,o),o.key="",e="",new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`).sendRawTransaction(h.serialize(),!0).then(t=>{if("01"===t.Result.Result)return u.tx=h.serialize(),i&&St(JSON.stringify(u),i),u;{const t={error:J.PreExec_ERROR,result:""};return i&&St(JSON.stringify(t),i),t}}).catch(t=>{u={error:J.NETWORK_ERROR,result:""},i&&St(JSON.stringify(u),i)})}static importIdentityWithWallet(t,e,r,n,s,i){let a,o=new mn;try{const c=new ze(e),u=new we(n);r=this.transformPassword(r),o=mn.importIdentity(t,c,r,u,s)}catch(t){return a=this.getDecryptError(t),i&&St(JSON.stringify(a),i),a}a={error:J.SUCCESS,result:o.toJson()};const c=wr($r(o.ontid)),u=Ar(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`,!0);return r="",Z.a.post(u,c).then(t=>{return t.data.Result.Result||(a.error=J.UNKNOWN_ONTID,a.result=""),i&&St(JSON.stringify(a),i),a}).catch(t=>{a={error:J.NETWORK_ERROR,result:""},i&&St(JSON.stringify(a),i)})}static importIdentityAndCreateWallet(t,e,r,n,s,i){let a,o=new mn,c={};try{r=this.transformPassword(r);const u=new ze(e),l=new we(n);o=mn.importIdentity(t,u,r,l,s);const h=Mn.create(o.label);h.defaultOntid=o.ontid,h.addIdentity(o);const d=h.toJson();a={error:J.SUCCESS,result:d};const f=wr($r(o.ontid)),p=Ar(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`,!0);return Z.a.post(p,f).then(t=>{return t.data.Result.Result||(a.error=J.UNKNOWN_ONTID,a.result=""),r="",i&&St(JSON.stringify(a),i),a}).catch(t=>{a={error:J.NETWORK_ERROR,result:""},i&&St(JSON.stringify(a),i)})}catch(t){return c=this.getDecryptError(t),i&&St(JSON.stringify(c),i),Promise.reject(c)}}static createIdentity(t,e,r,n,s,i){const a=ze.random();e=this.transformPassword(e);const o=mn.create(a,e,t),c=o.toJson();let u={error:J.SUCCESS,result:c,tx:""};const l=a.getPublicKey(),h=Gr(o.ontid,l,n,s);return h.payer=new we(r),ur(h,a),e="",a.key="",new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`).sendRawTransaction(h.serialize(),!0).then(t=>{if("01"===t.Result.Result)return u.tx=h.serialize(),i&&St(JSON.stringify(u),i),a.key="",e="",u;{const t={error:J.PreExec_ERROR,result:""};return i&&St(JSON.stringify(t),i),t}}).catch(t=>{u={error:J.NETWORK_ERROR,result:""},i&&St(JSON.stringify(u),i)})}static createAccount(t,e,r){let n=Nt();e=this.transformPassword(e);const s=it(n),i=ze.generateFromMnemonic(n),a=br.create(i,e,t),o=Ce(s,a.address,Buffer.from(a.salt,"base64").toString("hex"),e),c=a.toJson(),u={error:J.SUCCESS,result:c,mnemonicEnc:o};return r&&St(JSON.stringify(u),r),i.key="",e="",n="",u}static decryptMnemonicEnc(t,e,r,n,s){let i;n=this.transformPassword(n);const a=at(ke(t,new we(e),Buffer.from(r,"base64").toString("hex"),n));return i={error:J.SUCCESS,result:a},s&&St(JSON.stringify(i),s),i}static importAccountWithWallet(t,e,r,n,s,i){let a=new br;s=this.transformPassword(s);const o=new ze(e);try{const e=new we(r);a=br.importAccount(t,o,s,e,n)}catch(t){const e=this.getDecryptError(t);return i&&St(JSON.stringify(e),i),e}const c={error:J.SUCCESS,result:a.toJson()};return r!==a.address.toBase58()&&(c.error=J.INVALID_ADDR,c.result=""),i&&St(JSON.stringify(c),i),s="",c}static signSelfClaim(t,e,r,n,s,i,a,o){let c;s=this.transformPassword(s);const u=new ze(n),l=`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}${B.sendRawTx}`;try{const t=new we(i),e=Buffer.from(a,"base64").toString("hex");c=u.decrypt(s,t,e)}catch(t){const e=this.getDecryptError(t);return o&&St(JSON.stringify(e),o),e}const h={issuer:r,subject:r,issuedAt:At()},d=r+"#keys-1",f=new fn(h,void 0,void 0);f.sign(l,d,c);const p={error:0,result:f};return o&&St(JSON.stringify(p),o),c.key="",s="",p}static decryptEncryptedPrivateKey(t,e,r,n,s){e=this.transformPassword(e);const i=new ze(t);let a;try{const t=new we(r),o=Buffer.from(n,"base64").toString("hex");a=i.decrypt(e,t,o)}catch(t){const e=this.getDecryptError(t);return s&&St(JSON.stringify(e),s),e}const o={error:0,result:a.key};return s&&St(JSON.stringify(o),s),e="",o}static getClaim(t,e,r,n,s,i,a,o,c,u,l,h){let d;i=this.transformPassword(i);const f=new ze(s);try{const t=new we(a),e=Buffer.from(o,"base64").toString("hex");d=f.decrypt(i,t,e)}catch(t){const e=this.getDecryptError(t);return h&&St(JSON.stringify(e),h),e}const p="claim"+t,g={Type:"JSON",Value:{Context:e,Issuer:r}},y=JSON.stringify(g),m=new nn;m.key=p,m.type="JSON",m.value=y;const S=Fr(n,[m],d.getPublicKey(),u,l);return S.payer=new we(c),ur(S,d),new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`).sendRawTransaction(S.serialize(),!0).then(t=>{if("01"===t.Result.Result){const t={error:J.SUCCESS,result:"",tx:S.serialize()};return h&&St(JSON.stringify(t),h),d.key="",i="",t}{const t={error:J.PreExec_ERROR,result:""};return h&&St(JSON.stringify(t),h),t}}).catch(t=>{const e={error:J.NETWORK_ERROR,result:""};h&&St(JSON.stringify(e),h)})}static signData(t,e,r,n,s,i){let a;r=this.transformPassword(r);const o=new ze(e);let c;try{const t=new we(n),e=Buffer.from(s,"base64").toString("hex");a=o.decrypt(r,t,e)}catch(t){return c=this.getDecryptError(t),i&&St(JSON.stringify(c),i),c}return c=a.sign(t).serializePgp(),i&&St(JSON.stringify(c),i),a.key="",r="",c}static getBalance(t,e){const r=new we(t),n=`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}${B.getBalance}/${r.toBase58()}`;return Z.a.get(n).then(t=>{if(0===t.data.Error){const r={error:0,result:t.data.Result};return e&&St(JSON.stringify(r),e),r}{const r={error:t.data.Error,result:""};return e&&St(JSON.stringify(r),e),r}}).catch(t=>{const r={error:J.NETWORK_ERROR,result:""};return e&&St(JSON.stringify(r),e),Promise.reject(r)})}static transferAssets(t,e,r,n,s,i,a,o,c,u,l){let h,d,f;i=this.transformPassword(i);try{h=new we(e),d=new we(r)}catch(t){const e={error:J.INVALID_PARAMS,result:""};return l&&St(JSON.stringify(e),l),e}const p=new ze(s);try{const t=new we(e),r=Buffer.from(a,"base64").toString("hex");f=p.decrypt(i,t,r)}catch(t){const e=this.getDecryptError(t);return l&&St(JSON.stringify(e),l),e}const g=Bn(t,h,d,n,o,c);g.payer=new we(u),ur(g,f);const y={error:J.SUCCESS,result:"",tx:g.serialize(),txHash:ft(g.getSignContent())};return l&&St(JSON.stringify(y),l),f.key="",i="",y}static claimOng(t,e,r,n,s,i,a,o,c){let u,l;n=this.transformPassword(n);try{u=new we(t)}catch(t){const e={error:J.INVALID_PARAMS,result:""};return c&&St(JSON.stringify(e),c),e}const h=new ze(r);try{const t=Buffer.from(s,"base64").toString("hex");l=h.decrypt(n,u,t)}catch(t){const e=this.getDecryptError(t);return c&&St(JSON.stringify(e),c),e}const d=vn(u,u,e,new we(o),i,a);ur(d,l);const f={error:J.SUCCESS,result:"",tx:d.serialize(),txHash:ft(d.getSignContent())};return c&&St(JSON.stringify(f),c),l.key="",n="",f}static exportIdentityToQrcode(t,e){const r=mn.parseJson(t);let n=r.controls[0].salt;Ot(n)||(n=Buffer.from(n,"hex").toString("base64"));const s={type:"I",label:r.label,algorithm:"ECDSA",scrypt:{n:4096,p:8,r:8,dkLen:64},key:r.controls[0].encryptedKey.key,salt:n,address:r.controls[0].address.toBase58(),parameters:{curve:"secp256r1"}};return e&&St(JSON.stringify(s),e),s}static exportIdentityToKeystring(t,e){const r=mn.parseJson(t),n=r.controls[0].address.toBase58(),s=r.controls[0].salt+n+r.controls[0].encryptedKey.key;return e&&St(JSON.stringify(s),e),s}static exportAccountToQrcode(t,e){const r=br.parseJson(t),n={type:"A",label:r.label,algorithm:"ECDSA",scrypt:{n:4096,p:8,r:8,dkLen:64},key:r.encryptedKey.key,salt:r.salt,address:r.address.toBase58(),parameters:{curve:"secp256r1"}};return e&&St(JSON.stringify(n),e),n}static exportAccountToKeystring(t,e){const r=br.parseJson(t),n=r.salt+r.address.toBase58()+r.encryptedKey.key;return e&&St(JSON.stringify(n),e),n}static importAccountMnemonic(t,e,r,n){if(e=e.trim(),r=this.transformPassword(r),!m.validateMnemonic(e)){const t={error:J.INVALID_PARAMS,result:""};return n&&St(JSON.stringify(t),n),t}const s=m.mnemonicToSeedHex(e),i=Ln.fromMasterSeed(Buffer.from(s,"hex")).derive(U),a=Buffer.from(i.privateKey).toString("hex"),o=new ze(a),c=br.create(o,r,t).toJson(),u={error:J.SUCCESS,result:c};return n&&St(JSON.stringify(u),n),o.key="",r="",e="",u}static exportWifPrivakeKey(t,e,r,n,s){if(34!==r.length&&40!==r.length){const t={error:J.INVALID_PARAMS,result:""};return s&&St(JSON.stringify(t),s),t}e=this.transformPassword(e);const i=new ze(t),a=new we(r),o=Buffer.from(n,"base64").toString("hex"),c=i.decrypt(e,a,o);let u=c.serializeWIF();const l={error:J.SUCCESS,result:u};return s&&St(JSON.stringify(l),s),c.key="",u="",e="",l}static importAccountWithWif(t,e,r,n){let s;r=this.transformPassword(r);try{s=ze.deserializeWIF(e)}catch(t){const e={error:J.INVALID_PARAMS,result:""};return n&&St(JSON.stringify(e),n),e}const i=br.create(s,r,t),a={error:J.SUCCESS,result:i.toJson()};return n&&St(JSON.stringify(a),n),s.key="",r="",a}static importAccountWithPrivateKey(t,e,r,n){if(e=e.trim(),r=this.transformPassword(r),!e||64!==e.length||!Bt(e)){const t={error:J.INVALID_PARAMS,result:""};return n&&St(JSON.stringify(t),n),t}const s=new ze(e),i=br.create(s,r,t),a={error:J.SUCCESS,result:i.toJson()};return n&&St(JSON.stringify(a),n),e="",r="",a}static importAccountWithKeystore(t,e,r){let n;e=this.transformPassword(e);try{n=JSON.parse(t)}catch(t){const e={error:J.INVALID_PARAMS,result:""};return r&&St(JSON.stringify(e),r),e}if("A"!==n.type){const t={error:J.INVALID_PARAMS,result:""};return r&&St(JSON.stringify(t),r),t}{let t=new br;const s=new ze(n.key);try{const i={cost:n.scrypt.n||4096,blockSize:n.scrypt.p||8,parallel:n.scrypt.r||8,size:n.scrypt.dkLen||64},a=new we(n.address);t=br.importAccount(n.label,s,e,a,n.salt,i);const o={error:J.SUCCESS,result:t.toJson()};return r&&St(JSON.stringify(o),r),e="",o}catch(t){const e=this.getDecryptError(t);return r&&St(JSON.stringify(e),r),e}}}static getUnclaimedOng(t,e){return new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`).getAllowance("ong",new we(Nn),new we(t)).then(t=>{const r={error:J.SUCCESS,result:t.Result};return e&&St(JSON.stringify(r),e),r}).catch(t=>{const r={error:t.Error,result:""};return e&&St(JSON.stringify(r),e),r})}static querySmartCodeEventByTxhash(t,e){return new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`).getSmartCodeEvent(t).then(t=>{const r={error:J.SUCCESS,result:t};return e&&St(JSON.stringify(r),e),r}).catch(t=>{const r={error:t.Error,result:""};return e&&St(JSON.stringify(r),e),r})}static createSharedWallet(t,e,r){const n=parseInt(t,10);let s=[],i=[],a=J.SUCCESS;try{i=(s=JSON.parse(e)).map(t=>Vt.deserializeHex(new yt(t)))}catch(t){a=J.INVALID_PARAMS}(n<2||s.length<n||s.length>12)&&(a=J.INVALID_PARAMS);let o="";try{o=we.fromMultiPubKeys(n,i).toBase58()}catch(t){a=J.INVALID_PARAMS}if(r){const t={error:a,result:o};St(JSON.stringify(t),r)}return o}static adderssFromPublicKey(t,e){const r=Vt.deserializeHex(new yt(t)),n=we.fromPubKey(r).toBase58(),s={error:J.SUCCESS,result:n};return e&&St(JSON.stringify(s),e),n}static makeMultiSignTransaction(t,e,r,n,s,i,a){let o,c;try{o=new we(e),c=new we(r)}catch(t){const e={error:J.INVALID_PARAMS,result:""};return a&&St(JSON.stringify(e),a),e}const u=Bn(t,o,c,n,s,i);u.payer=o;const l={error:J.SUCCESS,txHash:ft(u.getSignContent()),txData:u.serialize()};return a&&St(JSON.stringify(l),a),l}static signMultiAddrTransaction(t,e,r,n,s,i,a,o){let c;n=this.transformPassword(n);const u=new ze(t);try{const t=new we(e),s=Buffer.from(r,"base64").toString("hex");c=u.decrypt(n,t,s)}catch(t){const e=this.getDecryptError(t);return o&&St(JSON.stringify(e),o),e}const l=parseInt(i,10),h=ar.deserialize(a),d=JSON.parse(s).map(t=>new Vt(t));fr(h,l,d,c);const f={error:J.SUCCESS,signedHash:h.serialize()};return o&&St(JSON.stringify(f),o),h}static neoTransfer(t,e,r,n,s,i,a,o){s=this.transformPassword(s);const c=new we(e),u=new we(t),l=Cr.parseJson(Jn),h=new we(ft(Kn)),d=parseInt(r,10),f=l.getFunction("Transfer");let p;f.name=f.name.toLowerCase();const g=new ze(n);try{const t=Buffer.from(i,"base64").toString("hex");p=g.decrypt(s,u,t,o)}catch(t){const e=this.getDecryptError(t);return a&&St(JSON.stringify(e),a),e}const y=new re("from",zt.ByteArray,u.serialize()),m=new re("to",zt.ByteArray,c.serialize()),S=new re("value",zt.Integer,d*Gn);f.setParamsValue(y,m,S);const w=En.makeInvokeTransaction(h,u,f),A=new Tn;return A.parameter=Tn.programFromParams([w.sign(p)]),A.code=Tn.programFromPubKey(p.getPublicKey()),w.scripts=[A],An.sendRawTransaction(Vn,w.serialize()).then(t=>{const e={error:J.SUCCESS,result:""};return t.result?(e.result=ft(w.getHash()),a&&St(JSON.stringify(e),a)):(e.error=J.NETWORK_ERROR,a&&St(JSON.stringify(e),a)),e})}static getNeoBalance(t,e){const r=new we(ft(Kn)),n=new we(t);return An.getBalance(Vn,r,n).then(t=>{const r={error:J.SUCCESS,result:0};if(t.result){const e=parseInt(ft(t.result),16);r.result=e}return e&&St(JSON.stringify(r),e),r})}static sendTransaction(t,e){return new Pr(`http://${Wn.SERVER_NODE}:${Wn.REST_PORT}`).sendRawTransaction(t).then(t=>{const r={error:J.SUCCESS,result:t};return e&&St(JSON.stringify(r),e),r}).catch(t=>{const r={error:t.Error,result:""};return e&&St(JSON.stringify(r),e),r})}static queryOep8Balance(t,e,r,n){const s=new we(ft(t)),i=new Un(s),a=new we(e),o=i.makeQueryBalanceOfTx(a,r);return Wn.restClient.sendRawTransaction(o.serialize(),!0).then(t=>{const e={error:J.SUCCESS,result:0};return t.Result.Result&&(e.result=parseInt(ft(t.Result.Result),16)),n&&St(JSON.stringify(e),n),e})}static queryOep8Balances(t,e,r){const n=new we(ft(t)),s=new Un(n),i=new we(e),a=s.makeQueryBalancesTx(i);return Wn.restClient.sendRawTransaction(a.serialize(),!0).then(t=>{const e={error:J.SUCCESS,result:[0,0,0,0,0,0,0,0]};if(t.Result.Result){const r=t.Result.Result.map(t=>t?parseInt(ft(t),16):0);e.result=r}return r&&St(JSON.stringify(e),r),e})}static queryOep8TotalBalance(t,e,r){const n=new we(ft(t)),s=new Un(n),i=new we(e),a=s.makeQueryTotalBalanceTx(i);return Wn.restClient.sendRawTransaction(a.serialize(),!0).then(t=>{const e={error:J.SUCCESS,result:0};return t.Result.Result&&(e.result=parseInt(ft(t.Result.Result),16)),r&&St(JSON.stringify(e),r),e})}static transferOep8(t,e,r,n,s,i,a,o,c,u,l,h){let d,f,p,g;a=this.transformPassword(a);try{d=new we(e),f=new we(r),p=new we(l)}catch(t){return{error:J.INVALID_PARAMS,result:""}}const y=new ze(i);try{const t=new we(e),r=Buffer.from(o,"base64").toString("hex");g=y.decrypt(a,t,r)}catch(t){return this.getDecryptError(t)}const m=new we(ft(t)),S=new Un(m).makeTransferTx(d,f,s,n,c,u,p);ur(S,g);const w={error:J.SUCCESS,result:"",tx:S.serialize(),txHash:ft(S.getSignContent())};return h&&St(JSON.stringify(w),h),g.key="",a="",w}static compoundOep8(t,e,r,n,s,i,a,o,c,u){let l,h;s=this.transformPassword(s);try{l=new we(e)}catch(t){return{error:J.INVALID_PARAMS,result:""}}const d=new ze(n);try{const t=Buffer.from(i,"base64").toString("hex");h=d.decrypt(s,l,t)}catch(t){return this.getDecryptError(t)}const f=new we(ft(t)),p=new Un(f).makeCompoundTx(l,r,a,o,l);ur(p,h);const g={error:J.SUCCESS,result:"",tx:p.serialize(),txHash:ft(p.getSignContent())};return u&&St(JSON.stringify(g),u),h.key="",s="",g}}Wn.SERVER_NODE=P,Wn.REST_PORT=I,Wn.SOCKET_PORT=x,Wn.restClient=new Pr;const Fn="peerAttributes",qn="splitFeeAddress",jn="voteInfoPool",$n="globalParam",Qn="totalStake",Yn=new we("0000000000000000000000000000000000000007");function Xn(t,e,r,n,s,i,a,o){xt(s),"did"===t.substr(0,3)&&(t=it(t));const c=new ne;return c.add(it(e),n.serialize(),s,t,r),pr("registerCandidate",Lr([c]),Yn,a,o,i)}function Zn(t,e,r,n,s){const i=new ne;return i.add(it(e),t.serialize()),pr("unRegisterCandidate",Lr([i]),Yn,n,s,r)}function ts(t,e,r,n){const s=new ne;return s.add(it(t)),pr("approveCandidate",Lr([s]),Yn,r,n,e)}function es(t,e,r,n){const s=new ne;return s.add(it(t)),pr("rejectCandidate",Lr([s]),Yn,r,n,e)}function rs(t,e,r,n,s,i){if(e.length!==r.length)throw J.INVALID_PARAMS;const a=new ne;a.add(t.serialize()),a.add(e.length);for(const t of e)a.add(it(t));a.add(r.length);for(const t of r)a.add(t);return pr("voteForPeer",Lr([a]),Yn,s,i,n)}function ns(t,e,r,n,s,i){if(e.length!==r.length)throw J.INVALID_PARAMS;const a=new ne;a.add(t.serialize()),a.add(e.length);for(const t of e)a.add(it(t));a.add(r.length);for(const t of r)a.add(t);return pr("unVoteForPeer",Lr([a]),Yn,s,i,n)}function ss(t,e,r,n,s,i){if(e.length!==r.length)throw J.INVALID_PARAMS;const a=new ne;a.add(t.serialize()),a.add(e.length);for(const t of e)a.add(it(t));a.add(r.length);for(const t of r)a.add(t);return pr("withdraw",Lr([a]),Yn,s,i,n)}function is(t,e,r,n,s){const i=new ne;return i.add(it(e),t.serialize()),pr("quitNode",Lr([i]),Yn,n,s,r)}function as(t,e,r,n,s,i){const a=new ne;return a.add(it(t),e.serialize(),r),pr("changeMaxAuthorization",Lr([a]),Yn,s,i,n)}function os(t,e,r,n,s,i){const a=new ne;return a.add(it(t),e.serialize(),r),pr("setPeerCost",Lr([a]),Yn,s,i,n)}function cs(t,e,r,n){const s=new ne;return s.add(t.serialize()),pr("withdrawFee",Lr([s]),Yn,r,n,e)}function us(t,e,r,n,s,i){const a=new ne;a.add(t.serialize()),a.add(e.length);for(const t of e)a.add(it(t));a.add(r.length);for(const t of r)a.add(t);return pr("authorizeForPeer",Lr([a]),Yn,s,i,n)}function ls(t,e,r,n,s,i){const a=new ne;a.add(t.serialize()),a.add(e.length);for(const t of e)a.add(it(t));a.add(r.length);for(const t of r)a.add(t);return pr("unAuthorizeForPeer",Lr([a]),Yn,s,i,n)}function hs(t,e,r,n,s,i){const a=new ne;return a.add(it(t),e.serialize(),r),pr("addInitPos",Lr([a]),Yn,s,i,n)}function ds(t,e,r,n,s,i){const a=new ne;return a.add(it(t),e.serialize(),r),pr("reduceInitPos",Lr([a]),Yn,s,i,n)}function fs(t,e,r,n){const s=new ne;return s.add(t.serialize()),pr("withdrawOng",Lr([s]),Yn,r,n,e)}async function ps(t,e){const r=new Pr(e),n=Yn.toHexString(),s=it(Fn)+t,i=(await r.getStorage(n,s)).Result;return i?Rs.deserialize(new yt(i)):new Rs}async function gs(t,e){const r=new Pr(e),n=Yn.toHexString(),s=it(qn)+t.serialize(),i=(await r.getStorage(n,s)).Result;return i?Ps.deserialize(new yt(i)):new Ps}async function ys(t,e,r){const n=new Pr(r),s=Yn.toHexString(),i=it(jn)+t+e.serialize(),a=(await n.getStorage(s,i)).Result;return a?Ns.deserialize(new yt(a)):new Ns}async function ms(t){const e=new Pr(t),r=Yn.toHexString(),n=it("governanceView"),s=(await e.getStorage(r,n)).Result;return Es.deserialize(new yt(s))}async function Ss(t){const e=new Pr(t),r=Yn.toHexString(),n=await ms(t),s=it("peerPool")+ht(n.view,4,!0),i=await e.getStorage(r,s),a=new yt(i.Result),o=a.readInt(),c={};for(let t=0;t<o;t++){const t=bs.deserialize(a);c[t.peerPubkey]=t}return c}async function ws(t){const e=new Pr(t),r=Yn.toHexString(),n=it($n),s=await e.getStorage(r,n);return s.Result?Is.deserialize(new yt(s.Result)):new Is}async function As(t,e){const r=new Pr(e),n=Yn.toHexString(),s=it(Qn)+t.serialize(),i=await r.getStorage(n,s);return i.Result?xs.deserialize(new yt(i.Result)):new xs}async function Ts(t,e){const r=await As(t,e);if(!r.address)return 0;const n=new Pr(e),s=(await n.getBlockHeight()).Result,i=(await n.getBlockJson(s)).Result.Header.Timestamp-V;return Ct(r.stake,r.timeOffset,i)}class Es{constructor(){this.view=0,this.height=0,this.txhash=""}static deserialize(t){const e=new Es;return e.view=t.readUint32(),e.height=t.readUint32(),e.txhash=t.read(64),e}serialize(){let t="";return t+=ht(this.view,4,!0),t+=ht(this.height,4,!0),t+=ot(this.txhash)}}class bs{constructor(){this.index=0,this.peerPubkey="",this.status=0,this.initPos=0,this.totalPos=0}static deserialize(t){const e=new bs;return e.index=t.readInt(),e.peerPubkey=at(t.readNextBytes()),e.address=we.deserialize(t),e.status=parseInt(t.read(1),16),e.initPos=t.readLong(),e.totalPos=t.readLong(),e}serialize(){let t="";return t+=ht(this.index,4,!0),t+=ct(this.peerPubkey),t+=this.address.serialize(),t+=ht(this.status),t+=ht(this.initPos,8,!0),t+=ht(this.totalPos,8,!0)}}class Rs{constructor(){this.peerPubkey="",this.maxAuthorize=0,this.t2PeerCost=100,this.t1PeerCost=100,this.tPeerCost=0,this.field1="",this.field2="",this.field3="",this.field4=""}static deserialize(t){const e=new Rs;return e.peerPubkey=at(t.readNextBytes()),e.maxAuthorize=t.readLong(),e.t2PeerCost=t.readLong(),e.t1PeerCost=t.readLong(),e.tPeerCost=t.readLong(),t.isEmpty?e:(e.field1=t.readNextBytes(),e.field2=t.readNextBytes(),e.field3=t.readNextBytes(),e.field4=t.readNextBytes(),e)}serialize(){return""}}class Ps{constructor(){this.amount=0}static deserialize(t){const e=new Ps;return e.address=we.deserialize(t),e.amount=t.readLong(),e}}class Ns{constructor(){this.peerPubkey="",this.consensusPos=0,this.freezePos=0,this.newPos=0,this.withdrawPos=0,this.withdrawFreezePos=0,this.withdrawUnfreezePos=0}static deserialize(t){const e=new Ns;return e.peerPubkey=at(t.readNextBytes()),e.address=we.deserialize(t),e.consensusPos=t.readLong(),e.freezePos=t.readLong(),e.newPos=t.readLong(),e.withdrawPos=t.readLong(),e.withdrawFreezePos=t.readLong(),e.withdrawUnfreezePos=t.readLong(),e}}class Is{static deserialize(t){const e=new Is,r=t.readNextBytes(),n=kt.fromHexstr(r).value;e.candidateFee=Number(n);const s=kt.fromHexstr(t.readNextBytes()).value;e.minInitState=Number(s);const i=kt.fromHexstr(t.readNextBytes()).value,a=Number(i);e.candidateNum=a;const o=kt.fromHexstr(t.readNextBytes()).value;e.posLimit=Number(o);const c=kt.fromHexstr(t.readNextBytes()).value,u=Number(c),l=kt.fromHexstr(t.readNextBytes()).value,h=Number(l),d=kt.fromHexstr(t.readNextBytes()).value,f=Number(d),p=kt.fromHexstr(t.readNextBytes()).value,g=Number(p);return e.A=u,e.B=h,e.yita=f,e.penalty=g,e}}class xs{static deserialize(t){const e=new xs;return e.address=we.deserialize(t),e.stake=t.readLong(),e.timeOffset=t.readUint32(),e}}class Os{constructor(){this.states=[]}static deserialize(t){const e=new Os,r=[],n=t.readNextLen();for(let e=0;e<n;e++){const e=vs.deserialize(t);r.push(e)}return e.states=r,e}serialize(){let t="";t+=ht(this.states.length);for(let e=0;e<this.states.length;e++)t+=this.states[e].serialize();return t}}class Bs{static deserialize(t){const e=new Bs;e.states=[];const r=t.read(20);e.contract=r;const n=t.readNextLen();for(let r=0;r<n;r++){const r=vs.deserialize(t);e.states.push(r)}return e}serialize(){let t="";t+=this.contract,t+=ht(this.states.length);for(let e=0;e<this.states.length;e++)t+=this.states[e].serialize();return t}}class vs{static deserialize(t){const e=new we(t.readNextBytes()),r=new we(t.readNextBytes()),n=kt.fromHexstr(t.readNextBytes()).value;return new vs(e,r,n.toString())}constructor(t,e,r){const n=new Q.BigNumber(r);if(!n.isInteger()||n.isNegative())throw J.INVALID_PARAMS;this.from=t,this.to=e,this.value=r}serialize(){let t="";return t+=ot(this.from.serialize()),t+=ot(this.to.serialize()),t+=ot(new kt(this.value).toHexstr())}}class Cs{static deserialize(t){const e=new Cs,r=t.read(1),n=we.deserialize(t),s=t.readNextBytes(),i=t.readNextBytes();return e.version=r,e.address=n,e.method=at(s),e.args=i,e}constructor(){this.version="00"}serialize(){let t="";return t+=this.version,t+=this.address.serialize(),t+=ct(this.method),t+=ot(this.args)}}class ks{static deserialize(t){const e=new we(t.readNextBytes()),r=new we(t.readNextBytes()),n=new we(t.readNextBytes()),s=kt.fromHexstr(t.readNextBytes()).value;return new ks(e,r,n,s.toString())}constructor(t,e,r,n){const s=new Q.BigNumber(n);if(!s.isInteger()||!s.isNegative())throw J.INVALID_PARAMS;this.sender=t,this.from=e,this.to=r,this.value=n}serialize(){let t="";return t+=ot(this.sender.serialize()),t+=ot(this.from.serialize()),t+=ot(this.to.serialize()),t+=ot(new kt(this.value).toHexstr())}}const Ds={Init:"init",Transfer:"transfer",TransferMulti:"transferMulti",Approve:"approve",TransferFromm:"transferFrom",Allowance:"allowance",BalanceOf:"balanceOf",TotalSupply:"totalSupply",Symbol:"symbol",Decimals:"decimals",Name:"name"};class _s{constructor(t,e,r){this.from=t.serialize(),this.to=e.serialize(),this.amount=new Q.BigNumber(r)}}class Hs{constructor(t){this.contractAddr=t}init(t,e,r){const n=Ds.Init;return gr(n,[],this.contractAddr,t,e,r)}makeTransferTx(t,e,r,n,s,i){const a=Ds.Transfer,o=new re("from",zt.ByteArray,t.serialize()),c=new re("to",zt.ByteArray,e.serialize()),u=new re("value",zt.Long,r);return gr(a,[o,c,u],this.contractAddr,n,s,i)}makeTransferMultiTx(t,e,r,n){const s=[];s.push(it(Ds.TransferMulti));const i=[];for(const e of t)i.push([e.from,e.to,e.amount]);s.push(i);const a=ye(s);return gr("",a,this.contractAddr,e,r,n)}makeApproveTx(t,e,r,n,s,i){const a=Ds.Approve,o=[new re("owner",zt.ByteArray,t.serialize()),new re("spender",zt.ByteArray,e.serialize()),new re("amount",zt.Long,r)];return gr(a,o,this.contractAddr,n,s,i)}makeTransferFromTx(t,e,r,n,s,i,a){const o=Ds.TransferFromm,c=[new re("owner",zt.ByteArray,t.serialize()),new re("from",zt.ByteArray,e.serialize()),new re("to",zt.ByteArray,r.serialize()),new re("amount",zt.Long,n)];return gr(o,c,this.contractAddr,s,i,a)}makeQueryAllowanceTx(t,e){const r=Ds.Allowance,n=[new re("owner",zt.ByteArray,t.serialize()),new re("spender",zt.ByteArray,e.serialize())];return gr(r,n,this.contractAddr)}queryBalanceOf(t){const e=Ds.BalanceOf,r=new re("from",zt.ByteArray,t.serialize());return gr(e,[r],this.contractAddr)}queryTotalSupply(){const t=Ds.TotalSupply;return gr(t,[],this.contractAddr)}queryDecimals(){const t=Ds.Decimals;return gr(t,[],this.contractAddr)}querySymbol(){const t=Ds.Symbol;return gr(t,[],this.contractAddr)}queryName(){const t=Ds.Name;return gr(t,[],this.contractAddr)}}class zs{constructor(t,e){this.toAcct=t.serialize(),this.tokenId=e}}const Us={Init:"init",Name:"name",Symbol:"symbol",TotalSupply:"totalSupply",BalanceOf:"balanceOf",OwnerOf:"ownerOf",Transfer:"transfer",TransferMulti:"transferMulti",Approve:"approve",ApproveMulti:"approveMulti",TakeOwnership:"takeOwnership",QueryTokenIDByIndex:"queryTokenIDByIndex",QueryTokenByID:"queryTokenByID",GetApproved:"getApproved",CreateMultiTokens:"createMultiTokens",CreateOneToken:"createOneToken"};class Ms{constructor(t){this.contractAddr=t}makeInitTx(t,e,r){const n=Us.Init;return gr(n,[],this.contractAddr,t,e,r)}makeOwnerOfTx(t){const e=Us.OwnerOf,r=[new re("tokenId",zt.ByteArray,t)];return gr(e,r,this.contractAddr)}makeTransferTx(t,e,r,n){const s=Us.Transfer,i=[new re("toAcct",zt.ByteArray,t.toAcct),new re("tokenId",zt.ByteArray,t.tokenId)];return gr(s,i,this.contractAddr,e,r,n)}makeTransferMultiTx(t,e,r,n){const s=[];s.push(it(Us.TransferMulti));const i=[];for(const e of t)i.push([e.toAcct,e.tokenId]);s.push(i);const a=ye(s);return gr("",a,this.contractAddr,e,r,n)}makeApproveTx(t,e,r,n){const s=Us.Approve,i=[new re("toAcct",zt.ByteArray,t.toAcct),new re("tokenId",zt.ByteArray,t.tokenId)];return gr(s,i,this.contractAddr,e,r,n)}makeTakeOwnershipTx(t,e,r,n){const s=Us.TakeOwnership,i=[new re("toAcct",zt.ByteArray,t.toAcct),new re("tokenId",zt.ByteArray,t.tokenId)];return gr(s,i,this.contractAddr,e,r,n)}makeQueryBalanceOfTx(t){const e=Us.BalanceOf,r=[new re("addr",zt.ByteArray,t.serialize())];return gr(e,r,this.contractAddr)}makeQueryTotalSupplyTx(){const t=Us.TotalSupply;return gr(t,[],this.contractAddr)}makeQueryTokenIDByIndexTx(t){const e=Us.QueryTokenIDByIndex,r=[new re("index",zt.Long,t)];return gr(e,r,this.contractAddr)}makeQueryTokenByIDTx(t){const e=Us.QueryTokenByID,r=[new re("tokenId",zt.ByteArray,t)];return gr(e,r,this.contractAddr)}makeGetApprovedTx(t){const e=Us.GetApproved,r=[new re("tokenId",zt.ByteArray,t)];return gr(e,r,this.contractAddr)}makeQueryNameTx(){const t=Us.Name;return gr(t,[],this.contractAddr)}makeQuerySymbolTx(){const t=Us.Symbol;return gr(t,[],this.contractAddr)}}r.d(e,"Account",function(){return br}),r.d(e,"Identity",function(){return mn}),r.d(e,"Claim",function(){return fn}),r.d(e,"retrievePublicKey",function(){return ln}),r.d(e,"DDO",function(){return sn}),r.d(e,"DDOAttribute",function(){return nn}),r.d(e,"Transaction",function(){return ar}),r.d(e,"Transfer",function(){return or}),r.d(e,"TxSignature",function(){return ir}),r.d(e,"Parameter",function(){return re}),r.d(e,"ParameterType",function(){return zt}),r.d(e,"AbiFunction",function(){return Xe}),r.d(e,"AbiInfo",function(){return Cr}),r.d(e,"TransactionBuilder",function(){return c}),r.d(e,"OntAssetTxBuilder",function(){return h}),r.d(e,"GovernanceTxBuilder",function(){return f}),r.d(e,"utils",function(){return s}),r.d(e,"scrypt",function(){return a}),r.d(e,"CONST",function(){return n}),r.d(e,"Wallet",function(){return Mn}),r.d(e,"SDK",function(){return Wn}),r.d(e,"Token",function(){return p}),r.d(e,"OntidContract",function(){return u}),r.d(e,"RestClient",function(){return Pr}),r.d(e,"RpcClient",function(){return Pn}),r.d(e,"WebsocketClient",function(){return vr}),r.d(e,"Crypto",function(){return o}),r.d(e,"Struct",function(){return ne}),r.d(e,"ScriptBuilder",function(){return i}),r.d(e,"NeoCore",function(){return l}),r.d(e,"Oep4",function(){return g}),r.d(e,"Oep8",function(){return d}),r.d(e,"Oep5",function(){return y});e.default=class{constructor(){this.Account=br,this.Identity=mn,this.Claim=fn,this.DDO=sn,this.DDOAttribute=nn,this.Transaction=ar,this.Transfer=or,this.TxSignature=ir,this.TransactionBuilder=c,this.OntAssetTxBuilder=h,this.GovernanceTxBuilder=f,this.Parameter=re,this.ParameterType=zt,this.AbiFunction=Xe,this.AbiInfo=Cr,this.utils=s,this.scrypt=a,this.CONST=n,this.Wallet=Mn,this.SDK=Wn,this.Token=p,this.OntidContract=u,this.RestClient=Pr,this.RpcClient=Pn,this.WebsocketClient=vr,this.Crypto=o,this.Struct=ne,this.ScriptBuilder=i,this.NeoCore=l,this.Oep4=g,this.Oep8=d,this.Oep5=y}setNode(t){this.CONST.TEST_NODE=t}setRpcPort(t){this.CONST.HTTP_JSON_PORT=t}setRestPort(t){this.CONST.HTTP_REST_PORT=t}setSocketPort(t){this.CONST.HTTP_WS_PORT=t}}}]);
//# sourceMappingURL=index.js.map